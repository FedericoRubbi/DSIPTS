<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>dsipts package &#8212; DSIPTS 1.1.10 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=5ecbeea2" />
    <link rel="stylesheet" type="text/css" href="_static/basic.css?v=b08954a9" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css?v=27fed22d" />
    <script src="_static/documentation_options.js?v=25b84aaa"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="dsipts-package">
<h1>dsipts package<a class="headerlink" href="#dsipts-package" title="Link to this heading">¶</a></h1>
<section id="subpackages">
<h2>Subpackages<a class="headerlink" href="#subpackages" title="Link to this heading">¶</a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="dsipts.data_management.html">dsipts.data_management package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="dsipts.data_management.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="dsipts.data_management.html#module-dsipts.data_management.monash">dsipts.data_management.monash module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="dsipts.data_management.html#dsipts.data_management.monash.Monash"><code class="docutils literal notranslate"><span class="pre">Monash</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="dsipts.data_management.html#dsipts.data_management.monash.Monash.download_dataset"><code class="docutils literal notranslate"><span class="pre">Monash.download_dataset()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.data_management.html#dsipts.data_management.monash.Monash.generate_dataset"><code class="docutils literal notranslate"><span class="pre">Monash.generate_dataset()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.data_management.html#dsipts.data_management.monash.Monash.load"><code class="docutils literal notranslate"><span class="pre">Monash.load()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.data_management.html#dsipts.data_management.monash.Monash.save"><code class="docutils literal notranslate"><span class="pre">Monash.save()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="dsipts.data_management.html#dsipts.data_management.monash.convert_tsf_to_dataframe"><code class="docutils literal notranslate"><span class="pre">convert_tsf_to_dataframe()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="dsipts.data_management.html#dsipts.data_management.monash.get_freq"><code class="docutils literal notranslate"><span class="pre">get_freq()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="dsipts.data_management.html#module-dsipts.data_management.public_datasets">dsipts.data_management.public_datasets module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="dsipts.data_management.html#dsipts.data_management.public_datasets.build_venice"><code class="docutils literal notranslate"><span class="pre">build_venice()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="dsipts.data_management.html#dsipts.data_management.public_datasets.read_public_dataset"><code class="docutils literal notranslate"><span class="pre">read_public_dataset()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="dsipts.data_management.html#module-dsipts.data_management">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="dsipts.data_structure.html">dsipts.data_structure package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="dsipts.data_structure.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="dsipts.data_structure.html#module-dsipts.data_structure.data_structure">dsipts.data_structure.data_structure module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="dsipts.data_structure.html#dsipts.data_structure.data_structure.Categorical"><code class="docutils literal notranslate"><span class="pre">Categorical</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="dsipts.data_structure.html#dsipts.data_structure.data_structure.Categorical.generate_signal"><code class="docutils literal notranslate"><span class="pre">Categorical.generate_signal()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.data_structure.html#dsipts.data_structure.data_structure.Categorical.plot"><code class="docutils literal notranslate"><span class="pre">Categorical.plot()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="dsipts.data_structure.html#dsipts.data_structure.data_structure.TimeSeries"><code class="docutils literal notranslate"><span class="pre">TimeSeries</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="dsipts.data_structure.html#dsipts.data_structure.data_structure.TimeSeries.create_data_loader"><code class="docutils literal notranslate"><span class="pre">TimeSeries.create_data_loader()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.data_structure.html#dsipts.data_structure.data_structure.TimeSeries.enrich"><code class="docutils literal notranslate"><span class="pre">TimeSeries.enrich()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.data_structure.html#dsipts.data_structure.data_structure.TimeSeries.generate_signal"><code class="docutils literal notranslate"><span class="pre">TimeSeries.generate_signal()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.data_structure.html#dsipts.data_structure.data_structure.TimeSeries.inference"><code class="docutils literal notranslate"><span class="pre">TimeSeries.inference()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.data_structure.html#dsipts.data_structure.data_structure.TimeSeries.inference_on_set"><code class="docutils literal notranslate"><span class="pre">TimeSeries.inference_on_set()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.data_structure.html#dsipts.data_structure.data_structure.TimeSeries.load"><code class="docutils literal notranslate"><span class="pre">TimeSeries.load()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.data_structure.html#dsipts.data_structure.data_structure.TimeSeries.load_signal"><code class="docutils literal notranslate"><span class="pre">TimeSeries.load_signal()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.data_structure.html#dsipts.data_structure.data_structure.TimeSeries.plot"><code class="docutils literal notranslate"><span class="pre">TimeSeries.plot()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.data_structure.html#dsipts.data_structure.data_structure.TimeSeries.save"><code class="docutils literal notranslate"><span class="pre">TimeSeries.save()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.data_structure.html#dsipts.data_structure.data_structure.TimeSeries.set_model"><code class="docutils literal notranslate"><span class="pre">TimeSeries.set_model()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.data_structure.html#dsipts.data_structure.data_structure.TimeSeries.set_verbose"><code class="docutils literal notranslate"><span class="pre">TimeSeries.set_verbose()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.data_structure.html#dsipts.data_structure.data_structure.TimeSeries.split_for_train"><code class="docutils literal notranslate"><span class="pre">TimeSeries.split_for_train()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.data_structure.html#dsipts.data_structure.data_structure.TimeSeries.train_model"><code class="docutils literal notranslate"><span class="pre">TimeSeries.train_model()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="dsipts.data_structure.html#module-dsipts.data_structure.modifiers">dsipts.data_structure.modifiers module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="dsipts.data_structure.html#dsipts.data_structure.modifiers.Modifier"><code class="docutils literal notranslate"><span class="pre">Modifier</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="dsipts.data_structure.html#dsipts.data_structure.modifiers.Modifier.fit_transform"><code class="docutils literal notranslate"><span class="pre">Modifier.fit_transform()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.data_structure.html#dsipts.data_structure.modifiers.Modifier.inverse_transform"><code class="docutils literal notranslate"><span class="pre">Modifier.inverse_transform()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.data_structure.html#dsipts.data_structure.modifiers.Modifier.transform"><code class="docutils literal notranslate"><span class="pre">Modifier.transform()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="dsipts.data_structure.html#dsipts.data_structure.modifiers.ModifierVVA"><code class="docutils literal notranslate"><span class="pre">ModifierVVA</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="dsipts.data_structure.html#dsipts.data_structure.modifiers.ModifierVVA.fit_transform"><code class="docutils literal notranslate"><span class="pre">ModifierVVA.fit_transform()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.data_structure.html#dsipts.data_structure.modifiers.ModifierVVA.inverse_transform"><code class="docutils literal notranslate"><span class="pre">ModifierVVA.inverse_transform()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.data_structure.html#dsipts.data_structure.modifiers.ModifierVVA.transform"><code class="docutils literal notranslate"><span class="pre">ModifierVVA.transform()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="dsipts.data_structure.html#dsipts.data_structure.modifiers.VVADataset"><code class="docutils literal notranslate"><span class="pre">VVADataset</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="dsipts.data_structure.html#module-dsipts.data_structure.utils">dsipts.data_structure.utils module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="dsipts.data_structure.html#dsipts.data_structure.utils.MyDataset"><code class="docutils literal notranslate"><span class="pre">MyDataset</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="dsipts.data_structure.html#dsipts.data_structure.utils.beauty_string"><code class="docutils literal notranslate"><span class="pre">beauty_string()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="dsipts.data_structure.html#dsipts.data_structure.utils.extend_time_df"><code class="docutils literal notranslate"><span class="pre">extend_time_df()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="dsipts.data_structure.html#module-dsipts.data_structure">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="dsipts.models.html">dsipts.models package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="dsipts.models.html#subpackages">Subpackages</a><ul>
<li class="toctree-l3"><a class="reference internal" href="dsipts.models.autoformer.html">dsipts.models.autoformer package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.autoformer.html#submodules">Submodules</a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.autoformer.html#module-dsipts.models.autoformer.layers">dsipts.models.autoformer.layers module</a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.autoformer.html#module-dsipts.models.autoformer">Module contents</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="dsipts.models.crossformer.html">dsipts.models.crossformer package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.crossformer.html#submodules">Submodules</a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.crossformer.html#module-dsipts.models.crossformer.attn">dsipts.models.crossformer.attn module</a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.crossformer.html#module-dsipts.models.crossformer.cross_decoder">dsipts.models.crossformer.cross_decoder module</a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.crossformer.html#module-dsipts.models.crossformer.cross_embed">dsipts.models.crossformer.cross_embed module</a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.crossformer.html#module-dsipts.models.crossformer.cross_encoder">dsipts.models.crossformer.cross_encoder module</a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.crossformer.html#module-dsipts.models.crossformer">Module contents</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="dsipts.models.d3vae.html">dsipts.models.d3vae package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.d3vae.html#submodules">Submodules</a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.d3vae.html#module-dsipts.models.d3vae.diffusion_process">dsipts.models.d3vae.diffusion_process module</a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.d3vae.html#module-dsipts.models.d3vae.embedding">dsipts.models.d3vae.embedding module</a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.d3vae.html#module-dsipts.models.d3vae.encoder">dsipts.models.d3vae.encoder module</a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.d3vae.html#module-dsipts.models.d3vae.model">dsipts.models.d3vae.model module</a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.d3vae.html#module-dsipts.models.d3vae.neural_operations">dsipts.models.d3vae.neural_operations module</a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.d3vae.html#module-dsipts.models.d3vae.resnet">dsipts.models.d3vae.resnet module</a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.d3vae.html#module-dsipts.models.d3vae.utils">dsipts.models.d3vae.utils module</a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.d3vae.html#module-dsipts.models.d3vae">Module contents</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="dsipts.models.duet.html">dsipts.models.duet package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.duet.html#submodules">Submodules</a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.duet.html#module-dsipts.models.duet.layers">dsipts.models.duet.layers module</a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.duet.html#module-dsipts.models.duet.masked">dsipts.models.duet.masked module</a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.duet.html#module-dsipts.models.duet">Module contents</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="dsipts.models.informer.html">dsipts.models.informer package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.informer.html#submodules">Submodules</a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.informer.html#module-dsipts.models.informer.attn">dsipts.models.informer.attn module</a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.informer.html#module-dsipts.models.informer.decoder">dsipts.models.informer.decoder module</a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.informer.html#module-dsipts.models.informer.embed">dsipts.models.informer.embed module</a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.informer.html#module-dsipts.models.informer.encoder">dsipts.models.informer.encoder module</a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.informer.html#module-dsipts.models.informer">Module contents</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="dsipts.models.itransformer.html">dsipts.models.itransformer package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.itransformer.html#submodules">Submodules</a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.itransformer.html#module-dsipts.models.itransformer.Embed">dsipts.models.itransformer.Embed module</a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.itransformer.html#module-dsipts.models.itransformer.SelfAttention_Family">dsipts.models.itransformer.SelfAttention_Family module</a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.itransformer.html#module-dsipts.models.itransformer.Transformer_EncDec">dsipts.models.itransformer.Transformer_EncDec module</a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.itransformer.html#module-dsipts.models.itransformer">Module contents</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="dsipts.models.patchtst.html">dsipts.models.patchtst package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.patchtst.html#submodules">Submodules</a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.patchtst.html#module-dsipts.models.patchtst.layers">dsipts.models.patchtst.layers module</a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.patchtst.html#module-dsipts.models.patchtst">Module contents</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="dsipts.models.samformer.html">dsipts.models.samformer package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.samformer.html#submodules">Submodules</a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.samformer.html#module-dsipts.models.samformer.utils">dsipts.models.samformer.utils module</a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.samformer.html#module-dsipts.models.samformer">Module contents</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="dsipts.models.tft.html">dsipts.models.tft package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.tft.html#submodules">Submodules</a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.tft.html#module-dsipts.models.tft.sub_nn">dsipts.models.tft.sub_nn module</a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.tft.html#module-dsipts.models.tft">Module contents</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="dsipts.models.timexer.html">dsipts.models.timexer package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.timexer.html#submodules">Submodules</a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.timexer.html#module-dsipts.models.timexer.Layers">dsipts.models.timexer.Layers module</a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.timexer.html#module-dsipts.models.timexer">Module contents</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="dsipts.models.ttm.html">dsipts.models.ttm package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.ttm.html#submodules">Submodules</a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.ttm.html#module-dsipts.models.ttm.configuration_tinytimemixer">dsipts.models.ttm.configuration_tinytimemixer module</a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.ttm.html#module-dsipts.models.ttm.consts">dsipts.models.ttm.consts module</a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.ttm.html#module-dsipts.models.ttm.modeling_tinytimemixer">dsipts.models.ttm.modeling_tinytimemixer module</a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.ttm.html#module-dsipts.models.ttm.utils">dsipts.models.ttm.utils module</a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.ttm.html#module-dsipts.models.ttm">Module contents</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="dsipts.models.vva.html">dsipts.models.vva package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.vva.html#submodules">Submodules</a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.vva.html#module-dsipts.models.vva.minigpt">dsipts.models.vva.minigpt module</a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.vva.html#module-dsipts.models.vva.vqvae">dsipts.models.vva.vqvae module</a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.vva.html#module-dsipts.models.vva">Module contents</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="dsipts.models.xlstm.html">dsipts.models.xlstm package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.xlstm.html#submodules">Submodules</a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.xlstm.html#module-dsipts.models.xlstm.xLSTM">dsipts.models.xlstm.xLSTM module</a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.xlstm.html#module-dsipts.models.xlstm">Module contents</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="dsipts.models.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="dsipts.models.html#module-dsipts.models.Autoformer">dsipts.models.Autoformer module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="dsipts.models.html#dsipts.models.Autoformer.Autoformer"><code class="docutils literal notranslate"><span class="pre">Autoformer</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.Autoformer.Autoformer.allow_zero_length_dataloader_with_multiple_devices"><code class="docutils literal notranslate"><span class="pre">Autoformer.allow_zero_length_dataloader_with_multiple_devices</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.Autoformer.Autoformer.description"><code class="docutils literal notranslate"><span class="pre">Autoformer.description</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.Autoformer.Autoformer.forward"><code class="docutils literal notranslate"><span class="pre">Autoformer.forward()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.Autoformer.Autoformer.handle_categorical_variables"><code class="docutils literal notranslate"><span class="pre">Autoformer.handle_categorical_variables</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.Autoformer.Autoformer.handle_future_covariates"><code class="docutils literal notranslate"><span class="pre">Autoformer.handle_future_covariates</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.Autoformer.Autoformer.handle_multivariate"><code class="docutils literal notranslate"><span class="pre">Autoformer.handle_multivariate</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.Autoformer.Autoformer.handle_quantile_loss"><code class="docutils literal notranslate"><span class="pre">Autoformer.handle_quantile_loss</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.Autoformer.Autoformer.prepare_data_per_node"><code class="docutils literal notranslate"><span class="pre">Autoformer.prepare_data_per_node</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.Autoformer.Autoformer.training"><code class="docutils literal notranslate"><span class="pre">Autoformer.training</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="dsipts.models.html#module-dsipts.models.CrossFormer">dsipts.models.CrossFormer module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="dsipts.models.html#dsipts.models.CrossFormer.CrossFormer"><code class="docutils literal notranslate"><span class="pre">CrossFormer</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.CrossFormer.CrossFormer.allow_zero_length_dataloader_with_multiple_devices"><code class="docutils literal notranslate"><span class="pre">CrossFormer.allow_zero_length_dataloader_with_multiple_devices</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.CrossFormer.CrossFormer.description"><code class="docutils literal notranslate"><span class="pre">CrossFormer.description</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.CrossFormer.CrossFormer.forward"><code class="docutils literal notranslate"><span class="pre">CrossFormer.forward()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.CrossFormer.CrossFormer.handle_categorical_variables"><code class="docutils literal notranslate"><span class="pre">CrossFormer.handle_categorical_variables</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.CrossFormer.CrossFormer.handle_future_covariates"><code class="docutils literal notranslate"><span class="pre">CrossFormer.handle_future_covariates</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.CrossFormer.CrossFormer.handle_multivariate"><code class="docutils literal notranslate"><span class="pre">CrossFormer.handle_multivariate</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.CrossFormer.CrossFormer.handle_quantile_loss"><code class="docutils literal notranslate"><span class="pre">CrossFormer.handle_quantile_loss</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.CrossFormer.CrossFormer.prepare_data_per_node"><code class="docutils literal notranslate"><span class="pre">CrossFormer.prepare_data_per_node</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.CrossFormer.CrossFormer.training"><code class="docutils literal notranslate"><span class="pre">CrossFormer.training</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="dsipts.models.html#module-dsipts.models.D3VAE">dsipts.models.D3VAE module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="dsipts.models.html#dsipts.models.D3VAE.D3VAE"><code class="docutils literal notranslate"><span class="pre">D3VAE</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.D3VAE.D3VAE.forward"><code class="docutils literal notranslate"><span class="pre">D3VAE.forward()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.D3VAE.D3VAE.inference"><code class="docutils literal notranslate"><span class="pre">D3VAE.inference()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="dsipts.models.html#dsipts.models.D3VAE.copy_parameters"><code class="docutils literal notranslate"><span class="pre">copy_parameters()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="dsipts.models.html#module-dsipts.models.Diffusion">dsipts.models.Diffusion module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="dsipts.models.html#dsipts.models.Diffusion.Diffusion"><code class="docutils literal notranslate"><span class="pre">Diffusion</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.Diffusion.Diffusion.allow_zero_length_dataloader_with_multiple_devices"><code class="docutils literal notranslate"><span class="pre">Diffusion.allow_zero_length_dataloader_with_multiple_devices</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.Diffusion.Diffusion.cat_categorical_vars"><code class="docutils literal notranslate"><span class="pre">Diffusion.cat_categorical_vars()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.Diffusion.Diffusion.description"><code class="docutils literal notranslate"><span class="pre">Diffusion.description</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.Diffusion.Diffusion.forward"><code class="docutils literal notranslate"><span class="pre">Diffusion.forward()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.Diffusion.Diffusion.gaussian_likelihood"><code class="docutils literal notranslate"><span class="pre">Diffusion.gaussian_likelihood()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.Diffusion.Diffusion.gaussian_log_likelihood"><code class="docutils literal notranslate"><span class="pre">Diffusion.gaussian_log_likelihood()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.Diffusion.Diffusion.handle_categorical_variables"><code class="docutils literal notranslate"><span class="pre">Diffusion.handle_categorical_variables</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.Diffusion.Diffusion.handle_future_covariates"><code class="docutils literal notranslate"><span class="pre">Diffusion.handle_future_covariates</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.Diffusion.Diffusion.handle_multivariate"><code class="docutils literal notranslate"><span class="pre">Diffusion.handle_multivariate</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.Diffusion.Diffusion.handle_quantile_loss"><code class="docutils literal notranslate"><span class="pre">Diffusion.handle_quantile_loss</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.Diffusion.Diffusion.improving_weight_during_training"><code class="docutils literal notranslate"><span class="pre">Diffusion.improving_weight_during_training()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.Diffusion.Diffusion.inference"><code class="docutils literal notranslate"><span class="pre">Diffusion.inference()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.Diffusion.Diffusion.normal_kl"><code class="docutils literal notranslate"><span class="pre">Diffusion.normal_kl()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.Diffusion.Diffusion.prepare_data_per_node"><code class="docutils literal notranslate"><span class="pre">Diffusion.prepare_data_per_node</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.Diffusion.Diffusion.q_sample"><code class="docutils literal notranslate"><span class="pre">Diffusion.q_sample()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.Diffusion.Diffusion.remove_var"><code class="docutils literal notranslate"><span class="pre">Diffusion.remove_var()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.Diffusion.Diffusion.training"><code class="docutils literal notranslate"><span class="pre">Diffusion.training</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="dsipts.models.html#dsipts.models.Diffusion.SubNet1"><code class="docutils literal notranslate"><span class="pre">SubNet1</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.Diffusion.SubNet1.forward"><code class="docutils literal notranslate"><span class="pre">SubNet1.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="dsipts.models.html#dsipts.models.Diffusion.SubNet2"><code class="docutils literal notranslate"><span class="pre">SubNet2</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.Diffusion.SubNet2.forward"><code class="docutils literal notranslate"><span class="pre">SubNet2.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="dsipts.models.html#dsipts.models.Diffusion.SubNet3"><code class="docutils literal notranslate"><span class="pre">SubNet3</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.Diffusion.SubNet3.forward"><code class="docutils literal notranslate"><span class="pre">SubNet3.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="dsipts.models.html#module-dsipts.models.DilatedConv">dsipts.models.DilatedConv module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="dsipts.models.html#dsipts.models.DilatedConv.Block"><code class="docutils literal notranslate"><span class="pre">Block</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.DilatedConv.Block.forward"><code class="docutils literal notranslate"><span class="pre">Block.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="dsipts.models.html#dsipts.models.DilatedConv.DilatedConv"><code class="docutils literal notranslate"><span class="pre">DilatedConv</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.DilatedConv.DilatedConv.allow_zero_length_dataloader_with_multiple_devices"><code class="docutils literal notranslate"><span class="pre">DilatedConv.allow_zero_length_dataloader_with_multiple_devices</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.DilatedConv.DilatedConv.description"><code class="docutils literal notranslate"><span class="pre">DilatedConv.description</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.DilatedConv.DilatedConv.forward"><code class="docutils literal notranslate"><span class="pre">DilatedConv.forward()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.DilatedConv.DilatedConv.handle_categorical_variables"><code class="docutils literal notranslate"><span class="pre">DilatedConv.handle_categorical_variables</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.DilatedConv.DilatedConv.handle_future_covariates"><code class="docutils literal notranslate"><span class="pre">DilatedConv.handle_future_covariates</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.DilatedConv.DilatedConv.handle_multivariate"><code class="docutils literal notranslate"><span class="pre">DilatedConv.handle_multivariate</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.DilatedConv.DilatedConv.handle_quantile_loss"><code class="docutils literal notranslate"><span class="pre">DilatedConv.handle_quantile_loss</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.DilatedConv.DilatedConv.inference"><code class="docutils literal notranslate"><span class="pre">DilatedConv.inference()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.DilatedConv.DilatedConv.prepare_data_per_node"><code class="docutils literal notranslate"><span class="pre">DilatedConv.prepare_data_per_node</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.DilatedConv.DilatedConv.training"><code class="docutils literal notranslate"><span class="pre">DilatedConv.training</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="dsipts.models.html#dsipts.models.DilatedConv.GLU"><code class="docutils literal notranslate"><span class="pre">GLU</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.DilatedConv.GLU.forward"><code class="docutils literal notranslate"><span class="pre">GLU.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="dsipts.models.html#module-dsipts.models.DilatedConvED">dsipts.models.DilatedConvED module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="dsipts.models.html#dsipts.models.DilatedConvED.Block"><code class="docutils literal notranslate"><span class="pre">Block</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.DilatedConvED.Block.forward"><code class="docutils literal notranslate"><span class="pre">Block.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="dsipts.models.html#dsipts.models.DilatedConvED.DilatedConvED"><code class="docutils literal notranslate"><span class="pre">DilatedConvED</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.DilatedConvED.DilatedConvED.allow_zero_length_dataloader_with_multiple_devices"><code class="docutils literal notranslate"><span class="pre">DilatedConvED.allow_zero_length_dataloader_with_multiple_devices</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.DilatedConvED.DilatedConvED.description"><code class="docutils literal notranslate"><span class="pre">DilatedConvED.description</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.DilatedConvED.DilatedConvED.forward"><code class="docutils literal notranslate"><span class="pre">DilatedConvED.forward()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.DilatedConvED.DilatedConvED.handle_categorical_variables"><code class="docutils literal notranslate"><span class="pre">DilatedConvED.handle_categorical_variables</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.DilatedConvED.DilatedConvED.handle_future_covariates"><code class="docutils literal notranslate"><span class="pre">DilatedConvED.handle_future_covariates</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.DilatedConvED.DilatedConvED.handle_multivariate"><code class="docutils literal notranslate"><span class="pre">DilatedConvED.handle_multivariate</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.DilatedConvED.DilatedConvED.handle_quantile_loss"><code class="docutils literal notranslate"><span class="pre">DilatedConvED.handle_quantile_loss</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.DilatedConvED.DilatedConvED.prepare_data_per_node"><code class="docutils literal notranslate"><span class="pre">DilatedConvED.prepare_data_per_node</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.DilatedConvED.DilatedConvED.training"><code class="docutils literal notranslate"><span class="pre">DilatedConvED.training</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="dsipts.models.html#dsipts.models.DilatedConvED.GLU"><code class="docutils literal notranslate"><span class="pre">GLU</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.DilatedConvED.GLU.forward"><code class="docutils literal notranslate"><span class="pre">GLU.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="dsipts.models.html#module-dsipts.models.Duet">dsipts.models.Duet module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="dsipts.models.html#dsipts.models.Duet.Duet"><code class="docutils literal notranslate"><span class="pre">Duet</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.Duet.Duet.allow_zero_length_dataloader_with_multiple_devices"><code class="docutils literal notranslate"><span class="pre">Duet.allow_zero_length_dataloader_with_multiple_devices</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.Duet.Duet.description"><code class="docutils literal notranslate"><span class="pre">Duet.description</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.Duet.Duet.forward"><code class="docutils literal notranslate"><span class="pre">Duet.forward()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.Duet.Duet.handle_categorical_variables"><code class="docutils literal notranslate"><span class="pre">Duet.handle_categorical_variables</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.Duet.Duet.handle_future_covariates"><code class="docutils literal notranslate"><span class="pre">Duet.handle_future_covariates</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.Duet.Duet.handle_multivariate"><code class="docutils literal notranslate"><span class="pre">Duet.handle_multivariate</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.Duet.Duet.handle_quantile_loss"><code class="docutils literal notranslate"><span class="pre">Duet.handle_quantile_loss</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.Duet.Duet.prepare_data_per_node"><code class="docutils literal notranslate"><span class="pre">Duet.prepare_data_per_node</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.Duet.Duet.training"><code class="docutils literal notranslate"><span class="pre">Duet.training</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="dsipts.models.html#module-dsipts.models.ITransformer">dsipts.models.ITransformer module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="dsipts.models.html#dsipts.models.ITransformer.ITransformer"><code class="docutils literal notranslate"><span class="pre">ITransformer</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.ITransformer.ITransformer.allow_zero_length_dataloader_with_multiple_devices"><code class="docutils literal notranslate"><span class="pre">ITransformer.allow_zero_length_dataloader_with_multiple_devices</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.ITransformer.ITransformer.description"><code class="docutils literal notranslate"><span class="pre">ITransformer.description</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.ITransformer.ITransformer.forecast"><code class="docutils literal notranslate"><span class="pre">ITransformer.forecast()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.ITransformer.ITransformer.forward"><code class="docutils literal notranslate"><span class="pre">ITransformer.forward()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.ITransformer.ITransformer.handle_categorical_variables"><code class="docutils literal notranslate"><span class="pre">ITransformer.handle_categorical_variables</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.ITransformer.ITransformer.handle_future_covariates"><code class="docutils literal notranslate"><span class="pre">ITransformer.handle_future_covariates</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.ITransformer.ITransformer.handle_multivariate"><code class="docutils literal notranslate"><span class="pre">ITransformer.handle_multivariate</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.ITransformer.ITransformer.handle_quantile_loss"><code class="docutils literal notranslate"><span class="pre">ITransformer.handle_quantile_loss</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.ITransformer.ITransformer.prepare_data_per_node"><code class="docutils literal notranslate"><span class="pre">ITransformer.prepare_data_per_node</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.ITransformer.ITransformer.training"><code class="docutils literal notranslate"><span class="pre">ITransformer.training</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="dsipts.models.html#module-dsipts.models.Informer">dsipts.models.Informer module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="dsipts.models.html#dsipts.models.Informer.Informer"><code class="docutils literal notranslate"><span class="pre">Informer</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.Informer.Informer.allow_zero_length_dataloader_with_multiple_devices"><code class="docutils literal notranslate"><span class="pre">Informer.allow_zero_length_dataloader_with_multiple_devices</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.Informer.Informer.description"><code class="docutils literal notranslate"><span class="pre">Informer.description</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.Informer.Informer.forward"><code class="docutils literal notranslate"><span class="pre">Informer.forward()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.Informer.Informer.handle_categorical_variables"><code class="docutils literal notranslate"><span class="pre">Informer.handle_categorical_variables</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.Informer.Informer.handle_future_covariates"><code class="docutils literal notranslate"><span class="pre">Informer.handle_future_covariates</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.Informer.Informer.handle_multivariate"><code class="docutils literal notranslate"><span class="pre">Informer.handle_multivariate</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.Informer.Informer.handle_quantile_loss"><code class="docutils literal notranslate"><span class="pre">Informer.handle_quantile_loss</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.Informer.Informer.prepare_data_per_node"><code class="docutils literal notranslate"><span class="pre">Informer.prepare_data_per_node</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.Informer.Informer.training"><code class="docutils literal notranslate"><span class="pre">Informer.training</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="dsipts.models.html#module-dsipts.models.LinearTS">dsipts.models.LinearTS module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="dsipts.models.html#dsipts.models.LinearTS.LinearTS"><code class="docutils literal notranslate"><span class="pre">LinearTS</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.LinearTS.LinearTS.allow_zero_length_dataloader_with_multiple_devices"><code class="docutils literal notranslate"><span class="pre">LinearTS.allow_zero_length_dataloader_with_multiple_devices</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.LinearTS.LinearTS.description"><code class="docutils literal notranslate"><span class="pre">LinearTS.description</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.LinearTS.LinearTS.forward"><code class="docutils literal notranslate"><span class="pre">LinearTS.forward()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.LinearTS.LinearTS.handle_categorical_variables"><code class="docutils literal notranslate"><span class="pre">LinearTS.handle_categorical_variables</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.LinearTS.LinearTS.handle_future_covariates"><code class="docutils literal notranslate"><span class="pre">LinearTS.handle_future_covariates</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.LinearTS.LinearTS.handle_multivariate"><code class="docutils literal notranslate"><span class="pre">LinearTS.handle_multivariate</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.LinearTS.LinearTS.handle_quantile_loss"><code class="docutils literal notranslate"><span class="pre">LinearTS.handle_quantile_loss</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.LinearTS.LinearTS.prepare_data_per_node"><code class="docutils literal notranslate"><span class="pre">LinearTS.prepare_data_per_node</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.LinearTS.LinearTS.training"><code class="docutils literal notranslate"><span class="pre">LinearTS.training</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="dsipts.models.html#dsipts.models.LinearTS.moving_avg"><code class="docutils literal notranslate"><span class="pre">moving_avg</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.LinearTS.moving_avg.forward"><code class="docutils literal notranslate"><span class="pre">moving_avg.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="dsipts.models.html#dsipts.models.LinearTS.series_decomp"><code class="docutils literal notranslate"><span class="pre">series_decomp</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.LinearTS.series_decomp.forward"><code class="docutils literal notranslate"><span class="pre">series_decomp.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="dsipts.models.html#module-dsipts.models.PatchTST">dsipts.models.PatchTST module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="dsipts.models.html#dsipts.models.PatchTST.PatchTST"><code class="docutils literal notranslate"><span class="pre">PatchTST</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.PatchTST.PatchTST.allow_zero_length_dataloader_with_multiple_devices"><code class="docutils literal notranslate"><span class="pre">PatchTST.allow_zero_length_dataloader_with_multiple_devices</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.PatchTST.PatchTST.description"><code class="docutils literal notranslate"><span class="pre">PatchTST.description</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.PatchTST.PatchTST.forward"><code class="docutils literal notranslate"><span class="pre">PatchTST.forward()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.PatchTST.PatchTST.handle_categorical_variables"><code class="docutils literal notranslate"><span class="pre">PatchTST.handle_categorical_variables</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.PatchTST.PatchTST.handle_future_covariates"><code class="docutils literal notranslate"><span class="pre">PatchTST.handle_future_covariates</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.PatchTST.PatchTST.handle_multivariate"><code class="docutils literal notranslate"><span class="pre">PatchTST.handle_multivariate</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.PatchTST.PatchTST.handle_quantile_loss"><code class="docutils literal notranslate"><span class="pre">PatchTST.handle_quantile_loss</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.PatchTST.PatchTST.prepare_data_per_node"><code class="docutils literal notranslate"><span class="pre">PatchTST.prepare_data_per_node</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.PatchTST.PatchTST.training"><code class="docutils literal notranslate"><span class="pre">PatchTST.training</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="dsipts.models.html#module-dsipts.models.Persistent">dsipts.models.Persistent module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="dsipts.models.html#dsipts.models.Persistent.Persistent"><code class="docutils literal notranslate"><span class="pre">Persistent</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.Persistent.Persistent.allow_zero_length_dataloader_with_multiple_devices"><code class="docutils literal notranslate"><span class="pre">Persistent.allow_zero_length_dataloader_with_multiple_devices</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.Persistent.Persistent.description"><code class="docutils literal notranslate"><span class="pre">Persistent.description</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.Persistent.Persistent.forward"><code class="docutils literal notranslate"><span class="pre">Persistent.forward()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.Persistent.Persistent.handle_categorical_variables"><code class="docutils literal notranslate"><span class="pre">Persistent.handle_categorical_variables</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.Persistent.Persistent.handle_future_covariates"><code class="docutils literal notranslate"><span class="pre">Persistent.handle_future_covariates</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.Persistent.Persistent.handle_multivariate"><code class="docutils literal notranslate"><span class="pre">Persistent.handle_multivariate</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.Persistent.Persistent.handle_quantile_loss"><code class="docutils literal notranslate"><span class="pre">Persistent.handle_quantile_loss</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.Persistent.Persistent.prepare_data_per_node"><code class="docutils literal notranslate"><span class="pre">Persistent.prepare_data_per_node</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.Persistent.Persistent.training"><code class="docutils literal notranslate"><span class="pre">Persistent.training</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="dsipts.models.html#module-dsipts.models.RNN">dsipts.models.RNN module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="dsipts.models.html#dsipts.models.RNN.MyBN"><code class="docutils literal notranslate"><span class="pre">MyBN</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.RNN.MyBN.forward"><code class="docutils literal notranslate"><span class="pre">MyBN.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="dsipts.models.html#dsipts.models.RNN.RNN"><code class="docutils literal notranslate"><span class="pre">RNN</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.RNN.RNN.allow_zero_length_dataloader_with_multiple_devices"><code class="docutils literal notranslate"><span class="pre">RNN.allow_zero_length_dataloader_with_multiple_devices</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.RNN.RNN.forward"><code class="docutils literal notranslate"><span class="pre">RNN.forward()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.RNN.RNN.handle_categorical_variables"><code class="docutils literal notranslate"><span class="pre">RNN.handle_categorical_variables</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.RNN.RNN.handle_future_covariates"><code class="docutils literal notranslate"><span class="pre">RNN.handle_future_covariates</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.RNN.RNN.handle_multivariate"><code class="docutils literal notranslate"><span class="pre">RNN.handle_multivariate</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.RNN.RNN.handle_quantile_loss"><code class="docutils literal notranslate"><span class="pre">RNN.handle_quantile_loss</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.RNN.RNN.prepare_data_per_node"><code class="docutils literal notranslate"><span class="pre">RNN.prepare_data_per_node</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.RNN.RNN.training"><code class="docutils literal notranslate"><span class="pre">RNN.training</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="dsipts.models.html#module-dsipts.models.Samformer">dsipts.models.Samformer module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="dsipts.models.html#dsipts.models.Samformer.Samformer"><code class="docutils literal notranslate"><span class="pre">Samformer</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.Samformer.Samformer.allow_zero_length_dataloader_with_multiple_devices"><code class="docutils literal notranslate"><span class="pre">Samformer.allow_zero_length_dataloader_with_multiple_devices</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.Samformer.Samformer.description"><code class="docutils literal notranslate"><span class="pre">Samformer.description</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.Samformer.Samformer.forward"><code class="docutils literal notranslate"><span class="pre">Samformer.forward()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.Samformer.Samformer.handle_categorical_variables"><code class="docutils literal notranslate"><span class="pre">Samformer.handle_categorical_variables</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.Samformer.Samformer.handle_future_covariates"><code class="docutils literal notranslate"><span class="pre">Samformer.handle_future_covariates</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.Samformer.Samformer.handle_multivariate"><code class="docutils literal notranslate"><span class="pre">Samformer.handle_multivariate</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.Samformer.Samformer.handle_quantile_loss"><code class="docutils literal notranslate"><span class="pre">Samformer.handle_quantile_loss</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.Samformer.Samformer.prepare_data_per_node"><code class="docutils literal notranslate"><span class="pre">Samformer.prepare_data_per_node</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.Samformer.Samformer.training"><code class="docutils literal notranslate"><span class="pre">Samformer.training</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="dsipts.models.html#module-dsipts.models.Simple">dsipts.models.Simple module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="dsipts.models.html#dsipts.models.Simple.Simple"><code class="docutils literal notranslate"><span class="pre">Simple</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.Simple.Simple.allow_zero_length_dataloader_with_multiple_devices"><code class="docutils literal notranslate"><span class="pre">Simple.allow_zero_length_dataloader_with_multiple_devices</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.Simple.Simple.description"><code class="docutils literal notranslate"><span class="pre">Simple.description</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.Simple.Simple.forward"><code class="docutils literal notranslate"><span class="pre">Simple.forward()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.Simple.Simple.handle_categorical_variables"><code class="docutils literal notranslate"><span class="pre">Simple.handle_categorical_variables</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.Simple.Simple.handle_future_covariates"><code class="docutils literal notranslate"><span class="pre">Simple.handle_future_covariates</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.Simple.Simple.handle_multivariate"><code class="docutils literal notranslate"><span class="pre">Simple.handle_multivariate</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.Simple.Simple.handle_quantile_loss"><code class="docutils literal notranslate"><span class="pre">Simple.handle_quantile_loss</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.Simple.Simple.prepare_data_per_node"><code class="docutils literal notranslate"><span class="pre">Simple.prepare_data_per_node</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.Simple.Simple.training"><code class="docutils literal notranslate"><span class="pre">Simple.training</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="dsipts.models.html#module-dsipts.models.TFT">dsipts.models.TFT module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="dsipts.models.html#dsipts.models.TFT.TFT"><code class="docutils literal notranslate"><span class="pre">TFT</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.TFT.TFT.allow_zero_length_dataloader_with_multiple_devices"><code class="docutils literal notranslate"><span class="pre">TFT.allow_zero_length_dataloader_with_multiple_devices</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.TFT.TFT.description"><code class="docutils literal notranslate"><span class="pre">TFT.description</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.TFT.TFT.forward"><code class="docutils literal notranslate"><span class="pre">TFT.forward()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.TFT.TFT.handle_categorical_variables"><code class="docutils literal notranslate"><span class="pre">TFT.handle_categorical_variables</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.TFT.TFT.handle_future_covariates"><code class="docutils literal notranslate"><span class="pre">TFT.handle_future_covariates</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.TFT.TFT.handle_multivariate"><code class="docutils literal notranslate"><span class="pre">TFT.handle_multivariate</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.TFT.TFT.handle_quantile_loss"><code class="docutils literal notranslate"><span class="pre">TFT.handle_quantile_loss</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.TFT.TFT.prepare_data_per_node"><code class="docutils literal notranslate"><span class="pre">TFT.prepare_data_per_node</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.TFT.TFT.remove_var"><code class="docutils literal notranslate"><span class="pre">TFT.remove_var()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.TFT.TFT.training"><code class="docutils literal notranslate"><span class="pre">TFT.training</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="dsipts.models.html#module-dsipts.models.TIDE">dsipts.models.TIDE module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="dsipts.models.html#dsipts.models.TIDE.ResidualBlock"><code class="docutils literal notranslate"><span class="pre">ResidualBlock</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.TIDE.ResidualBlock.forward"><code class="docutils literal notranslate"><span class="pre">ResidualBlock.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="dsipts.models.html#dsipts.models.TIDE.TIDE"><code class="docutils literal notranslate"><span class="pre">TIDE</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.TIDE.TIDE.allow_zero_length_dataloader_with_multiple_devices"><code class="docutils literal notranslate"><span class="pre">TIDE.allow_zero_length_dataloader_with_multiple_devices</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.TIDE.TIDE.description"><code class="docutils literal notranslate"><span class="pre">TIDE.description</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.TIDE.TIDE.forward"><code class="docutils literal notranslate"><span class="pre">TIDE.forward()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.TIDE.TIDE.handle_categorical_variables"><code class="docutils literal notranslate"><span class="pre">TIDE.handle_categorical_variables</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.TIDE.TIDE.handle_future_covariates"><code class="docutils literal notranslate"><span class="pre">TIDE.handle_future_covariates</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.TIDE.TIDE.handle_multivariate"><code class="docutils literal notranslate"><span class="pre">TIDE.handle_multivariate</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.TIDE.TIDE.handle_quantile_loss"><code class="docutils literal notranslate"><span class="pre">TIDE.handle_quantile_loss</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.TIDE.TIDE.prepare_data_per_node"><code class="docutils literal notranslate"><span class="pre">TIDE.prepare_data_per_node</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.TIDE.TIDE.remove_var"><code class="docutils literal notranslate"><span class="pre">TIDE.remove_var()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.TIDE.TIDE.training"><code class="docutils literal notranslate"><span class="pre">TIDE.training</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="dsipts.models.html#module-dsipts.models.TTM">dsipts.models.TTM module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="dsipts.models.html#dsipts.models.TTM.TTM"><code class="docutils literal notranslate"><span class="pre">TTM</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.TTM.TTM.forward"><code class="docutils literal notranslate"><span class="pre">TTM.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="dsipts.models.html#module-dsipts.models.TimeXER">dsipts.models.TimeXER module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="dsipts.models.html#dsipts.models.TimeXER.TimeXER"><code class="docutils literal notranslate"><span class="pre">TimeXER</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.TimeXER.TimeXER.allow_zero_length_dataloader_with_multiple_devices"><code class="docutils literal notranslate"><span class="pre">TimeXER.allow_zero_length_dataloader_with_multiple_devices</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.TimeXER.TimeXER.description"><code class="docutils literal notranslate"><span class="pre">TimeXER.description</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.TimeXER.TimeXER.forward"><code class="docutils literal notranslate"><span class="pre">TimeXER.forward()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.TimeXER.TimeXER.handle_categorical_variables"><code class="docutils literal notranslate"><span class="pre">TimeXER.handle_categorical_variables</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.TimeXER.TimeXER.handle_future_covariates"><code class="docutils literal notranslate"><span class="pre">TimeXER.handle_future_covariates</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.TimeXER.TimeXER.handle_multivariate"><code class="docutils literal notranslate"><span class="pre">TimeXER.handle_multivariate</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.TimeXER.TimeXER.handle_quantile_loss"><code class="docutils literal notranslate"><span class="pre">TimeXER.handle_quantile_loss</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.TimeXER.TimeXER.prepare_data_per_node"><code class="docutils literal notranslate"><span class="pre">TimeXER.prepare_data_per_node</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.TimeXER.TimeXER.training"><code class="docutils literal notranslate"><span class="pre">TimeXER.training</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="dsipts.models.html#module-dsipts.models.VQVAEA">dsipts.models.VQVAEA module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="dsipts.models.html#dsipts.models.VQVAEA.VQVAEA"><code class="docutils literal notranslate"><span class="pre">VQVAEA</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.VQVAEA.VQVAEA.allow_zero_length_dataloader_with_multiple_devices"><code class="docutils literal notranslate"><span class="pre">VQVAEA.allow_zero_length_dataloader_with_multiple_devices</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.VQVAEA.VQVAEA.description"><code class="docutils literal notranslate"><span class="pre">VQVAEA.description</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.VQVAEA.VQVAEA.forward"><code class="docutils literal notranslate"><span class="pre">VQVAEA.forward()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.VQVAEA.VQVAEA.generate"><code class="docutils literal notranslate"><span class="pre">VQVAEA.generate()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.VQVAEA.VQVAEA.gpt"><code class="docutils literal notranslate"><span class="pre">VQVAEA.gpt()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.VQVAEA.VQVAEA.handle_categorical_variables"><code class="docutils literal notranslate"><span class="pre">VQVAEA.handle_categorical_variables</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.VQVAEA.VQVAEA.handle_future_covariates"><code class="docutils literal notranslate"><span class="pre">VQVAEA.handle_future_covariates</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.VQVAEA.VQVAEA.handle_multivariate"><code class="docutils literal notranslate"><span class="pre">VQVAEA.handle_multivariate</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.VQVAEA.VQVAEA.handle_quantile_loss"><code class="docutils literal notranslate"><span class="pre">VQVAEA.handle_quantile_loss</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.VQVAEA.VQVAEA.inference"><code class="docutils literal notranslate"><span class="pre">VQVAEA.inference()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.VQVAEA.VQVAEA.prepare_data_per_node"><code class="docutils literal notranslate"><span class="pre">VQVAEA.prepare_data_per_node</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.VQVAEA.VQVAEA.training"><code class="docutils literal notranslate"><span class="pre">VQVAEA.training</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="dsipts.models.html#dsipts.models.VQVAEA.random"><code class="docutils literal notranslate"><span class="pre">random()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="dsipts.models.html#module-dsipts.models.VVA">dsipts.models.VVA module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="dsipts.models.html#dsipts.models.VVA.VVA"><code class="docutils literal notranslate"><span class="pre">VVA</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.VVA.VVA.allow_zero_length_dataloader_with_multiple_devices"><code class="docutils literal notranslate"><span class="pre">VVA.allow_zero_length_dataloader_with_multiple_devices</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.VVA.VVA.configure_optimizers"><code class="docutils literal notranslate"><span class="pre">VVA.configure_optimizers()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.VVA.VVA.description"><code class="docutils literal notranslate"><span class="pre">VVA.description</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.VVA.VVA.forward"><code class="docutils literal notranslate"><span class="pre">VVA.forward()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.VVA.VVA.generate"><code class="docutils literal notranslate"><span class="pre">VVA.generate()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.VVA.VVA.handle_categorical_variables"><code class="docutils literal notranslate"><span class="pre">VVA.handle_categorical_variables</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.VVA.VVA.handle_future_covariates"><code class="docutils literal notranslate"><span class="pre">VVA.handle_future_covariates</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.VVA.VVA.handle_multivariate"><code class="docutils literal notranslate"><span class="pre">VVA.handle_multivariate</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.VVA.VVA.handle_quantile_loss"><code class="docutils literal notranslate"><span class="pre">VVA.handle_quantile_loss</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.VVA.VVA.inference"><code class="docutils literal notranslate"><span class="pre">VVA.inference()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.VVA.VVA.prepare_data_per_node"><code class="docutils literal notranslate"><span class="pre">VVA.prepare_data_per_node</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.VVA.VVA.training"><code class="docutils literal notranslate"><span class="pre">VVA.training</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="dsipts.models.html#module-dsipts.models.base">dsipts.models.base module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="dsipts.models.html#dsipts.models.base.Base"><code class="docutils literal notranslate"><span class="pre">Base</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.base.Base.description"><code class="docutils literal notranslate"><span class="pre">Base.description</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.base.Base.forward"><code class="docutils literal notranslate"><span class="pre">Base.forward()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.base.Base.handle_categorical_variables"><code class="docutils literal notranslate"><span class="pre">Base.handle_categorical_variables</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.base.Base.handle_future_covariates"><code class="docutils literal notranslate"><span class="pre">Base.handle_future_covariates</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.base.Base.handle_multivariate"><code class="docutils literal notranslate"><span class="pre">Base.handle_multivariate</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.base.Base.handle_quantile_loss"><code class="docutils literal notranslate"><span class="pre">Base.handle_quantile_loss</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.base.Base.inference"><code class="docutils literal notranslate"><span class="pre">Base.inference()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="dsipts.models.html#dsipts.models.base.dilate_loss"><code class="docutils literal notranslate"><span class="pre">dilate_loss()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="dsipts.models.html#dsipts.models.base.standardize_momentum"><code class="docutils literal notranslate"><span class="pre">standardize_momentum()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="dsipts.models.html#module-dsipts.models.base_v2">dsipts.models.base_v2 module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="dsipts.models.html#dsipts.models.base_v2.Base"><code class="docutils literal notranslate"><span class="pre">Base</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.base_v2.Base.allow_zero_length_dataloader_with_multiple_devices"><code class="docutils literal notranslate"><span class="pre">Base.allow_zero_length_dataloader_with_multiple_devices</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.base_v2.Base.description"><code class="docutils literal notranslate"><span class="pre">Base.description</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.base_v2.Base.forward"><code class="docutils literal notranslate"><span class="pre">Base.forward()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.base_v2.Base.handle_categorical_variables"><code class="docutils literal notranslate"><span class="pre">Base.handle_categorical_variables</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.base_v2.Base.handle_future_covariates"><code class="docutils literal notranslate"><span class="pre">Base.handle_future_covariates</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.base_v2.Base.handle_multivariate"><code class="docutils literal notranslate"><span class="pre">Base.handle_multivariate</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.base_v2.Base.handle_quantile_loss"><code class="docutils literal notranslate"><span class="pre">Base.handle_quantile_loss</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.base_v2.Base.inference"><code class="docutils literal notranslate"><span class="pre">Base.inference()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.base_v2.Base.prepare_data_per_node"><code class="docutils literal notranslate"><span class="pre">Base.prepare_data_per_node</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.base_v2.Base.training"><code class="docutils literal notranslate"><span class="pre">Base.training</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="dsipts.models.html#dsipts.models.base_v2.dilate_loss"><code class="docutils literal notranslate"><span class="pre">dilate_loss()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="dsipts.models.html#dsipts.models.base_v2.standardize_momentum"><code class="docutils literal notranslate"><span class="pre">standardize_momentum()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="dsipts.models.html#module-dsipts.models.utils">dsipts.models.utils module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="dsipts.models.html#dsipts.models.utils.CPRS"><code class="docutils literal notranslate"><span class="pre">CPRS</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.utils.CPRS.forward"><code class="docutils literal notranslate"><span class="pre">CPRS.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="dsipts.models.html#dsipts.models.utils.Embedding_cat_variables"><code class="docutils literal notranslate"><span class="pre">Embedding_cat_variables</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.utils.Embedding_cat_variables.forward"><code class="docutils literal notranslate"><span class="pre">Embedding_cat_variables.forward()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.utils.Embedding_cat_variables.get_cat_n_embd"><code class="docutils literal notranslate"><span class="pre">Embedding_cat_variables.get_cat_n_embd()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="dsipts.models.html#dsipts.models.utils.L1Loss"><code class="docutils literal notranslate"><span class="pre">L1Loss</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.utils.L1Loss.forward"><code class="docutils literal notranslate"><span class="pre">L1Loss.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="dsipts.models.html#dsipts.models.utils.PathDTWBatch"><code class="docutils literal notranslate"><span class="pre">PathDTWBatch</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.utils.PathDTWBatch.backward"><code class="docutils literal notranslate"><span class="pre">PathDTWBatch.backward()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.utils.PathDTWBatch.forward"><code class="docutils literal notranslate"><span class="pre">PathDTWBatch.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="dsipts.models.html#dsipts.models.utils.Permute"><code class="docutils literal notranslate"><span class="pre">Permute</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.utils.Permute.forward"><code class="docutils literal notranslate"><span class="pre">Permute.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="dsipts.models.html#dsipts.models.utils.QuantileLossMO"><code class="docutils literal notranslate"><span class="pre">QuantileLossMO</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.utils.QuantileLossMO.forward"><code class="docutils literal notranslate"><span class="pre">QuantileLossMO.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="dsipts.models.html#dsipts.models.utils.SinkhornDistance"><code class="docutils literal notranslate"><span class="pre">SinkhornDistance</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.utils.SinkhornDistance.M"><code class="docutils literal notranslate"><span class="pre">SinkhornDistance.M()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.utils.SinkhornDistance.ave"><code class="docutils literal notranslate"><span class="pre">SinkhornDistance.ave()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.utils.SinkhornDistance.compute"><code class="docutils literal notranslate"><span class="pre">SinkhornDistance.compute()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="dsipts.models.html#dsipts.models.utils.SoftDTWBatch"><code class="docutils literal notranslate"><span class="pre">SoftDTWBatch</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.utils.SoftDTWBatch.backward"><code class="docutils literal notranslate"><span class="pre">SoftDTWBatch.backward()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dsipts.models.html#dsipts.models.utils.SoftDTWBatch.forward"><code class="docutils literal notranslate"><span class="pre">SoftDTWBatch.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="dsipts.models.html#dsipts.models.utils.compute_softdtw"><code class="docutils literal notranslate"><span class="pre">compute_softdtw()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="dsipts.models.html#dsipts.models.utils.compute_softdtw_backward"><code class="docutils literal notranslate"><span class="pre">compute_softdtw_backward()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="dsipts.models.html#dsipts.models.utils.dtw_grad"><code class="docutils literal notranslate"><span class="pre">dtw_grad()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="dsipts.models.html#dsipts.models.utils.dtw_hessian_prod"><code class="docutils literal notranslate"><span class="pre">dtw_hessian_prod()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="dsipts.models.html#dsipts.models.utils.get_activation"><code class="docutils literal notranslate"><span class="pre">get_activation()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="dsipts.models.html#dsipts.models.utils.get_scope"><code class="docutils literal notranslate"><span class="pre">get_scope()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="dsipts.models.html#dsipts.models.utils.my_max"><code class="docutils literal notranslate"><span class="pre">my_max()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="dsipts.models.html#dsipts.models.utils.my_max_hessian_product"><code class="docutils literal notranslate"><span class="pre">my_max_hessian_product()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="dsipts.models.html#dsipts.models.utils.my_min"><code class="docutils literal notranslate"><span class="pre">my_min()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="dsipts.models.html#dsipts.models.utils.my_min_hessian_product"><code class="docutils literal notranslate"><span class="pre">my_min_hessian_product()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="dsipts.models.html#dsipts.models.utils.pairwise_distances"><code class="docutils literal notranslate"><span class="pre">pairwise_distances()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="dsipts.models.html#dsipts.models.utils.weight_init"><code class="docutils literal notranslate"><span class="pre">weight_init()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="dsipts.models.html#dsipts.models.utils.weight_init_zeros"><code class="docutils literal notranslate"><span class="pre">weight_init_zeros()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="dsipts.models.html#module-dsipts.models">Module contents</a></li>
</ul>
</li>
</ul>
</div>
</section>
<section id="module-dsipts">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-dsipts" title="Link to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="dsipts.Autoformer">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dsipts.</span></span><span class="sig-name descname"><span class="pre">Autoformer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">label_len</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout_rate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">activation</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'torch.nn.ReLU'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">factor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_head</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_layer_encoder</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_layer_decoder</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hidden_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1048</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dsipts.Autoformer" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="dsipts.models.html#dsipts.models.base_v2.Base" title="dsipts.models.base_v2.Base"><code class="xref py py-class docutils literal notranslate"><span class="pre">Base</span></code></a></p>
<p>Autoformer from <a class="reference external" href="https://github.com/cure-lab/LTSF-Linear">https://github.com/cure-lab/LTSF-Linear</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>label_len</strong> (<em>int</em>) – see the original implementation, seems like a warmup dimension (the decoder part will produce also some past predictions that are filter out at the end)</p></li>
<li><p><strong>d_model</strong> (<em>int</em>) – embedding dimension of the attention layer</p></li>
<li><p><strong>dropout_rate</strong> (<em>float</em>) – dropout raye</p></li>
<li><p><strong>kernel_size</strong> (<em>int</em>) – kernel size</p></li>
<li><p><strong>activation</strong> (<em>str</em><em>, </em><em>optional</em>) – _description_. Defaults to ‘torch.nn.ReLU’.</p></li>
<li><p><strong>factor</strong> (<em>int</em><em>, </em><em>optional</em>) – parameter of <cite>.autoformer.layers.AutoCorrelation</cite> for find the top k. Defaults to 0.5.</p></li>
<li><p><strong>n_head</strong> (<em>int</em><em>, </em><em>optional</em>) – number of heads. Defaults to 1.</p></li>
<li><p><strong>n_layer_encoder</strong> (<em>int</em><em>, </em><em>optional</em>) – number of  encoder layers. Defaults to 2.</p></li>
<li><p><strong>n_layer_decoder</strong> (<em>int</em><em>, </em><em>optional</em>) – number of decoder layers. Defaults to 2.</p></li>
<li><p><strong>hidden_size</strong> (<em>int</em><em>, </em><em>optional</em>) – output dimension of the transformer layer. Defaults to 1048.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="dsipts.Autoformer.description">
<span class="sig-name descname"><span class="pre">description</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'Can</span>&#160;&#160; <span class="pre">handle</span> <span class="pre">multivariate</span> <span class="pre">output</span> <span class="pre">\nCan</span>&#160;&#160; <span class="pre">handle</span> <span class="pre">future</span> <span class="pre">covariates\nCan</span>&#160;&#160; <span class="pre">handle</span> <span class="pre">categorical</span> <span class="pre">covariates\nCan</span>&#160;&#160; <span class="pre">handle</span> <span class="pre">Quantile</span> <span class="pre">loss</span> <span class="pre">function'</span></em><a class="headerlink" href="#dsipts.Autoformer.description" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dsipts.Autoformer.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dsipts.Autoformer.forward" title="Link to this definition">¶</a></dt>
<dd><p>Forlward method used during the training loop</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>batch</strong> (<em>dict</em>) – the batch structure. The keys are:
y : the target variable(s). This is always present
x_num_past: the numerical past variables. This is always present
x_num_future: the numerical future variables
x_cat_past: the categorical past variables
x_cat_future: the categorical future variables
idx_target: index of target features in the past array</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>output of the mode;</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dsipts.Autoformer.handle_categorical_variables">
<span class="sig-name descname"><span class="pre">handle_categorical_variables</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#dsipts.Autoformer.handle_categorical_variables" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dsipts.Autoformer.handle_future_covariates">
<span class="sig-name descname"><span class="pre">handle_future_covariates</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#dsipts.Autoformer.handle_future_covariates" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dsipts.Autoformer.handle_multivariate">
<span class="sig-name descname"><span class="pre">handle_multivariate</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#dsipts.Autoformer.handle_multivariate" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dsipts.Autoformer.handle_quantile_loss">
<span class="sig-name descname"><span class="pre">handle_quantile_loss</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#dsipts.Autoformer.handle_quantile_loss" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dsipts.Base">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dsipts.</span></span><span class="sig-name descname"><span class="pre">Base</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">past_steps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">future_steps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">past_channels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">future_channels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_channels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">embs_past</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">embs_fut</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_classes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">persistence_weight</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'l1'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quantiles</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reduction_mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'mean'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_classical_positional_encoder</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emb_dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">16</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optim_config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scheduler_config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dsipts.Base" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">LightningModule</span></code></p>
<p>This is the basic model, each model implemented must overwrite the init method and the forward method.
The inference step is optional, by default it uses the forward method but for recurrent
network you should implement your own method</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>verbose</strong> (<em>bool</em>) – Flag to enable verbose logging.</p></li>
<li><p><strong>past_steps</strong> (<em>int</em>) – Number of past time steps to consider.</p></li>
<li><p><strong>future_steps</strong> (<em>int</em>) – Number of future time steps to predict.</p></li>
<li><p><strong>past_channels</strong> (<em>int</em>) – Number of channels in the past input data.</p></li>
<li><p><strong>future_channels</strong> (<em>int</em>) – Number of channels in the future input data.</p></li>
<li><p><strong>out_channels</strong> (<em>int</em>) – Number of output channels.</p></li>
<li><p><strong>embs_past</strong> (<em>List</em><em>[</em><em>int</em><em>]</em>) – List of embedding dimensions for past data.</p></li>
<li><p><strong>embs_fut</strong> (<em>List</em><em>[</em><em>int</em><em>]</em>) – List of embedding dimensions for future data.</p></li>
<li><p><strong>n_classes</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of classes for classification. Defaults to 0.</p></li>
<li><p><strong>persistence_weight</strong> (<em>float</em><em>, </em><em>optional</em>) – Weight for persistence in loss calculation. Defaults to 0.0.</p></li>
<li><p><strong>loss_type</strong> (<em>str</em><em>, </em><em>optional</em>) – Type of loss function to use (‘l1’ or ‘mse’). Defaults to ‘l1’.</p></li>
<li><p><strong>quantiles</strong> (<em>List</em><em>[</em><em>int</em><em>]</em><em>, </em><em>optional</em>) – List of quantiles for quantile loss. Defaults to an empty list.</p></li>
<li><p><strong>reduction_mode</strong> (<em>str</em><em>, </em><em>optional</em>) – Mode for reduction for categorical embedding layer (‘mean’, ‘sum’, ‘none’). Defaults to ‘mean’.</p></li>
<li><p><strong>use_classical_positional_encoder</strong> (<em>bool</em><em>, </em><em>optional</em>) – Flag to use classical positional encoding or using embedding layer also for the positions. Defaults to False.</p></li>
<li><p><strong>emb_dim</strong> (<em>int</em><em>, </em><em>optional</em>) – Dimension of categorical embeddings. Defaults to 16.</p></li>
<li><p><strong>optim</strong> (<em>Union</em><em>[</em><em>str</em><em>, </em><em>None</em><em>]</em><em>, </em><em>optional</em>) – Optimizer type. Defaults to None.</p></li>
<li><p><strong>optim_config</strong> (<em>dict</em><em>, </em><em>optional</em>) – Configuration for the optimizer. Defaults to None.</p></li>
<li><p><strong>scheduler_config</strong> (<em>dict</em><em>, </em><em>optional</em>) – Configuration for the learning rate scheduler. Defaults to None.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>AssertionError</strong> – If the number of quantiles is not equal to 3 when quantiles are provided.</p></li>
<li><p><strong>AssertionError</strong> – If the number of output channels is not 1 for classification tasks.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="dsipts.Base.description">
<span class="sig-name descname"><span class="pre">description</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'Can</span> <span class="pre">NOT</span>&#160; <span class="pre">handle</span> <span class="pre">multivariate</span> <span class="pre">output</span> <span class="pre">\nCan</span> <span class="pre">NOT</span>&#160; <span class="pre">handle</span> <span class="pre">future</span> <span class="pre">covariates\nCan</span> <span class="pre">NOT</span>&#160; <span class="pre">handle</span> <span class="pre">categorical</span> <span class="pre">covariates\nCan</span> <span class="pre">NOT</span>&#160; <span class="pre">handle</span> <span class="pre">Quantile</span> <span class="pre">loss</span> <span class="pre">function'</span></em><a class="headerlink" href="#dsipts.Base.description" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dsipts.Base.forward">
<em class="property"><span class="k"><span class="pre">abstractmethod</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tensor</span></span></span><a class="headerlink" href="#dsipts.Base.forward" title="Link to this definition">¶</a></dt>
<dd><p>Forlward method used during the training loop</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>batch</strong> (<em>dict</em>) – the batch structure. The keys are:
y : the target variable(s). This is always present
x_num_past: the numerical past variables. This is always present
x_num_future: the numerical future variables
x_cat_past: the categorical past variables
x_cat_future: the categorical future variables
idx_target: index of target features in the past array</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>output of the mode;</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dsipts.Base.handle_categorical_variables">
<span class="sig-name descname"><span class="pre">handle_categorical_variables</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#dsipts.Base.handle_categorical_variables" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dsipts.Base.handle_future_covariates">
<span class="sig-name descname"><span class="pre">handle_future_covariates</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#dsipts.Base.handle_future_covariates" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dsipts.Base.handle_multivariate">
<span class="sig-name descname"><span class="pre">handle_multivariate</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#dsipts.Base.handle_multivariate" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dsipts.Base.handle_quantile_loss">
<span class="sig-name descname"><span class="pre">handle_quantile_loss</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#dsipts.Base.handle_quantile_loss" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dsipts.Base.inference">
<span class="sig-name descname"><span class="pre">inference</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tensor</span></span></span><a class="headerlink" href="#dsipts.Base.inference" title="Link to this definition">¶</a></dt>
<dd><p>Usually it is ok to return the output of the forward method but sometimes not (e.g. RNN)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>batch</strong> (<em>dict</em>) – batch</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>result</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.tensor</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dsipts.Categorical">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dsipts.</span></span><span class="sig-name descname"><span class="pre">Categorical</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frequency</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">duration</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">classes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">action</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ActionEnum</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">level</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dsipts.Categorical" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class for generating toy categorical data</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<em>str</em>) – name of the categorical signal</p></li>
<li><p><strong>frequency</strong> (<em>int</em>) – frequency of the signal</p></li>
<li><p><strong>duration</strong> (<em>List</em><em>[</em><em>int</em><em>]</em>) – duration of each class</p></li>
<li><p><strong>classes</strong> (<em>int</em>) – number of classes</p></li>
<li><p><strong>action</strong> (<em>str</em>) – one between additive or multiplicative</p></li>
<li><p><strong>level</strong> (<em>List</em><em>[</em><em>float</em><em>]</em>) – intensity of each class</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="dsipts.Categorical.generate_signal">
<span class="sig-name descname"><span class="pre">generate_signal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">length</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#dsipts.Categorical.generate_signal" title="Link to this definition">¶</a></dt>
<dd><p>Generate the resposne signal</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>length</strong> (<em>int</em>) – length of the signal</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dsipts.Categorical.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#dsipts.Categorical.plot" title="Link to this definition">¶</a></dt>
<dd><p>Plot the series</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dsipts.CrossFormer">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dsipts.</span></span><span class="sig-name descname"><span class="pre">CrossFormer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">https://openreview.net/forum?id=vSVLM2j9eie</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dsipts.CrossFormer" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="dsipts.models.html#dsipts.models.base_v2.Base" title="dsipts.models.base_v2.Base"><code class="xref py py-class docutils literal notranslate"><span class="pre">Base</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>d_model</strong> (<em>int</em>) – The dimensionality of the model.</p></li>
<li><p><strong>hidden_size</strong> (<em>int</em>) – The size of the hidden layers.</p></li>
<li><p><strong>n_head</strong> (<em>int</em>) – The number of attention heads.</p></li>
<li><p><strong>seg_len</strong> (<em>int</em>) – The length of the segments.</p></li>
<li><p><strong>n_layer_encoder</strong> (<em>int</em>) – The number of layers in the encoder.</p></li>
<li><p><strong>win_size</strong> (<em>int</em>) – The size of the window for attention.</p></li>
<li><p><strong>factor</strong> (<em>int</em><em>, </em><em>optional</em>) – see .crossformer.attn.TwoStageAttentionLayer. Defaults to 10.</p></li>
<li><p><strong>dropout_rate</strong> (<em>float</em><em>, </em><em>optional</em>) – The dropout rate. Defaults to 0.1.</p></li>
<li><p><strong>activation</strong> (<em>str</em><em>, </em><em>optional</em>) – The activation function to use. Defaults to ‘torch.nn.ReLU’.</p></li>
<li><p><strong>**kwargs</strong> – Additional keyword arguments for the parent class.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>This method does not return a value.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If the activation function is not recognized.</p>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="dsipts.CrossFormer.description">
<span class="sig-name descname"><span class="pre">description</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'Can</span>&#160;&#160; <span class="pre">handle</span> <span class="pre">multivariate</span> <span class="pre">output</span> <span class="pre">\nCan</span>&#160;&#160; <span class="pre">handle</span> <span class="pre">future</span> <span class="pre">covariates\nCan</span>&#160;&#160; <span class="pre">handle</span> <span class="pre">categorical</span> <span class="pre">covariates\nCan</span>&#160;&#160; <span class="pre">handle</span> <span class="pre">Quantile</span> <span class="pre">loss</span> <span class="pre">function'</span></em><a class="headerlink" href="#dsipts.CrossFormer.description" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dsipts.CrossFormer.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dsipts.CrossFormer.forward" title="Link to this definition">¶</a></dt>
<dd><p>Forlward method used during the training loop</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>batch</strong> (<em>dict</em>) – the batch structure. The keys are:
y : the target variable(s). This is always present
x_num_past: the numerical past variables. This is always present
x_num_future: the numerical future variables
x_cat_past: the categorical past variables
x_cat_future: the categorical future variables
idx_target: index of target features in the past array</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>output of the mode;</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dsipts.CrossFormer.handle_categorical_variables">
<span class="sig-name descname"><span class="pre">handle_categorical_variables</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#dsipts.CrossFormer.handle_categorical_variables" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dsipts.CrossFormer.handle_future_covariates">
<span class="sig-name descname"><span class="pre">handle_future_covariates</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#dsipts.CrossFormer.handle_future_covariates" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dsipts.CrossFormer.handle_multivariate">
<span class="sig-name descname"><span class="pre">handle_multivariate</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#dsipts.CrossFormer.handle_multivariate" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dsipts.CrossFormer.handle_quantile_loss">
<span class="sig-name descname"><span class="pre">handle_quantile_loss</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#dsipts.CrossFormer.handle_quantile_loss" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dsipts.D3VAE">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dsipts.</span></span><span class="sig-name descname"><span class="pre">D3VAE</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hidden_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_layers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diff_steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'kl'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta_end</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta_schedule</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'linear'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">channel_mult</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mult</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_preprocess_blocks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_preprocess_cells</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_channels_enc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">16</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">arch_instance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'res_mbconv'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_latent_per_group</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_channels_dec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">16</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">groups_per_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_postprocess_blocks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_postprocess_cells</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta_start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">freq</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'h'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dsipts.D3VAE" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="dsipts.models.html#dsipts.models.base_v2.Base" title="dsipts.models.base_v2.Base"><code class="xref py py-class docutils literal notranslate"><span class="pre">Base</span></code></a></p>
<p>This is the basic model, each model implemented must overwrite the init method and the forward method.
The inference step is optional, by default it uses the forward method but for recurrent
network you should implement your own method</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>verbose</strong> (<em>bool</em>) – Flag to enable verbose logging.</p></li>
<li><p><strong>past_steps</strong> (<em>int</em>) – Number of past time steps to consider.</p></li>
<li><p><strong>future_steps</strong> (<em>int</em>) – Number of future time steps to predict.</p></li>
<li><p><strong>past_channels</strong> (<em>int</em>) – Number of channels in the past input data.</p></li>
<li><p><strong>future_channels</strong> (<em>int</em>) – Number of channels in the future input data.</p></li>
<li><p><strong>out_channels</strong> (<em>int</em>) – Number of output channels.</p></li>
<li><p><strong>embs_past</strong> (<em>List</em><em>[</em><em>int</em><em>]</em>) – List of embedding dimensions for past data.</p></li>
<li><p><strong>embs_fut</strong> (<em>List</em><em>[</em><em>int</em><em>]</em>) – List of embedding dimensions for future data.</p></li>
<li><p><strong>n_classes</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of classes for classification. Defaults to 0.</p></li>
<li><p><strong>persistence_weight</strong> (<em>float</em><em>, </em><em>optional</em>) – Weight for persistence in loss calculation. Defaults to 0.0.</p></li>
<li><p><strong>loss_type</strong> (<em>str</em><em>, </em><em>optional</em>) – Type of loss function to use (‘l1’ or ‘mse’). Defaults to ‘l1’.</p></li>
<li><p><strong>quantiles</strong> (<em>List</em><em>[</em><em>int</em><em>]</em><em>, </em><em>optional</em>) – List of quantiles for quantile loss. Defaults to an empty list.</p></li>
<li><p><strong>reduction_mode</strong> (<em>str</em><em>, </em><em>optional</em>) – Mode for reduction for categorical embedding layer (‘mean’, ‘sum’, ‘none’). Defaults to ‘mean’.</p></li>
<li><p><strong>use_classical_positional_encoder</strong> (<em>bool</em><em>, </em><em>optional</em>) – Flag to use classical positional encoding or using embedding layer also for the positions. Defaults to False.</p></li>
<li><p><strong>emb_dim</strong> (<em>int</em><em>, </em><em>optional</em>) – Dimension of categorical embeddings. Defaults to 16.</p></li>
<li><p><strong>optim</strong> (<em>Union</em><em>[</em><em>str</em><em>, </em><em>None</em><em>]</em><em>, </em><em>optional</em>) – Optimizer type. Defaults to None.</p></li>
<li><p><strong>optim_config</strong> (<em>dict</em><em>, </em><em>optional</em>) – Configuration for the optimizer. Defaults to None.</p></li>
<li><p><strong>scheduler_config</strong> (<em>dict</em><em>, </em><em>optional</em>) – Configuration for the learning rate scheduler. Defaults to None.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>AssertionError</strong> – If the number of quantiles is not equal to 3 when quantiles are provided.</p></li>
<li><p><strong>AssertionError</strong> – If the number of output channels is not 1 for classification tasks.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="dsipts.D3VAE.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tensor</span></span></span><a class="headerlink" href="#dsipts.D3VAE.forward" title="Link to this definition">¶</a></dt>
<dd><p>Forlward method used during the training loop</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>batch</strong> (<em>dict</em>) – the batch structure. The keys are:
y : the target variable(s). This is always present
x_num_past: the numerical past variables. This is always present
x_num_future: the numerical future variables
x_cat_past: the categorical past variables
x_cat_future: the categorical future variables
idx_target: index of target features in the past array</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>output of the mode;</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dsipts.D3VAE.inference">
<span class="sig-name descname"><span class="pre">inference</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tensor</span></span></span><a class="headerlink" href="#dsipts.D3VAE.inference" title="Link to this definition">¶</a></dt>
<dd><p>Care here, we need to implement it because for predicting the N-step it will use the prediction at step N-1. TODO fix if because I did not implement the
know continuous variable presence here</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>batch</strong> (<em>dict</em>) – batch of the dataloader</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>result</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.tensor</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dsipts.Diffusion">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dsipts.</span></span><span class="sig-name descname"><span class="pre">Diffusion</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_channels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">past_steps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">future_steps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">past_channels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">future_channels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">embs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">learn_var</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cosine_alpha</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diffusion_steps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_layers_RNN</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d_head</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_head</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout_rate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">activation</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subnet</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">perc_subnet_learning_for_step</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">persistence_weight</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'l1'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quantiles</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optim_config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scheduler_config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dsipts.Diffusion" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="dsipts.models.html#dsipts.models.base_v2.Base" title="dsipts.models.base_v2.Base"><code class="xref py py-class docutils literal notranslate"><span class="pre">Base</span></code></a></p>
<p>Denoising Diffusion Probabilistic Model</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>d_model</strong> (<em>int</em>)</p></li>
<li><p><strong>out_channels</strong> (<em>int</em>) – number of target variables</p></li>
<li><p><strong>past_steps</strong> (<em>int</em>) – size of past window</p></li>
<li><p><strong>future_steps</strong> (<em>int</em>) – size of future window to be predicted</p></li>
<li><p><strong>past_channels</strong> (<em>int</em>) – number of variables available for the past context</p></li>
<li><p><strong>future_channels</strong> (<em>int</em>) – number of variables known in the future, available for forecasting</p></li>
<li><p><strong>embs</strong> (<em>list</em><em>[</em><em>int</em><em>]</em>) – categorical variables dimensions for embeddings</p></li>
<li><p><strong>learn_var</strong> (<em>bool</em>) – Flag to make the model train the posterior variance (if True) or use the variance of posterior distribution</p></li>
<li><p><strong>cosine_alpha</strong> (<em>bool</em>) – Flag for the generation of alphas and betas</p></li>
<li><p><strong>diffusion_steps</strong> (<em>int</em>) – number of noising steps for the initial sample</p></li>
<li><p><strong>beta</strong> (<em>float</em>) – starting variable to generate the diffusion perturbations. Ignored if cosine_alpha == True</p></li>
<li><p><strong>gamma</strong> (<em>float</em>) – trade_off variable to balance loss over noise prediction and NegativeLikelihood/KL_Divergence.</p></li>
<li><p><strong>n_layers_RNN</strong> (<em>int</em>) – param for subnet</p></li>
<li><p><strong>d_head</strong> (<em>int</em>) – param for subnet</p></li>
<li><p><strong>n_head</strong> (<em>int</em>) – param for subnet</p></li>
<li><p><strong>dropout_rate</strong> (<em>float</em>) – param for subnet</p></li>
<li><p><strong>activation</strong> (<em>str</em>) – param for subnet</p></li>
<li><p><strong>subnet</strong> (<em>int</em>) – =1 for attention subnet, =2 for linear subnet. Others can be added(wait for Black Friday for discounts)</p></li>
<li><p><strong>perc_subnet_learning_for_step</strong> (<em>float</em>) – percentage to choose how many subnet has to be trained for every batch. Decrease this value if the loss blows up.</p></li>
<li><p><strong>persistence_weight</strong> (<em>float</em><em>, </em><em>optional</em>) – Defaults to 0.0.</p></li>
<li><p><strong>loss_type</strong> (<em>str</em><em>, </em><em>optional</em>) – Defaults to ‘l1’.</p></li>
<li><p><strong>quantiles</strong> (<em>List</em><em>[</em><em>float</em><em>]</em><em>, </em><em>optional</em>) – Only [] accepted. Defaults to [].</p></li>
<li><p><strong>optim</strong> (<em>Union</em><em>[</em><em>str</em><em>,</em><em>None</em><em>]</em><em>, </em><em>optional</em>) – Defaults to None.</p></li>
<li><p><strong>optim_config</strong> (<em>Union</em><em>[</em><em>dict</em><em>,</em><em>None</em><em>]</em><em>, </em><em>optional</em>) – Defaults to None.</p></li>
<li><p><strong>scheduler_config</strong> (<em>Union</em><em>[</em><em>dict</em><em>,</em><em>None</em><em>]</em><em>, </em><em>optional</em>) – Defaults to None.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="dsipts.Diffusion.cat_categorical_vars">
<span class="sig-name descname"><span class="pre">cat_categorical_vars</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dsipts.Diffusion.cat_categorical_vars" title="Link to this definition">¶</a></dt>
<dd><p>Extracting categorical context about past and future</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>batch</strong> (<em>dict</em>) – Keys checked -&gt; [‘x_cat_past’, ‘x_cat_future’]</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>cat_emb_past, cat_emb_fut</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[torch.Tensor, torch.Tensor]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dsipts.Diffusion.description">
<span class="sig-name descname"><span class="pre">description</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'Can</span> <span class="pre">NOT</span>&#160; <span class="pre">handle</span> <span class="pre">multivariate</span> <span class="pre">output</span> <span class="pre">\nCan</span>&#160;&#160; <span class="pre">handle</span> <span class="pre">future</span> <span class="pre">covariates\nCan</span>&#160;&#160; <span class="pre">handle</span> <span class="pre">categorical</span> <span class="pre">covariates\nCan</span> <span class="pre">NOT</span>&#160; <span class="pre">handle</span> <span class="pre">Quantile</span> <span class="pre">loss</span> <span class="pre">function'</span></em><a class="headerlink" href="#dsipts.Diffusion.description" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dsipts.Diffusion.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="headerlink" href="#dsipts.Diffusion.forward" title="Link to this definition">¶</a></dt>
<dd><p>training process of the diffusion network</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>batch</strong> (<em>dict</em>) – variables loaded</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>total loss about the prediction of the noises over all subnets extracted</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dsipts.Diffusion.gaussian_likelihood">
<span class="sig-name descname"><span class="pre">gaussian_likelihood</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mean</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dsipts.Diffusion.gaussian_likelihood" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dsipts.Diffusion.gaussian_log_likelihood">
<span class="sig-name descname"><span class="pre">gaussian_log_likelihood</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mean</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dsipts.Diffusion.gaussian_log_likelihood" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dsipts.Diffusion.handle_categorical_variables">
<span class="sig-name descname"><span class="pre">handle_categorical_variables</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#dsipts.Diffusion.handle_categorical_variables" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dsipts.Diffusion.handle_future_covariates">
<span class="sig-name descname"><span class="pre">handle_future_covariates</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#dsipts.Diffusion.handle_future_covariates" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dsipts.Diffusion.handle_multivariate">
<span class="sig-name descname"><span class="pre">handle_multivariate</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#dsipts.Diffusion.handle_multivariate" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dsipts.Diffusion.handle_quantile_loss">
<span class="sig-name descname"><span class="pre">handle_quantile_loss</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#dsipts.Diffusion.handle_quantile_loss" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dsipts.Diffusion.improving_weight_during_training">
<span class="sig-name descname"><span class="pre">improving_weight_during_training</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#dsipts.Diffusion.improving_weight_during_training" title="Link to this definition">¶</a></dt>
<dd><p>Each time we sample from multinomial we subtract the minimum for more precise sampling,
avoiding great learning differences among subnets</p>
<p>This lead to more stable inference also in early training, mainly for common context embedding.</p>
<p>For probabilistic reason, weights has to be &gt;0, so we subtract min-1</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dsipts.Diffusion.inference">
<span class="sig-name descname"><span class="pre">inference</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="headerlink" href="#dsipts.Diffusion.inference" title="Link to this definition">¶</a></dt>
<dd><p>Inference process to forecast future y</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>batch</strong> (<em>dict</em>) – Keys checked [‘x_num_past, ‘idx_target’, ‘x_num_future’, ‘x_cat_past’, ‘x_cat_future’]</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>generated sequence [batch_size, future_steps, num_var]</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dsipts.Diffusion.normal_kl">
<span class="sig-name descname"><span class="pre">normal_kl</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mean1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logvar1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mean2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logvar2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dsipts.Diffusion.normal_kl" title="Link to this definition">¶</a></dt>
<dd><p>Compute the KL divergence between two gaussians. Also called relative entropy.
KL divergence of P from Q is the expected excess surprise from using Q as a model when the actual distribution is P.
KL(P||Q) = P*log(P/Q) or -P*log(Q/P)</p>
<p># In the context of machine learning, KL(P||Q) is often called the ‘information gain’
# achieved if P would be used instead of Q which is currently used.</p>
<p>Shapes are automatically broadcasted, so batches can be compared to
scalars, among other use cases.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dsipts.Diffusion.q_sample">
<span class="sig-name descname"><span class="pre">q_sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_start</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#dsipts.Diffusion.q_sample" title="Link to this definition">¶</a></dt>
<dd><p>Diffuse x_start for t diffusion steps.</p>
<p>In other words, sample from q(x_t | x_0).</p>
<p>Also, compute the mean and variance of the diffusion posterior:</p>
<blockquote>
<div><p>q(x_{t-1} | x_t, x_0)</p>
</div></blockquote>
<p>Posterior mean and variance are the ones to be predicted</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x_start</strong> (<em>torch.Tensor</em>) – values to be predicted</p></li>
<li><p><strong>t</strong> (<em>int</em>) – diffusion step</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>q_sample, posterior mean, posterior log variance and the actual noise</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[torch.Tensor, torch.Tensor, torch.Tensor]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dsipts.Diffusion.remove_var">
<span class="sig-name descname"><span class="pre">remove_var</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tensor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indexes_to_exclude</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dimension</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="headerlink" href="#dsipts.Diffusion.remove_var" title="Link to this definition">¶</a></dt>
<dd><p>Function to remove variables from tensors in chosen dimension and position</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tensor</strong> (<em>torch.Tensor</em>) – starting tensor</p></li>
<li><p><strong>indexes_to_exclude</strong> (<em>list</em>) – index of the chosen dimension we want t oexclude</p></li>
<li><p><strong>dimension</strong> (<em>int</em>) – dimension of the tensor on which we want to work (not list od dims!!)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>new tensor without the chosen variables</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dsipts.DilatedConv">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dsipts.</span></span><span class="sig-name descname"><span class="pre">DilatedConv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sum_layers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hidden_RNN</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_layers_RNN</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kind</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">activation</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'torch.nn.ReLU'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_last</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout_rate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_bn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_glu</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">glu_percentage</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dsipts.DilatedConv" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="dsipts.models.html#dsipts.models.base_v2.Base" title="dsipts.models.base_v2.Base"><code class="xref py py-class docutils literal notranslate"><span class="pre">Base</span></code></a></p>
<p>Custom encoder-decoder</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sum_layers</strong> (<em>bool</em>) – Flag indicating whether to sum the layers.</p></li>
<li><p><strong>hidden_RNN</strong> (<em>int</em>) – Number of hidden units in the RNN.</p></li>
<li><p><strong>num_layers_RNN</strong> (<em>int</em>) – Number of layers in the RNN.</p></li>
<li><p><strong>kind</strong> (<em>str</em>) – Type of RNN to use (e.g., ‘LSTM’, ‘GRU’).</p></li>
<li><p><strong>kernel_size</strong> (<em>int</em>) – Size of the convolutional kernel.</p></li>
<li><p><strong>activation</strong> (<em>str</em><em>, </em><em>optional</em>) – Activation function to use. Defaults to ‘torch.nn.ReLU’.</p></li>
<li><p><strong>remove_last</strong> (<em>bool</em><em>, </em><em>optional</em>) – Flag to indicate whether to remove the last element in the sequence. Defaults to False.</p></li>
<li><p><strong>dropout_rate</strong> (<em>float</em><em>, </em><em>optional</em>) – Dropout rate for regularization. Defaults to 0.1.</p></li>
<li><p><strong>use_bn</strong> (<em>bool</em><em>, </em><em>optional</em>) – Flag to indicate whether to use batch normalization. Defaults to False.</p></li>
<li><p><strong>use_glu</strong> (<em>bool</em><em>, </em><em>optional</em>) – Flag to indicate whether to use Gated Linear Units (GLU). Defaults to True.</p></li>
<li><p><strong>glu_percentage</strong> (<em>float</em><em>, </em><em>optional</em>) – Percentage of GLU to apply. Defaults to 1.0.</p></li>
<li><p><strong>**kwargs</strong> – Additional keyword arguments.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="dsipts.DilatedConv.description">
<span class="sig-name descname"><span class="pre">description</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'Can</span>&#160;&#160; <span class="pre">handle</span> <span class="pre">multivariate</span> <span class="pre">output</span> <span class="pre">\nCan</span>&#160;&#160; <span class="pre">handle</span> <span class="pre">future</span> <span class="pre">covariates\nCan</span>&#160;&#160; <span class="pre">handle</span> <span class="pre">categorical</span> <span class="pre">covariates\nCan</span>&#160;&#160; <span class="pre">handle</span> <span class="pre">Quantile</span> <span class="pre">loss</span> <span class="pre">function'</span></em><a class="headerlink" href="#dsipts.DilatedConv.description" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dsipts.DilatedConv.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dsipts.DilatedConv.forward" title="Link to this definition">¶</a></dt>
<dd><p>It is mandatory to implement this method</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>batch</strong> (<em>dict</em>) – batch of the dataloader</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>result</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dsipts.DilatedConv.handle_categorical_variables">
<span class="sig-name descname"><span class="pre">handle_categorical_variables</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#dsipts.DilatedConv.handle_categorical_variables" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dsipts.DilatedConv.handle_future_covariates">
<span class="sig-name descname"><span class="pre">handle_future_covariates</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#dsipts.DilatedConv.handle_future_covariates" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dsipts.DilatedConv.handle_multivariate">
<span class="sig-name descname"><span class="pre">handle_multivariate</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#dsipts.DilatedConv.handle_multivariate" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dsipts.DilatedConv.handle_quantile_loss">
<span class="sig-name descname"><span class="pre">handle_quantile_loss</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#dsipts.DilatedConv.handle_quantile_loss" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dsipts.DilatedConv.inference">
<span class="sig-name descname"><span class="pre">inference</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tensor</span></span></span><a class="headerlink" href="#dsipts.DilatedConv.inference" title="Link to this definition">¶</a></dt>
<dd><p>Usually it is ok to return the output of the forward method but sometimes not (e.g. RNN)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>batch</strong> (<em>dict</em>) – batch</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>result</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.tensor</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dsipts.DilatedConvED">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dsipts.</span></span><span class="sig-name descname"><span class="pre">DilatedConvED</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sum_layers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hidden_RNN</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_layers_RNN</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kind</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout_rate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_bn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_cumsum</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_bilinear</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">activation</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'torch.nn.ReLU'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dsipts.DilatedConvED" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="dsipts.models.html#dsipts.models.base_v2.Base" title="dsipts.models.base_v2.Base"><code class="xref py py-class docutils literal notranslate"><span class="pre">Base</span></code></a></p>
<p>Initialize the model with specified parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sum_layers</strong> (<em>bool</em>) – Flag indicating whether to sum layers in the encoder/decoder blocks.</p></li>
<li><p><strong>hidden_RNN</strong> (<em>int</em>) – Number of hidden units in the RNN.</p></li>
<li><p><strong>num_layers_RNN</strong> (<em>int</em>) – Number of layers in the RNN.</p></li>
<li><p><strong>kind</strong> (<em>str</em>) – Type of RNN to use (‘lstm’ or ‘gru’).</p></li>
<li><p><strong>kernel_size</strong> (<em>int</em>) – Size of the convolutional kernel.</p></li>
<li><p><strong>dropout_rate</strong> (<em>float</em><em>, </em><em>optional</em>) – Dropout rate for regularization. Defaults to 0.1.</p></li>
<li><p><strong>use_bn</strong> (<em>bool</em><em>, </em><em>optional</em>) – Flag to use batch normalization. Defaults to False.</p></li>
<li><p><strong>use_cumsum</strong> (<em>bool</em><em>, </em><em>optional</em>) – Flag to use cumulative sum. Defaults to True.</p></li>
<li><p><strong>use_bilinear</strong> (<em>bool</em><em>, </em><em>optional</em>) – Flag to use bilinear layers. Defaults to False.</p></li>
<li><p><strong>activation</strong> (<em>str</em><em>, </em><em>optional</em>) – Activation function to use. Defaults to ‘torch.nn.ReLU’.</p></li>
<li><p><strong>**kwargs</strong> – Additional keyword arguments.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If the specified activation function is not recognized or if the kind is not ‘lstm’ or ‘gru’.</p>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="dsipts.DilatedConvED.description">
<span class="sig-name descname"><span class="pre">description</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'Can</span>&#160;&#160; <span class="pre">handle</span> <span class="pre">multivariate</span> <span class="pre">output</span> <span class="pre">\nCan</span>&#160;&#160; <span class="pre">handle</span> <span class="pre">future</span> <span class="pre">covariates\nCan</span>&#160;&#160; <span class="pre">handle</span> <span class="pre">categorical</span> <span class="pre">covariates\nCan</span>&#160;&#160; <span class="pre">handle</span> <span class="pre">Quantile</span> <span class="pre">loss</span> <span class="pre">function'</span></em><a class="headerlink" href="#dsipts.DilatedConvED.description" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dsipts.DilatedConvED.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dsipts.DilatedConvED.forward" title="Link to this definition">¶</a></dt>
<dd><p>It is mandatory to implement this method</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>batch</strong> (<em>dict</em>) – batch of the dataloader</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>result</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dsipts.DilatedConvED.handle_categorical_variables">
<span class="sig-name descname"><span class="pre">handle_categorical_variables</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#dsipts.DilatedConvED.handle_categorical_variables" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dsipts.DilatedConvED.handle_future_covariates">
<span class="sig-name descname"><span class="pre">handle_future_covariates</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#dsipts.DilatedConvED.handle_future_covariates" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dsipts.DilatedConvED.handle_multivariate">
<span class="sig-name descname"><span class="pre">handle_multivariate</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#dsipts.DilatedConvED.handle_multivariate" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dsipts.DilatedConvED.handle_quantile_loss">
<span class="sig-name descname"><span class="pre">handle_quantile_loss</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#dsipts.DilatedConvED.handle_quantile_loss" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dsipts.Duet">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dsipts.</span></span><span class="sig-name descname"><span class="pre">Duet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">factor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_head</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_layer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">CI</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d_ff</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noisy_gating</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_experts</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hidden_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout_rate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">activation</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dsipts.Duet" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="dsipts.models.html#dsipts.models.base_v2.Base" title="dsipts.models.base_v2.Base"><code class="xref py py-class docutils literal notranslate"><span class="pre">Base</span></code></a></p>
<p>Initializes the model with the specified parameters. <a class="reference external" href="https://github.com/decisionintelligence/DUET">https://github.com/decisionintelligence/DUET</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>factor</strong> (<em>int</em>) – The factor for attention scaling. NOT USED but in the original implementation</p></li>
<li><p><strong>d_model</strong> (<em>int</em>) – The dimensionality of the model.</p></li>
<li><p><strong>n_head</strong> (<em>int</em>) – The number of attention heads.</p></li>
<li><p><strong>n_layer</strong> (<em>int</em>) – The number of layers in the encoder.</p></li>
<li><p><strong>CI</strong> (<em>bool</em>) – Perform channel independent operations.</p></li>
<li><p><strong>d_ff</strong> (<em>int</em>) – The dimensionality of the feedforward layer.</p></li>
<li><p><strong>noisy_gating</strong> (<em>bool</em>) – Flag to indicate if noisy gating is used.</p></li>
<li><p><strong>num_experts</strong> (<em>int</em>) – The number of experts in the mixture of experts.</p></li>
<li><p><strong>kernel_size</strong> (<em>int</em>) – The size of the convolutional kernel.</p></li>
<li><p><strong>hidden_size</strong> (<em>int</em>) – The size of the hidden layer.</p></li>
<li><p><strong>k</strong> (<em>int</em>) – The number of clusters for the linear extractor.</p></li>
<li><p><strong>dropout_rate</strong> (<em>float</em><em>, </em><em>optional</em>) – The dropout rate. Defaults to 0.1.</p></li>
<li><p><strong>activation</strong> (<em>str</em><em>, </em><em>optional</em>) – The activation function to use. Defaults to ‘’.</p></li>
<li><p><strong>**kwargs</strong> – Additional keyword arguments.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If the activation function is not recognized.</p>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="dsipts.Duet.description">
<span class="sig-name descname"><span class="pre">description</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'Can</span>&#160;&#160; <span class="pre">handle</span> <span class="pre">multivariate</span> <span class="pre">output</span> <span class="pre">\nCan</span>&#160;&#160; <span class="pre">handle</span> <span class="pre">future</span> <span class="pre">covariates\nCan</span>&#160;&#160; <span class="pre">handle</span> <span class="pre">categorical</span> <span class="pre">covariates\nCan</span>&#160;&#160; <span class="pre">handle</span> <span class="pre">Quantile</span> <span class="pre">loss</span> <span class="pre">function'</span></em><a class="headerlink" href="#dsipts.Duet.description" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dsipts.Duet.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="headerlink" href="#dsipts.Duet.forward" title="Link to this definition">¶</a></dt>
<dd><p>Forlward method used during the training loop</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>batch</strong> (<em>dict</em>) – the batch structure. The keys are:
y : the target variable(s). This is always present
x_num_past: the numerical past variables. This is always present
x_num_future: the numerical future variables
x_cat_past: the categorical past variables
x_cat_future: the categorical future variables
idx_target: index of target features in the past array</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>output of the mode;</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dsipts.Duet.handle_categorical_variables">
<span class="sig-name descname"><span class="pre">handle_categorical_variables</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#dsipts.Duet.handle_categorical_variables" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dsipts.Duet.handle_future_covariates">
<span class="sig-name descname"><span class="pre">handle_future_covariates</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#dsipts.Duet.handle_future_covariates" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dsipts.Duet.handle_multivariate">
<span class="sig-name descname"><span class="pre">handle_multivariate</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#dsipts.Duet.handle_multivariate" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dsipts.Duet.handle_quantile_loss">
<span class="sig-name descname"><span class="pre">handle_quantile_loss</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#dsipts.Duet.handle_quantile_loss" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dsipts.ITransformer">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dsipts.</span></span><span class="sig-name descname"><span class="pre">ITransformer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hidden_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_head</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_layer_decoder</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_norm</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">class_strategy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'projection'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout_rate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">activation</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dsipts.ITransformer" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="dsipts.models.html#dsipts.models.base_v2.Base" title="dsipts.models.base_v2.Base"><code class="xref py py-class docutils literal notranslate"><span class="pre">Base</span></code></a></p>
<p>Initialize the ITransformer model for time series forecasting.</p>
<p>This class implements the Inverted Transformer architecture as described in the paper
“ITRANSFORMER: INVERTED TRANSFORMERS ARE EFFECTIVE FOR TIME SERIES FORECASTING”
(<a class="reference external" href="https://arxiv.org/pdf/2310.06625">https://arxiv.org/pdf/2310.06625</a>).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hidden_size</strong> (<em>int</em>) – The first embedding size of the model (‘r’ in the paper).</p></li>
<li><p><strong>d_model</strong> (<em>int</em>) – The second embedding size (r^{tilda} in the model). Should be smaller than hidden_size.</p></li>
<li><p><strong>n_head</strong> (<em>int</em>) – The number of attention heads.</p></li>
<li><p><strong>n_layer_decoder</strong> (<em>int</em>) – The number of layers in the decoder.</p></li>
<li><p><strong>use_norm</strong> (<em>bool</em>) – Flag to indicate whether to use normalization.</p></li>
<li><p><strong>class_strategy</strong> (<em>str</em><em>, </em><em>optional</em>) – The strategy for classification, can be ‘projection’, ‘average’, or ‘cls_token’. Defaults to ‘projection’.</p></li>
<li><p><strong>dropout_rate</strong> (<em>float</em><em>, </em><em>optional</em>) – The dropout rate for regularization. Defaults to 0.1.</p></li>
<li><p><strong>activation</strong> (<em>str</em><em>, </em><em>optional</em>) – The activation function to be used. Defaults to ‘’.</p></li>
<li><p><strong>**kwargs</strong> – Additional keyword arguments.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If the activation function is not recognized.</p>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="dsipts.ITransformer.description">
<span class="sig-name descname"><span class="pre">description</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'Can</span>&#160;&#160; <span class="pre">handle</span> <span class="pre">multivariate</span> <span class="pre">output</span> <span class="pre">\nCan</span>&#160;&#160; <span class="pre">handle</span> <span class="pre">future</span> <span class="pre">covariates\nCan</span>&#160;&#160; <span class="pre">handle</span> <span class="pre">categorical</span> <span class="pre">covariates\nCan</span>&#160;&#160; <span class="pre">handle</span> <span class="pre">Quantile</span> <span class="pre">loss</span> <span class="pre">function'</span></em><a class="headerlink" href="#dsipts.ITransformer.description" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dsipts.ITransformer.forecast">
<span class="sig-name descname"><span class="pre">forecast</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_enc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_mark_enc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_dec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_mark_dec</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dsipts.ITransformer.forecast" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dsipts.ITransformer.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="headerlink" href="#dsipts.ITransformer.forward" title="Link to this definition">¶</a></dt>
<dd><p>Forlward method used during the training loop</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>batch</strong> (<em>dict</em>) – the batch structure. The keys are:
y : the target variable(s). This is always present
x_num_past: the numerical past variables. This is always present
x_num_future: the numerical future variables
x_cat_past: the categorical past variables
x_cat_future: the categorical future variables
idx_target: index of target features in the past array</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>output of the mode;</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dsipts.ITransformer.handle_categorical_variables">
<span class="sig-name descname"><span class="pre">handle_categorical_variables</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#dsipts.ITransformer.handle_categorical_variables" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dsipts.ITransformer.handle_future_covariates">
<span class="sig-name descname"><span class="pre">handle_future_covariates</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#dsipts.ITransformer.handle_future_covariates" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dsipts.ITransformer.handle_multivariate">
<span class="sig-name descname"><span class="pre">handle_multivariate</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#dsipts.ITransformer.handle_multivariate" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dsipts.ITransformer.handle_quantile_loss">
<span class="sig-name descname"><span class="pre">handle_quantile_loss</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#dsipts.ITransformer.handle_quantile_loss" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dsipts.Informer">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dsipts.</span></span><span class="sig-name descname"><span class="pre">Informer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hidden_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_layer_encoder</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_layer_decoder</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mix</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">activation</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'torch.nn.ReLU'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_last</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'prob'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distil</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">factor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_head</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout_rate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dsipts.Informer" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="dsipts.models.html#dsipts.models.base_v2.Base" title="dsipts.models.base_v2.Base"><code class="xref py py-class docutils literal notranslate"><span class="pre">Base</span></code></a></p>
<p>Initialize the model with specified parameters. hhttps://github.com/zhouhaoyi/Informer2020/tree/main/models</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>d_model</strong> (<em>int</em>) – The dimensionality of the model.</p></li>
<li><p><strong>hidden_size</strong> (<em>int</em>) – The size of the hidden layers.</p></li>
<li><p><strong>n_layer_encoder</strong> (<em>int</em>) – The number of layers in the encoder.</p></li>
<li><p><strong>n_layer_decoder</strong> (<em>int</em>) – The number of layers in the decoder.</p></li>
<li><p><strong>mix</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to use mixed attention. Defaults to True.</p></li>
<li><p><strong>activation</strong> (<em>str</em><em>, </em><em>optional</em>) – The activation function to use. Defaults to ‘torch.nn.ReLU’.</p></li>
<li><p><strong>remove_last</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to remove the last layer. Defaults to False.</p></li>
<li><p><strong>attn</strong> (<em>str</em><em>, </em><em>optional</em>) – The type of attention mechanism to use. Defaults to ‘prob’.</p></li>
<li><p><strong>distil</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to use distillation. Defaults to True.</p></li>
<li><p><strong>factor</strong> (<em>int</em><em>, </em><em>optional</em>) – The factor for attention. Defaults to 5.</p></li>
<li><p><strong>n_head</strong> (<em>int</em><em>, </em><em>optional</em>) – The number of attention heads. Defaults to 1.</p></li>
<li><p><strong>dropout_rate</strong> (<em>float</em><em>, </em><em>optional</em>) – The dropout rate. Defaults to 0.1.</p></li>
<li><p><strong>**kwargs</strong> – Additional keyword arguments.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If any of the parameters are invalid.</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Ensure to set up split_params: shift: ${model_configs.future_steps} as it is required!!</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="dsipts.Informer.description">
<span class="sig-name descname"><span class="pre">description</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'Can</span>&#160;&#160; <span class="pre">handle</span> <span class="pre">multivariate</span> <span class="pre">output</span> <span class="pre">\nCan</span>&#160;&#160; <span class="pre">handle</span> <span class="pre">future</span> <span class="pre">covariates\nCan</span>&#160;&#160; <span class="pre">handle</span> <span class="pre">categorical</span> <span class="pre">covariates\nCan</span>&#160;&#160; <span class="pre">handle</span> <span class="pre">Quantile</span> <span class="pre">loss</span> <span class="pre">function'</span></em><a class="headerlink" href="#dsipts.Informer.description" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dsipts.Informer.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dsipts.Informer.forward" title="Link to this definition">¶</a></dt>
<dd><p>Forlward method used during the training loop</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>batch</strong> (<em>dict</em>) – the batch structure. The keys are:
y : the target variable(s). This is always present
x_num_past: the numerical past variables. This is always present
x_num_future: the numerical future variables
x_cat_past: the categorical past variables
x_cat_future: the categorical future variables
idx_target: index of target features in the past array</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>output of the mode;</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dsipts.Informer.handle_categorical_variables">
<span class="sig-name descname"><span class="pre">handle_categorical_variables</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#dsipts.Informer.handle_categorical_variables" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dsipts.Informer.handle_future_covariates">
<span class="sig-name descname"><span class="pre">handle_future_covariates</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#dsipts.Informer.handle_future_covariates" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dsipts.Informer.handle_multivariate">
<span class="sig-name descname"><span class="pre">handle_multivariate</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#dsipts.Informer.handle_multivariate" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dsipts.Informer.handle_quantile_loss">
<span class="sig-name descname"><span class="pre">handle_quantile_loss</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#dsipts.Informer.handle_quantile_loss" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dsipts.LinearTS">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dsipts.</span></span><span class="sig-name descname"><span class="pre">LinearTS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kernel_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hidden_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout_rate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">activation</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'torch.nn.ReLU'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kind</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'linear'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_bn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">simple</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dsipts.LinearTS" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="dsipts.models.html#dsipts.models.base_v2.Base" title="dsipts.models.base_v2.Base"><code class="xref py py-class docutils literal notranslate"><span class="pre">Base</span></code></a></p>
<p>Initialize the model with specified parameters. Linear model from <a class="reference external" href="https://github.com/cure-lab/LTSF-Linear/blob/main/run_longExp.py">https://github.com/cure-lab/LTSF-Linear/blob/main/run_longExp.py</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>kernel_size</strong> (<em>int</em>) – Kernel dimension for the initial moving average.</p></li>
<li><p><strong>hidden_size</strong> (<em>int</em>) – Hidden size of the linear block.</p></li>
<li><p><strong>dropout_rate</strong> (<em>float</em><em>, </em><em>optional</em>) – Dropout rate in Dropout layers. Default is 0.1.</p></li>
<li><p><strong>activation</strong> (<em>str</em><em>, </em><em>optional</em>) – Activation function in PyTorch. Default is ‘torch.nn.ReLU’.</p></li>
<li><p><strong>kind</strong> (<em>str</em><em>, </em><em>optional</em>) – Type of model, can be ‘linear’, ‘dlinear’ (de-trending), or ‘nlinear’ (differential). Defaults to ‘linear’.</p></li>
<li><p><strong>use_bn</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, Batch Normalization layers will be added and Dropouts will be removed. Default is False.</p></li>
<li><p><strong>simple</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, the model used is the same as illustrated in the paper; otherwise, a more complex model with the same idea is used. Default is False.</p></li>
<li><p><strong>**kwargs</strong> – Additional keyword arguments for the parent class.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If an invalid activation function is provided.</p>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="dsipts.LinearTS.description">
<span class="sig-name descname"><span class="pre">description</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'Can</span>&#160;&#160; <span class="pre">handle</span> <span class="pre">multivariate</span> <span class="pre">output</span> <span class="pre">\nCan</span>&#160;&#160; <span class="pre">handle</span> <span class="pre">future</span> <span class="pre">covariates\nCan</span>&#160;&#160; <span class="pre">handle</span> <span class="pre">categorical</span> <span class="pre">covariates\nCan</span>&#160;&#160; <span class="pre">handle</span> <span class="pre">Quantile</span> <span class="pre">loss</span> <span class="pre">function\n</span> <span class="pre">THE</span> <span class="pre">SIMPLE</span> <span class="pre">IMPLEMENTATION</span> <span class="pre">DOES</span> <span class="pre">NOT</span> <span class="pre">USE</span> <span class="pre">CATEGORICAL</span> <span class="pre">NOR</span> <span class="pre">FUTURE</span> <span class="pre">VARIABLES'</span></em><a class="headerlink" href="#dsipts.LinearTS.description" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dsipts.LinearTS.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dsipts.LinearTS.forward" title="Link to this definition">¶</a></dt>
<dd><p>Forlward method used during the training loop</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>batch</strong> (<em>dict</em>) – the batch structure. The keys are:
y : the target variable(s). This is always present
x_num_past: the numerical past variables. This is always present
x_num_future: the numerical future variables
x_cat_past: the categorical past variables
x_cat_future: the categorical future variables
idx_target: index of target features in the past array</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>output of the mode;</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dsipts.LinearTS.handle_categorical_variables">
<span class="sig-name descname"><span class="pre">handle_categorical_variables</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#dsipts.LinearTS.handle_categorical_variables" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dsipts.LinearTS.handle_future_covariates">
<span class="sig-name descname"><span class="pre">handle_future_covariates</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#dsipts.LinearTS.handle_future_covariates" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dsipts.LinearTS.handle_multivariate">
<span class="sig-name descname"><span class="pre">handle_multivariate</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#dsipts.LinearTS.handle_multivariate" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dsipts.LinearTS.handle_quantile_loss">
<span class="sig-name descname"><span class="pre">handle_quantile_loss</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#dsipts.LinearTS.handle_quantile_loss" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dsipts.Monash">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dsipts.</span></span><span class="sig-name descname"><span class="pre">Monash</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">baseUrl</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'https://forecastingdata.org/'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rebuild</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dsipts.Monash" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class for downloading datasets listed here <a class="reference external" href="https://forecastingdata.org/">https://forecastingdata.org/</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<em>str</em>) – name of the class, used for saving</p></li>
<li><p><strong>baseUrl</strong> (<em>str</em><em>, </em><em>optional</em>) – url to the source page. Defaults to ‘<a class="reference external" href="https://forecastingdata.org/">https://forecastingdata.org/</a>’.</p></li>
<li><p><strong>rebuild</strong> (<em>bool</em><em>, </em><em>optional</em>) – if true the table will be loaded from the webpage otherwise it will be loaded from the saved file. Defaults to False.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="dsipts.Monash.download_dataset">
<span class="sig-name descname"><span class="pre">download_dataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rebuild</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#dsipts.Monash.download_dataset" title="Link to this definition">¶</a></dt>
<dd><p>download a specific dataset</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>path</strong> (<em>str</em>) – path in which save the data</p></li>
<li><p><strong>id</strong> (<em>int</em>) – id of the dataset</p></li>
<li><p><strong>rebuild</strong> (<em>bool</em><em>, </em><em>optional</em>) – if true the dataset will be re-downloaded. Defaults to False.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dsipts.Monash.generate_dataset">
<span class="sig-name descname"><span class="pre">generate_dataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">DataFrame</span></span></span><a class="headerlink" href="#dsipts.Monash.generate_dataset" title="Link to this definition">¶</a></dt>
<dd><p>Parse the id-th dataset in a convient format and return a pandas dataset</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>id</strong> (<em>int</em>) – id of the dataset</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>dataframe</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None or pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dsipts.Monash.load">
<span class="sig-name descname"><span class="pre">load</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#dsipts.Monash.load" title="Link to this definition">¶</a></dt>
<dd><p>Load a monarch structure</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>filename</strong> (<em>str</em>) – filename to load</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dsipts.Monash.save">
<span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#dsipts.Monash.save" title="Link to this definition">¶</a></dt>
<dd><p>Save the monarch structure</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>filename</strong> (<em>str</em>) – name of the file to generate</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dsipts.PatchTST">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dsipts.</span></span><span class="sig-name descname"><span class="pre">PatchTST</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patch_len</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decomposition</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">activation</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'torch.nn.ReLU'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_head</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_layer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_last</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hidden_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1048</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout_rate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dsipts.PatchTST" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="dsipts.models.html#dsipts.models.base_v2.Base" title="dsipts.models.base_v2.Base"><code class="xref py py-class docutils literal notranslate"><span class="pre">Base</span></code></a></p>
<p>Initializes the model with specified parameters.https://github.com/yuqinie98/PatchTST/blob/main/</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>d_model</strong> (<em>int</em>) – The dimensionality of the model.</p></li>
<li><p><strong>patch_len</strong> (<em>int</em>) – The length of the patches.</p></li>
<li><p><strong>kernel_size</strong> (<em>int</em>) – The size of the kernel for convolutional layers.</p></li>
<li><p><strong>decomposition</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to use decomposition. Defaults to True.</p></li>
<li><p><strong>activation</strong> (<em>str</em><em>, </em><em>optional</em>) – The activation function to use. Defaults to ‘torch.nn.ReLU’.</p></li>
<li><p><strong>n_head</strong> (<em>int</em><em>, </em><em>optional</em>) – The number of attention heads. Defaults to 1.</p></li>
<li><p><strong>n_layer</strong> (<em>int</em><em>, </em><em>optional</em>) – The number of layers in the model. Defaults to 2.</p></li>
<li><p><strong>stride</strong> (<em>int</em><em>, </em><em>optional</em>) – The stride for convolutional layers. Defaults to 8.</p></li>
<li><p><strong>remove_last</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to remove the last layer. Defaults to False.</p></li>
<li><p><strong>hidden_size</strong> (<em>int</em><em>, </em><em>optional</em>) – The size of the hidden layers. Defaults to 1048.</p></li>
<li><p><strong>dropout_rate</strong> (<em>float</em><em>, </em><em>optional</em>) – The dropout rate for regularization. Defaults to 0.1.</p></li>
<li><p><strong>**kwargs</strong> – Additional keyword arguments.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If the activation function is not recognized.</p>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="dsipts.PatchTST.description">
<span class="sig-name descname"><span class="pre">description</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'Can</span>&#160;&#160; <span class="pre">handle</span> <span class="pre">multivariate</span> <span class="pre">output</span> <span class="pre">\nCan</span> <span class="pre">NOT</span>&#160; <span class="pre">handle</span> <span class="pre">future</span> <span class="pre">covariates\nCan</span>&#160;&#160; <span class="pre">handle</span> <span class="pre">categorical</span> <span class="pre">covariates\nCan</span>&#160;&#160; <span class="pre">handle</span> <span class="pre">Quantile</span> <span class="pre">loss</span> <span class="pre">function'</span></em><a class="headerlink" href="#dsipts.PatchTST.description" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dsipts.PatchTST.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dsipts.PatchTST.forward" title="Link to this definition">¶</a></dt>
<dd><p>Forlward method used during the training loop</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>batch</strong> (<em>dict</em>) – the batch structure. The keys are:
y : the target variable(s). This is always present
x_num_past: the numerical past variables. This is always present
x_num_future: the numerical future variables
x_cat_past: the categorical past variables
x_cat_future: the categorical future variables
idx_target: index of target features in the past array</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>output of the mode;</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dsipts.PatchTST.handle_categorical_variables">
<span class="sig-name descname"><span class="pre">handle_categorical_variables</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#dsipts.PatchTST.handle_categorical_variables" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dsipts.PatchTST.handle_future_covariates">
<span class="sig-name descname"><span class="pre">handle_future_covariates</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#dsipts.PatchTST.handle_future_covariates" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dsipts.PatchTST.handle_multivariate">
<span class="sig-name descname"><span class="pre">handle_multivariate</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#dsipts.PatchTST.handle_multivariate" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dsipts.PatchTST.handle_quantile_loss">
<span class="sig-name descname"><span class="pre">handle_quantile_loss</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#dsipts.PatchTST.handle_quantile_loss" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dsipts.Persistent">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dsipts.</span></span><span class="sig-name descname"><span class="pre">Persistent</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dsipts.Persistent" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="dsipts.models.html#dsipts.models.base_v2.Base" title="dsipts.models.base_v2.Base"><code class="xref py py-class docutils literal notranslate"><span class="pre">Base</span></code></a></p>
<p>Simple persistent model aligned with all the other</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="dsipts.Persistent.description">
<span class="sig-name descname"><span class="pre">description</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'Can</span>&#160;&#160; <span class="pre">handle</span> <span class="pre">multivariate</span> <span class="pre">output</span> <span class="pre">\nCan</span> <span class="pre">NOT</span>&#160; <span class="pre">handle</span> <span class="pre">future</span> <span class="pre">covariates\nCan</span> <span class="pre">NOT</span>&#160; <span class="pre">handle</span> <span class="pre">categorical</span> <span class="pre">covariates\nCan</span> <span class="pre">NOT</span>&#160; <span class="pre">handle</span> <span class="pre">Quantile</span> <span class="pre">loss</span> <span class="pre">function'</span></em><a class="headerlink" href="#dsipts.Persistent.description" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dsipts.Persistent.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dsipts.Persistent.forward" title="Link to this definition">¶</a></dt>
<dd><p>Forlward method used during the training loop</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>batch</strong> (<em>dict</em>) – the batch structure. The keys are:
y : the target variable(s). This is always present
x_num_past: the numerical past variables. This is always present
x_num_future: the numerical future variables
x_cat_past: the categorical past variables
x_cat_future: the categorical future variables
idx_target: index of target features in the past array</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>output of the mode;</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dsipts.Persistent.handle_categorical_variables">
<span class="sig-name descname"><span class="pre">handle_categorical_variables</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#dsipts.Persistent.handle_categorical_variables" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dsipts.Persistent.handle_future_covariates">
<span class="sig-name descname"><span class="pre">handle_future_covariates</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#dsipts.Persistent.handle_future_covariates" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dsipts.Persistent.handle_multivariate">
<span class="sig-name descname"><span class="pre">handle_multivariate</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#dsipts.Persistent.handle_multivariate" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dsipts.Persistent.handle_quantile_loss">
<span class="sig-name descname"><span class="pre">handle_quantile_loss</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#dsipts.Persistent.handle_quantile_loss" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dsipts.RNN">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dsipts.</span></span><span class="sig-name descname"><span class="pre">RNN</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hidden_RNN</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_layers_RNN</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kind</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">activation</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'torch.nn.ReLU'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_last</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout_rate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_bn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_blocks</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bidirectional</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lstm_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'slstm'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dsipts.RNN" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="dsipts.models.html#dsipts.models.base_v2.Base" title="dsipts.models.base_v2.Base"><code class="xref py py-class docutils literal notranslate"><span class="pre">Base</span></code></a></p>
<p>Initialize a recurrent model with an encoder-decoder structure.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hidden_RNN</strong> (<em>int</em>) – Hidden size of the RNN block.</p></li>
<li><p><strong>num_layers_RNN</strong> (<em>int</em>) – Number of RNN layers.</p></li>
<li><p><strong>kind</strong> (<em>str</em>) – Type of RNN to use, either ‘gru’ or ‘lstm’ or <cite>xlstm</cite>.</p></li>
<li><p><strong>kernel_size</strong> (<em>int</em>) – Kernel size in the encoder convolutional block.</p></li>
<li><p><strong>activation</strong> (<em>str</em><em>, </em><em>optional</em>) – Activation function from PyTorch. Default is ‘torch.nn.ReLU’.</p></li>
<li><p><strong>remove_last</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, the model learns the difference with respect to the last seen point. Default is False.</p></li>
<li><p><strong>dropout_rate</strong> (<em>float</em><em>, </em><em>optional</em>) – Dropout rate in Dropout layers. Default is 0.1.</p></li>
<li><p><strong>use_bn</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, Batch Normalization layers will be added and Dropouts will be removed. Default is False.</p></li>
<li><p><strong>num_blocks</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of xLSTM blocks (only for xLSTM). Default is 4.</p></li>
<li><p><strong>bidirectional</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, the RNN is bidirectional. Default is True.</p></li>
<li><p><strong>lstm_type</strong> (<em>str</em><em>, </em><em>optional</em>) – Type of LSTM to use (only for xLSTM), either ‘slstm’ or ‘mlstm’. Default is ‘slstm’.</p></li>
<li><p><strong>**kwargs</strong> – Additional keyword arguments.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If the specified kind is not ‘lstm’, ‘gru’, or ‘xlstm’.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="dsipts.RNN.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dsipts.RNN.forward" title="Link to this definition">¶</a></dt>
<dd><p>Forlward method used during the training loop</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>batch</strong> (<em>dict</em>) – the batch structure. The keys are:
y : the target variable(s). This is always present
x_num_past: the numerical past variables. This is always present
x_num_future: the numerical future variables
x_cat_past: the categorical past variables
x_cat_future: the categorical future variables
idx_target: index of target features in the past array</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>output of the mode;</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dsipts.RNN.handle_categorical_variables">
<span class="sig-name descname"><span class="pre">handle_categorical_variables</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#dsipts.RNN.handle_categorical_variables" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dsipts.RNN.handle_future_covariates">
<span class="sig-name descname"><span class="pre">handle_future_covariates</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#dsipts.RNN.handle_future_covariates" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dsipts.RNN.handle_multivariate">
<span class="sig-name descname"><span class="pre">handle_multivariate</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#dsipts.RNN.handle_multivariate" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dsipts.RNN.handle_quantile_loss">
<span class="sig-name descname"><span class="pre">handle_quantile_loss</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#dsipts.RNN.handle_quantile_loss" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dsipts.Samformer">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dsipts.</span></span><span class="sig-name descname"><span class="pre">Samformer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hidden_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_revin</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">activation</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dsipts.Samformer" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="dsipts.models.html#dsipts.models.base_v2.Base" title="dsipts.models.base_v2.Base"><code class="xref py py-class docutils literal notranslate"><span class="pre">Base</span></code></a></p>
<p>Initialize the model with specified parameters. Samformer: Unlocking the Potential of Transformers in Time Series Forecasting with Sharpness-Aware Minimization and Channel-Wise Attention.
<a class="reference external" href="https://arxiv.org/pdf/2402.10198">https://arxiv.org/pdf/2402.10198</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hidden_size</strong> (<em>int</em>) – The size of the hidden layer.</p></li>
<li><p><strong>use_revin</strong> (<em>bool</em>) – Flag indicating whether to use RevIN.</p></li>
<li><p><strong>activation</strong> (<em>str</em><em>, </em><em>optional</em>) – The activation function to use. Defaults to ‘’.</p></li>
<li><p><strong>**kwargs</strong> – Additional keyword arguments passed to the parent class.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If the activation function is not recognized.</p>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="dsipts.Samformer.description">
<span class="sig-name descname"><span class="pre">description</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'Can</span>&#160;&#160; <span class="pre">handle</span> <span class="pre">multivariate</span> <span class="pre">output</span> <span class="pre">\nCan</span> <span class="pre">NOT</span>&#160; <span class="pre">handle</span> <span class="pre">future</span> <span class="pre">covariates\nCan</span> <span class="pre">NOT</span>&#160; <span class="pre">handle</span> <span class="pre">categorical</span> <span class="pre">covariates\nCan</span> <span class="pre">NOT</span>&#160; <span class="pre">handle</span> <span class="pre">Quantile</span> <span class="pre">loss</span> <span class="pre">function'</span></em><a class="headerlink" href="#dsipts.Samformer.description" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dsipts.Samformer.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="headerlink" href="#dsipts.Samformer.forward" title="Link to this definition">¶</a></dt>
<dd><p>Forlward method used during the training loop</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>batch</strong> (<em>dict</em>) – the batch structure. The keys are:
y : the target variable(s). This is always present
x_num_past: the numerical past variables. This is always present
x_num_future: the numerical future variables
x_cat_past: the categorical past variables
x_cat_future: the categorical future variables
idx_target: index of target features in the past array</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>output of the mode;</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dsipts.Samformer.handle_categorical_variables">
<span class="sig-name descname"><span class="pre">handle_categorical_variables</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#dsipts.Samformer.handle_categorical_variables" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dsipts.Samformer.handle_future_covariates">
<span class="sig-name descname"><span class="pre">handle_future_covariates</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#dsipts.Samformer.handle_future_covariates" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dsipts.Samformer.handle_multivariate">
<span class="sig-name descname"><span class="pre">handle_multivariate</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#dsipts.Samformer.handle_multivariate" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dsipts.Samformer.handle_quantile_loss">
<span class="sig-name descname"><span class="pre">handle_quantile_loss</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#dsipts.Samformer.handle_quantile_loss" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dsipts.Simple">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dsipts.</span></span><span class="sig-name descname"><span class="pre">Simple</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hidden_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout_rate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">activation</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'torch.nn.ReLU'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dsipts.Simple" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="dsipts.models.html#dsipts.models.base_v2.Base" title="dsipts.models.base_v2.Base"><code class="xref py py-class docutils literal notranslate"><span class="pre">Base</span></code></a></p>
<p>This is the basic model, each model implemented must overwrite the init method and the forward method.
The inference step is optional, by default it uses the forward method but for recurrent
network you should implement your own method</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>verbose</strong> (<em>bool</em>) – Flag to enable verbose logging.</p></li>
<li><p><strong>past_steps</strong> (<em>int</em>) – Number of past time steps to consider.</p></li>
<li><p><strong>future_steps</strong> (<em>int</em>) – Number of future time steps to predict.</p></li>
<li><p><strong>past_channels</strong> (<em>int</em>) – Number of channels in the past input data.</p></li>
<li><p><strong>future_channels</strong> (<em>int</em>) – Number of channels in the future input data.</p></li>
<li><p><strong>out_channels</strong> (<em>int</em>) – Number of output channels.</p></li>
<li><p><strong>embs_past</strong> (<em>List</em><em>[</em><em>int</em><em>]</em>) – List of embedding dimensions for past data.</p></li>
<li><p><strong>embs_fut</strong> (<em>List</em><em>[</em><em>int</em><em>]</em>) – List of embedding dimensions for future data.</p></li>
<li><p><strong>n_classes</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of classes for classification. Defaults to 0.</p></li>
<li><p><strong>persistence_weight</strong> (<em>float</em><em>, </em><em>optional</em>) – Weight for persistence in loss calculation. Defaults to 0.0.</p></li>
<li><p><strong>loss_type</strong> (<em>str</em><em>, </em><em>optional</em>) – Type of loss function to use (‘l1’ or ‘mse’). Defaults to ‘l1’.</p></li>
<li><p><strong>quantiles</strong> (<em>List</em><em>[</em><em>int</em><em>]</em><em>, </em><em>optional</em>) – List of quantiles for quantile loss. Defaults to an empty list.</p></li>
<li><p><strong>reduction_mode</strong> (<em>str</em><em>, </em><em>optional</em>) – Mode for reduction for categorical embedding layer (‘mean’, ‘sum’, ‘none’). Defaults to ‘mean’.</p></li>
<li><p><strong>use_classical_positional_encoder</strong> (<em>bool</em><em>, </em><em>optional</em>) – Flag to use classical positional encoding or using embedding layer also for the positions. Defaults to False.</p></li>
<li><p><strong>emb_dim</strong> (<em>int</em><em>, </em><em>optional</em>) – Dimension of categorical embeddings. Defaults to 16.</p></li>
<li><p><strong>optim</strong> (<em>Union</em><em>[</em><em>str</em><em>, </em><em>None</em><em>]</em><em>, </em><em>optional</em>) – Optimizer type. Defaults to None.</p></li>
<li><p><strong>optim_config</strong> (<em>dict</em><em>, </em><em>optional</em>) – Configuration for the optimizer. Defaults to None.</p></li>
<li><p><strong>scheduler_config</strong> (<em>dict</em><em>, </em><em>optional</em>) – Configuration for the learning rate scheduler. Defaults to None.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>AssertionError</strong> – If the number of quantiles is not equal to 3 when quantiles are provided.</p></li>
<li><p><strong>AssertionError</strong> – If the number of output channels is not 1 for classification tasks.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="dsipts.Simple.description">
<span class="sig-name descname"><span class="pre">description</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'Can</span>&#160;&#160; <span class="pre">handle</span> <span class="pre">multivariate</span> <span class="pre">output</span> <span class="pre">\nCan</span>&#160;&#160; <span class="pre">handle</span> <span class="pre">future</span> <span class="pre">covariates\nCan</span>&#160;&#160; <span class="pre">handle</span> <span class="pre">categorical</span> <span class="pre">covariates\nCan</span>&#160;&#160; <span class="pre">handle</span> <span class="pre">Quantile</span> <span class="pre">loss</span> <span class="pre">function\n</span> <span class="pre">THE</span> <span class="pre">SIMPLE</span> <span class="pre">IMPLEMENTATION</span> <span class="pre">DOES</span> <span class="pre">NOT</span> <span class="pre">USE</span> <span class="pre">CATEGORICAL</span> <span class="pre">NOR</span> <span class="pre">FUTURE</span> <span class="pre">VARIABLES'</span></em><a class="headerlink" href="#dsipts.Simple.description" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dsipts.Simple.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dsipts.Simple.forward" title="Link to this definition">¶</a></dt>
<dd><p>Forlward method used during the training loop</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>batch</strong> (<em>dict</em>) – the batch structure. The keys are:
y : the target variable(s). This is always present
x_num_past: the numerical past variables. This is always present
x_num_future: the numerical future variables
x_cat_past: the categorical past variables
x_cat_future: the categorical future variables
idx_target: index of target features in the past array</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>output of the mode;</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dsipts.Simple.handle_categorical_variables">
<span class="sig-name descname"><span class="pre">handle_categorical_variables</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#dsipts.Simple.handle_categorical_variables" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dsipts.Simple.handle_future_covariates">
<span class="sig-name descname"><span class="pre">handle_future_covariates</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#dsipts.Simple.handle_future_covariates" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dsipts.Simple.handle_multivariate">
<span class="sig-name descname"><span class="pre">handle_multivariate</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#dsipts.Simple.handle_multivariate" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dsipts.Simple.handle_quantile_loss">
<span class="sig-name descname"><span class="pre">handle_quantile_loss</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#dsipts.Simple.handle_quantile_loss" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dsipts.TFT">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dsipts.</span></span><span class="sig-name descname"><span class="pre">TFT</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_layers_RNN</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d_head</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_head</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout_rate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dsipts.TFT" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="dsipts.models.html#dsipts.models.base_v2.Base" title="dsipts.models.base_v2.Base"><code class="xref py py-class docutils literal notranslate"><span class="pre">Base</span></code></a></p>
<p>Initializes the model for time series forecasting with attention mechanisms and recurrent neural networks.</p>
<p>This model is designed for direct forecasting, allowing for multi-output and multi-horizon predictions. It leverages attention mechanisms to enhance the selection of relevant past time steps and learn long-term dependencies. The architecture includes RNN enrichment, gating mechanisms to minimize the impact of irrelevant variables, and the ability to output prediction intervals through quantile regression.</p>
<p>Key features include:
- Direct Model: Predicts all future steps at once.
- Multi-Output Forecasting: Capable of predicting one or more variables simultaneously.
- Multi-Horizon Forecasting: Predicts variables at multiple future time steps.
- Attention-Based Mechanism: Enhances the selection of relevant past time steps and learns long-term dependencies.
- RNN Enrichment: Utilizes LSTM for initial autoregressive approximation, which is refined by the rest of the network.
- Gating Mechanisms: Reduces the contribution of irrelevant variables.
- Prediction Intervals: Outputs percentiles (e.g., 10th, 50th, 90th) at each time step.</p>
<p>The model also facilitates interpretability by identifying:
- Global importance of variables for both past and future.
- Temporal patterns.
- Significant events.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>d_model</strong> (<em>int</em>) – General hidden dimension across the network, adjustable in sub-networks.</p></li>
<li><p><strong>num_layers_RNN</strong> (<em>int</em>) – Number of layers in the recurrent neural network (LSTM).</p></li>
<li><p><strong>d_head</strong> (<em>int</em>) – Dimension of each attention head.</p></li>
<li><p><strong>n_head</strong> (<em>int</em>) – Number of attention heads.</p></li>
<li><p><strong>dropout_rate</strong> (<em>float</em>) – Dropout rate applied uniformly across all dropout layers.</p></li>
<li><p><strong>**kwargs</strong> – Additional keyword arguments for further customization.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="dsipts.TFT.description">
<span class="sig-name descname"><span class="pre">description</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'Can</span>&#160;&#160; <span class="pre">handle</span> <span class="pre">multivariate</span> <span class="pre">output</span> <span class="pre">\nCan</span>&#160;&#160; <span class="pre">handle</span> <span class="pre">future</span> <span class="pre">covariates\nCan</span>&#160;&#160; <span class="pre">handle</span> <span class="pre">categorical</span> <span class="pre">covariates\nCan</span>&#160;&#160; <span class="pre">handle</span> <span class="pre">Quantile</span> <span class="pre">loss</span> <span class="pre">function'</span></em><a class="headerlink" href="#dsipts.TFT.description" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dsipts.TFT.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="headerlink" href="#dsipts.TFT.forward" title="Link to this definition">¶</a></dt>
<dd><p>Temporal Fusion Transformer</p>
<p>Collectiong Data
- Extract the autoregressive variable(s)
- Embedding and compute a first approximated prediction
- ‘summary_past’ and ‘summary_fut’ collecting data about past and future
Concatenating on the dimension 2 all different datas, which will be mixed through a MEAN over that imension
Info get from other tensor of the batch taken as input</p>
<p>TFT actual computations
- Residual Connection for y_past and summary_past
- Residual Connection for y_fut and summary_fut
- GRN1 for past and for fut
- ATTENTION(summary_fut, summary_past, y_past)
- Residual Connection for attention itself
- GRN2 for attention
- Residual Connection for attention and summary_fut
- Linear for actual values and reshape</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>batch</strong> (<em>dict</em>) – Keys used are [‘x_num_past’, ‘idx_target’, ‘x_num_future’, ‘x_cat_past’, ‘x_cat_future’]</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>shape [B, self.future_steps, self.out_channels, self.mul] or [B, self.future_steps, self.out_channels] according to quantiles</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dsipts.TFT.handle_categorical_variables">
<span class="sig-name descname"><span class="pre">handle_categorical_variables</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#dsipts.TFT.handle_categorical_variables" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dsipts.TFT.handle_future_covariates">
<span class="sig-name descname"><span class="pre">handle_future_covariates</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#dsipts.TFT.handle_future_covariates" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dsipts.TFT.handle_multivariate">
<span class="sig-name descname"><span class="pre">handle_multivariate</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#dsipts.TFT.handle_multivariate" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dsipts.TFT.handle_quantile_loss">
<span class="sig-name descname"><span class="pre">handle_quantile_loss</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#dsipts.TFT.handle_quantile_loss" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dsipts.TFT.remove_var">
<span class="sig-name descname"><span class="pre">remove_var</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tensor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indexes_to_exclude</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dimension</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="headerlink" href="#dsipts.TFT.remove_var" title="Link to this definition">¶</a></dt>
<dd><p>Function to remove variables from tensors in chosen dimension and position</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tensor</strong> (<em>torch.Tensor</em>) – starting tensor</p></li>
<li><p><strong>indexes_to_exclude</strong> (<em>int</em>) – index of the chosen dimension we want t oexclude</p></li>
<li><p><strong>dimension</strong> (<em>int</em>) – dimension of the tensor on which we want to work</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>new tensor without the chosen variables</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dsipts.TIDE">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dsipts.</span></span><span class="sig-name descname"><span class="pre">TIDE</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hidden_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_add_enc</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_add_dec</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout_rate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">activation</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dsipts.TIDE" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="dsipts.models.html#dsipts.models.base_v2.Base" title="dsipts.models.base_v2.Base"><code class="xref py py-class docutils literal notranslate"><span class="pre">Base</span></code></a></p>
<p>Initializes the model with specified parameters for a neural network architecture. Long-term Forecasting with TiDE: Time-series Dense Encoder
<a class="reference external" href="https://arxiv.org/abs/2304.08424">https://arxiv.org/abs/2304.08424</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hidden_size</strong> (<em>int</em>) – The size of the hidden layers.</p></li>
<li><p><strong>d_model</strong> (<em>int</em>) – The dimensionality of the model.</p></li>
<li><p><strong>n_add_enc</strong> (<em>int</em>) – The number of additional encoder layers.</p></li>
<li><p><strong>n_add_dec</strong> (<em>int</em>) – The number of additional decoder layers.</p></li>
<li><p><strong>dropout_rate</strong> (<em>float</em>) – The dropout rate to be applied in the layers.</p></li>
<li><p><strong>activation</strong> (<em>str</em><em>, </em><em>optional</em>) – The activation function to be used. Defaults to an empty string.</p></li>
<li><p><strong>**kwargs</strong> – Additional keyword arguments passed to the parent class.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="dsipts.TIDE.description">
<span class="sig-name descname"><span class="pre">description</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'Can</span>&#160;&#160; <span class="pre">handle</span> <span class="pre">multivariate</span> <span class="pre">output</span> <span class="pre">\nCan</span>&#160;&#160; <span class="pre">handle</span> <span class="pre">future</span> <span class="pre">covariates\nCan</span>&#160;&#160; <span class="pre">handle</span> <span class="pre">categorical</span> <span class="pre">covariates\nCan</span>&#160;&#160; <span class="pre">handle</span> <span class="pre">Quantile</span> <span class="pre">loss</span> <span class="pre">function'</span></em><a class="headerlink" href="#dsipts.TIDE.description" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dsipts.TIDE.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="headerlink" href="#dsipts.TIDE.forward" title="Link to this definition">¶</a></dt>
<dd><p>training process of the diffusion network</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>batch</strong> (<em>dict</em>) – variables loaded</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>total loss about the prediction of the noises over all subnets extracted</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dsipts.TIDE.handle_categorical_variables">
<span class="sig-name descname"><span class="pre">handle_categorical_variables</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#dsipts.TIDE.handle_categorical_variables" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dsipts.TIDE.handle_future_covariates">
<span class="sig-name descname"><span class="pre">handle_future_covariates</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#dsipts.TIDE.handle_future_covariates" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dsipts.TIDE.handle_multivariate">
<span class="sig-name descname"><span class="pre">handle_multivariate</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#dsipts.TIDE.handle_multivariate" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dsipts.TIDE.handle_quantile_loss">
<span class="sig-name descname"><span class="pre">handle_quantile_loss</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#dsipts.TIDE.handle_quantile_loss" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dsipts.TIDE.remove_var">
<span class="sig-name descname"><span class="pre">remove_var</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tensor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indexes_to_exclude</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dimension</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="headerlink" href="#dsipts.TIDE.remove_var" title="Link to this definition">¶</a></dt>
<dd><p>Function to remove variables from tensors in chosen dimension and position</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tensor</strong> (<em>torch.Tensor</em>) – starting tensor</p></li>
<li><p><strong>indexes_to_exclude</strong> (<em>list</em>) – index of the chosen dimension we want t oexclude</p></li>
<li><p><strong>dimension</strong> (<em>int</em>) – dimension of the tensor on which we want to work (not list od dims!!)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>new tensor without the chosen variables</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dsipts.TTM">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dsipts.</span></span><span class="sig-name descname"><span class="pre">TTM</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">past_steps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">future_steps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">freq_prefix_tuning</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">freq</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prefer_l1_loss</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prefer_longer_context</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_input_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prediction_channel_indices</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exogenous_channel_indices</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decoder_mode</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fcm_context_length</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fcm_use_mixer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fcm_mix_layers</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fcm_prepend_past</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enable_forecast_channel_mixing</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_channels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">embs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_last</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optim_config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scheduler_config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_quantiles</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">persistence_weight</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quantiles</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dsipts.TTM" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="dsipts.models.html#dsipts.models.base_v2.Base" title="dsipts.models.base_v2.Base"><code class="xref py py-class docutils literal notranslate"><span class="pre">Base</span></code></a></p>
<p>TODO and FIX for future and past categorical variables</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model_path</strong> (<em>str</em>) – _description_</p></li>
<li><p><strong>past_steps</strong> (<em>int</em>) – _description_</p></li>
<li><p><strong>future_steps</strong> (<em>int</em>) – _description_</p></li>
<li><p><strong>freq_prefix_tuning</strong> (<em>bool</em>) – _description_</p></li>
<li><p><strong>freq</strong> (<em>str</em>) – _description_</p></li>
<li><p><strong>prefer_l1_loss</strong> (<em>bool</em>) – _description_</p></li>
<li><p><strong>loss_type</strong> (<em>str</em>) – _description_</p></li>
<li><p><strong>num_input_channels</strong> (<em>_type_</em>) – _description_</p></li>
<li><p><strong>prediction_channel_indices</strong> (<em>_type_</em>) – _description_</p></li>
<li><p><strong>exogenous_channel_indices</strong> (<em>_type_</em>) – _description_</p></li>
<li><p><strong>decoder_mode</strong> (<em>_type_</em>) – _description_</p></li>
<li><p><strong>fcm_context_length</strong> (<em>_type_</em>) – _description_</p></li>
<li><p><strong>fcm_use_mixer</strong> (<em>_type_</em>) – _description_</p></li>
<li><p><strong>fcm_mix_layers</strong> (<em>_type_</em>) – _description_</p></li>
<li><p><strong>fcm_prepend_past</strong> (<em>_type_</em>) – _description_</p></li>
<li><p><strong>enable_forecast_channel_mixing</strong> (<em>_type_</em>) – _description_</p></li>
<li><p><strong>out_channels</strong> (<em>int</em>) – _description_</p></li>
<li><p><strong>embs</strong> (<em>List</em><em>[</em><em>int</em><em>]</em>) – _description_</p></li>
<li><p><strong>remove_last</strong> (<em>bool</em><em>, </em><em>optional</em>) – _description_. Defaults to False.</p></li>
<li><p><strong>optim</strong> (<em>Union</em><em>[</em><em>str</em><em>,</em><em>None</em><em>]</em><em>, </em><em>optional</em>) – _description_. Defaults to None.</p></li>
<li><p><strong>optim_config</strong> (<em>dict</em><em>, </em><em>optional</em>) – _description_. Defaults to None.</p></li>
<li><p><strong>scheduler_config</strong> (<em>dict</em><em>, </em><em>optional</em>) – _description_. Defaults to None.</p></li>
<li><p><strong>verbose</strong> (<em>bool</em><em>, </em><em>optional</em>) – _description_. Defaults to False.</p></li>
<li><p><strong>use_quantiles</strong> (<em>bool</em><em>, </em><em>optional</em>) – _description_. Defaults to False.</p></li>
<li><p><strong>persistence_weight</strong> (<em>float</em><em>, </em><em>optional</em>) – _description_. Defaults to 0.0.</p></li>
<li><p><strong>quantiles</strong> (<em>List</em><em>[</em><em>int</em><em>]</em><em>, </em><em>optional</em>) – _description_. Defaults to [].</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="dsipts.TTM.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dsipts.TTM.forward" title="Link to this definition">¶</a></dt>
<dd><p>Forlward method used during the training loop</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>batch</strong> (<em>dict</em>) – the batch structure. The keys are:
y : the target variable(s). This is always present
x_num_past: the numerical past variables. This is always present
x_num_future: the numerical future variables
x_cat_past: the categorical past variables
x_cat_future: the categorical future variables
idx_target: index of target features in the past array</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>output of the mode;</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.tensor</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dsipts.TimeSeries">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dsipts.</span></span><span class="sig-name descname"><span class="pre">TimeSeries</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stacked</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dsipts.TimeSeries" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class for generating time series object. If you don’t have any time series you can build one fake timeseries using some helping classes (Categorical for instance).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<em>str</em>) – name of the series</p></li>
<li><p><strong>stacked</strong> (<em>bool</em>) – if true it is a stacked model</p></li>
</ul>
</dd>
</dl>
<dl>
<dt>Usage:</dt><dd><p>For example we can generate a toy timeseries:</p>
<ul class="simple">
<li><p>add a multiplicative categorical feature (weekly)</p></li>
</ul>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">settimana</span> <span class="o">=</span> <span class="n">Categorical</span><span class="p">(</span><span class="s1">&#39;settimanale&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">,[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="mi">7</span><span class="p">,</span><span class="s1">&#39;multiplicative&#39;</span><span class="p">,[</span><span class="mf">0.9</span><span class="p">,</span><span class="mf">0.8</span><span class="p">,</span><span class="mf">0.7</span><span class="p">,</span><span class="mf">0.6</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.99</span><span class="p">,</span><span class="mf">0.99</span><span class="p">])</span>
</pre></div>
</div>
<ul class="simple">
<li><p>an additive montly feature (here a year is composed by 5 months)</p></li>
</ul>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mese</span> <span class="o">=</span> <span class="n">Categorical</span><span class="p">(</span><span class="s1">&#39;mensile&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">,[</span><span class="mi">31</span><span class="p">,</span><span class="mi">28</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">33</span><span class="p">],</span><span class="mi">5</span><span class="p">,</span><span class="s1">&#39;additive&#39;</span><span class="p">,[</span><span class="mi">10</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
<ul class="simple">
<li><p>a spotted categorical variable that happens every 100 days and lasts 1 day</p></li>
</ul>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">spot</span> <span class="o">=</span> <span class="n">Categorical</span><span class="p">(</span><span class="s1">&#39;spot&#39;</span><span class="p">,</span><span class="mi">100</span><span class="p">,[</span><span class="mi">7</span><span class="p">],</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;additive&#39;</span><span class="p">,[</span><span class="mi">10</span><span class="p">])</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ts</span> <span class="o">=</span> <span class="n">TimeSeries</span><span class="p">(</span><span class="s1">&#39;prova&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ts</span><span class="o">.</span><span class="n">generate_signal</span><span class="p">(</span><span class="n">length</span> <span class="o">=</span> <span class="mi">5000</span><span class="p">,</span><span class="n">categorical_variables</span> <span class="o">=</span> <span class="p">[</span><span class="n">settimana</span><span class="p">,</span><span class="n">mese</span><span class="p">,</span><span class="n">spot</span><span class="p">],</span><span class="n">noise_mean</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="nb">type</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="c1">##we can add also noise</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ts</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="dsipts.TimeSeries.create_data_loader">
<span class="sig-name descname"><span class="pre">create_data_loader</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">past_steps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">future_steps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shift</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keep_entire_seq_while_shifting</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">starting_point</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">None</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skip_step</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_inference</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="dsipts.data_structure.html#dsipts.data_structure.utils.MyDataset" title="dsipts.data_structure.utils.MyDataset"><span class="pre">MyDataset</span></a></span></span><a class="headerlink" href="#dsipts.TimeSeries.create_data_loader" title="Link to this definition">¶</a></dt>
<dd><p>Create the dataset for the training/inference step</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>pd.DataFrame</em>) – input dataset, usually a subset of self.data</p></li>
<li><p><strong>past_steps</strong> (<em>int</em>) – past context length</p></li>
<li><p><strong>future_steps</strong> (<em>int</em>) – future lags to predict</p></li>
<li><p><strong>shift</strong> (<em>int</em><em>, </em><em>optional</em>) – if &gt;0 the future input variables will be shifted (categorical and numerical). For example for attention model it is better to start with a know value of y and use it during the process. Defaults to 0.</p></li>
<li><p><strong>keep_entire_seq_while_shifting</strong> (<em>bool</em><em>, </em><em>optional</em>) – if the dataset is shifted, you may want the future data be of length future_step+shift (like informer), default false</p></li>
<li><p><strong>starting_point</strong> (<em>Union</em><em>[</em><em>None</em><em>,</em><em>dict</em><em>]</em><em>, </em><em>optional</em>) – a dictionary indicating if a sample must be considered. It is checked for the first lag in the future (useful in the case your model has to predict only starting from hour 12). Defaults to None.</p></li>
<li><p><strong>skip_step</strong> (<em>int</em><em>, </em><em>optional</em>) – list of the categortial variables (same for past and future). Usual there is a skip of one between two saples but for debugging  or training time purposes you can skip some samples. Defaults to 1.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>class that extends torch.utils.data.Dataset (see utils)</dt><dd><p>keys of a batch:
y : the target variable(s)
x_num_past: the numerical past variables
x_num_future: the numerical future variables
x_cat_past: the categorical past variables
x_cat_future: the categorical future variables
idx_target: index of target features in the past array</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="dsipts.data_structure.html#dsipts.data_structure.utils.MyDataset" title="dsipts.data_structure.utils.MyDataset">MyDataset</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dsipts.TimeSeries.enrich">
<span class="sig-name descname"><span class="pre">enrich</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">columns</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dsipts.TimeSeries.enrich" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dsipts.TimeSeries.generate_signal">
<span class="sig-name descname"><span class="pre">generate_signal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">length</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">5000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">categorical_variables</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="dsipts.data_structure.html#dsipts.data_structure.data_structure.Categorical" title="dsipts.data_structure.data_structure.Categorical"><span class="pre">Categorical</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noise_mean</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#dsipts.TimeSeries.generate_signal" title="Link to this definition">¶</a></dt>
<dd><p>This will generate a syntetic signal with a selected length, a noise level and some categorical variables. The additive series are added at the end while the multiplicative series acts on the original signal
The TS structure will be populated</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>length</strong> (<em>int</em><em>, </em><em>optional</em>) – length of the signal. Defaults to 5000.</p></li>
<li><p><strong>categorical_variables</strong> (<em>List</em><em>[</em><a class="reference internal" href="generated/dsipts.Categorical.html#dsipts.Categorical" title="dsipts.Categorical"><em>Categorical</em></a><em>]</em><em>, </em><em>optional</em>) – list of Categorical variables. Defaults to [].</p></li>
<li><p><strong>noise_mean</strong> (<em>int</em><em>, </em><em>optional</em>) – variance of the noise to add at the end. Defaults to 1.</p></li>
<li><p><strong>type</strong> (<em>int</em><em>, </em><em>optional</em>) – type of the timeseries (only type=0 available right now). Defaults to 0.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dsipts.TimeSeries.inference">
<span class="sig-name descname"><span class="pre">inference</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_workers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">split_params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">None</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rescaling</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">steps_in_future</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_holes_and_duplicates</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_inference</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="headerlink" href="#dsipts.TimeSeries.inference" title="Link to this definition">¶</a></dt>
<dd><p>similar to <cite>inference_on_set</cite>
only change is split_params that must contain this keys but using the default can be sufficient:
‘past_steps’,’future_steps’,’shift’,’keep_entire_seq_while_shifting’,’starting_point’</p>
<p>skip_step is set to 1 for convenience (generally you want all the predictions)
You can set split_params to None and use the standard parameters (at your own risck)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>batch_size</strong> (<em>int</em><em>, </em><em>optional</em>) – see inference_on_set. Defaults to 100.</p></li>
<li><p><strong>num_workers</strong> (<em>int</em><em>, </em><em>optional</em>) – inference_on_set. Defaults to 4.</p></li>
<li><p><strong>split_params</strong> (<em>Union</em><em>[</em><em>None</em><em>,</em><em>dict</em><em>]</em><em>, </em><em>optional</em>) – inference_on_set. Defaults to None.</p></li>
<li><p><strong>rescaling</strong> (<em>bool</em><em>, </em><em>optional</em>) – inference_on_set. Defaults to True.</p></li>
<li><p><strong>data</strong> (<em>pd.DataFrame</em><em>, </em><em>optional</em>) – startin dataset. Defaults to None.</p></li>
<li><p><strong>steps_in_future</strong> (<em>int</em><em>, </em><em>optional</em>) – if&gt;0 the dataset is extendend in order to make predictions in the future. Defaults to 0.</p></li>
<li><p><strong>check_holes_and_duplicates</strong> (<em>bool</em><em>, </em><em>optional</em>) – if False the routine does not check for holes or for duplicates, set to False for stacked model. Defaults to True.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>predicted values</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dsipts.TimeSeries.inference_on_set">
<span class="sig-name descname"><span class="pre">inference_on_set</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_workers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">split_params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">None</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">set</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'test'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rescaling</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">None</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Dataset</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="headerlink" href="#dsipts.TimeSeries.inference_on_set" title="Link to this definition">¶</a></dt>
<dd><p>This function allows to get the prediction on a particular set (train, test or validation).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>batch_size</strong> (<em>int</em><em>, </em><em>optional</em>) – barch sise. Defaults to 100.</p></li>
<li><p><strong>num_workers</strong> (<em>int</em><em>, </em><em>optional</em>) – num workers. Defaults to 4.</p></li>
<li><p><strong>split_params</strong> (<em>Union</em><em>[</em><em>None</em><em>,</em><em>dict</em><em>]</em><em>, </em><em>optional</em>) – if not None  the spliting procedure will use the given data otherwise it will use the same configuration used in train. Defaults to None.</p></li>
<li><p><strong>set</strong> (<em>str</em><em>, </em><em>optional</em>) – trai, validation or test. Defaults to ‘test’.</p></li>
<li><p><strong>rescaling</strong> (<em>bool</em><em>, </em><em>optional</em>) – If rescaling is true the output will be rescaled to the initial values. . Defaults to True.</p></li>
<li><p><strong>data</strong> (<em>None</em><em> or </em><em>pd.DataFrame</em><em>, </em><em>optional</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the predicted values in a pandas format</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dsipts.TimeSeries.load">
<span class="sig-name descname"><span class="pre">load</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="dsipts.models.html#dsipts.models.base_v2.Base" title="dsipts.models.base_v2.Base"><span class="pre">Base</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">load_last</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dirpath</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#dsipts.TimeSeries.load" title="Link to this definition">¶</a></dt>
<dd><p>Load a saved model</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<a class="reference internal" href="generated/dsipts.Base.html#dsipts.Base" title="dsipts.Base"><em>Base</em></a>) – class of the model to load (it will be initiated by pytorch-lightening)</p></li>
<li><p><strong>filename</strong> (<em>str</em>) – filename of the saved model</p></li>
<li><p><strong>load_last</strong> (<em>bool</em><em>, </em><em>optional</em>) – if true the last checkpoint will be loaded otherwise the best (in the validation set). Defaults to True.</p></li>
<li><p><strong>dirpath</strong> (<em>Union</em><em>[</em><em>str</em><em>,</em><em>None</em><em>]</em><em>, </em><em>optional</em>) – if None we asssume that the model is loaded from the same pc where it has been trained, otherwise we can pass the dirpath where all the stuff has been saved . Defaults to None.</p></li>
<li><p><strong>weight_path</strong> (<em>Union</em><em>[</em><em>str</em><em>, </em><em>None</em><em>]</em><em>, </em><em>optional</em>) – if None the standard path will be used. Defaults to None.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dsipts.TimeSeries.load_signal">
<span class="sig-name descname"><span class="pre">load_signal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enrich_cat</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">past_variables</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">future_variables</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_variables</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cat_past_var</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cat_fut_var</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_past</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">group</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">None</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_holes_and_duplicates</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">silly_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#dsipts.TimeSeries.load_signal" title="Link to this definition">¶</a></dt>
<dd><dl>
<dt>This is a crucial point in the data structure. We expect here to have a dataset with time as timestamp.</dt><dd><dl>
<dt>There are some checks:</dt><dd><p>1- the duplicates will tbe removed taking the first instance</p>
<p>2- the frequency will the inferred taking the minumum time distance between samples</p>
<p>3- the dataset will be filled completing the missing timestamps</p>
</dd>
</dl>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>pd.DataFrame</em>) – input dataset the column indicating the time must be called <cite>time</cite></p></li>
<li><p><strong>enrich_cat</strong> (<em>List</em><em>[</em><em>str</em><em>]</em><em>, </em><em>optional</em>) – it is possible to let this function enrich the dataset for example adding the standard columns: hour, dow, month and minute. Defaults to [].</p></li>
<li><p><strong>past_variables</strong> (<em>List</em><em>[</em><em>str</em><em>]</em><em>, </em><em>optional</em>) – list of column names of past variables not available for future times . Defaults to [].</p></li>
<li><p><strong>future_variables</strong> (<em>List</em><em>[</em><em>str</em><em>]</em><em>, </em><em>optional</em>) – list of future variables available for tuture times. Defaults to [].</p></li>
<li><p><strong>target_variables</strong> (<em>List</em><em>[</em><em>str</em><em>]</em><em>, </em><em>optional</em>) – list of the target variables. They will added to past_variables by default unless <cite>check_past</cite> is false. Defaults to [].</p></li>
<li><p><strong>cat_past_var</strong> (<em>List</em><em>[</em><em>str</em><em>]</em><em>, </em><em>optional</em>) – list of the past categorical variables. Defaults to [].</p></li>
<li><p><strong>cat_future_var</strong> (<em>List</em><em>[</em><em>str</em><em>]</em><em>, </em><em>optional</em>) – list of the future categorical variables. Defaults to [].</p></li>
<li><p><strong>check_past</strong> (<em>bool</em><em>, </em><em>optional</em>) – see <cite>target_variables</cite>. Defaults to True.</p></li>
<li><p><strong>group</strong> (<em>str</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – if not None the time serie dataset is considered composed by omogeneus timeseries coming from different realization (for example point of sales, cities, locations) and the relative series are not splitted during the sample generation. Defaults to None</p></li>
<li><p><strong>check_holes_and_duplicates</strong> (<em>bool</em><em>, </em><em>optional</em>) – if False duplicates or holes will not checked, the dataloader can not correctly work, disable at your own risk. Defaults True</p></li>
<li><p><strong>silly_model</strong> (<em>bool</em><em>, </em><em>optional</em>) – if True, target variables will be added to the pool of the future variables. This can be useful to see if information passes throught the decoder part of your model (if any)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dsipts.TimeSeries.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#dsipts.TimeSeries.plot" title="Link to this definition">¶</a></dt>
<dd><p>Easy way to control the loaded data
:returns: figure of the target variables
:rtype: plotly.graph_objects._figure.Figure</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dsipts.TimeSeries.save">
<span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#dsipts.TimeSeries.save" title="Link to this definition">¶</a></dt>
<dd><p>save the timeseries object</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>filename</strong> (<em>str</em>) – name of the file</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dsipts.TimeSeries.set_model">
<span class="sig-name descname"><span class="pre">set_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="dsipts.models.html#dsipts.models.base_v2.Base" title="dsipts.models.base_v2.Base"><span class="pre">Base</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">custom_init</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dsipts.TimeSeries.set_model" title="Link to this definition">¶</a></dt>
<dd><p>Set the model to train</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<a class="reference internal" href="generated/dsipts.Base.html#dsipts.Base" title="dsipts.Base"><em>Base</em></a>) – see <cite>models</cite></p></li>
<li><p><strong>config</strong> (<em>dict</em><em>, </em><em>optional</em>) – usually the configuration used by the model. Defaults to None.</p></li>
<li><p><strong>custom_init</strong> (<em>bool</em><em>, </em><em>optional</em>) – if true a custom initialization paradigm will be used (see weight_init in models/utils.py ) .</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dsipts.TimeSeries.set_verbose">
<span class="sig-name descname"><span class="pre">set_verbose</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dsipts.TimeSeries.set_verbose" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dsipts.TimeSeries.split_for_train">
<span class="sig-name descname"><span class="pre">split_for_train</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">perc_train</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">perc_valid</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">range_train</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">datetime</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">range_validation</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">datetime</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">range_test</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">datetime</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">past_steps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">future_steps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shift</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keep_entire_seq_while_shifting</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">starting_point</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">None</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skip_step</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize_per_group</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_consecutive</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scaler</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'StandardScaler()'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">DataLoader</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#dsipts.TimeSeries.split_for_train" title="Link to this definition">¶</a></dt>
<dd><p>Split the data and create the datasets.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>perc_train</strong> (<em>Union</em><em>[</em><em>float</em><em>,</em><em>None</em><em>]</em><em>, </em><em>optional</em>) – fraction of the training set. Defaults to 0.6.</p></li>
<li><p><strong>perc_valid</strong> (<em>Union</em><em>[</em><em>float</em><em>,</em><em>None</em><em>]</em><em>, </em><em>optional</em>) – fraction of the test set. Defaults to 0.2.</p></li>
<li><p><strong>range_train</strong> (<em>Union</em><em>[</em><em>List</em><em>[</em><em>Union</em><em>[</em><em>datetime</em><em>, </em><em>str</em><em>]</em><em>]</em><em>,</em><em>None</em><em>]</em><em>, </em><em>optional</em>) – a list of two elements indicating the starting point and end point of the training set (string date style or datetime). Defaults to None.</p></li>
<li><p><strong>range_validation</strong> (<em>Union</em><em>[</em><em>List</em><em>[</em><em>Union</em><em>[</em><em>datetime</em><em>, </em><em>str</em><em>]</em><em>]</em><em>,</em><em>None</em><em>]</em><em>, </em><em>optional</em>) – a list of two elements indicating the starting point and end point of the validation set (string date style or datetime). Defaults to None.</p></li>
<li><p><strong>range_test</strong> (<em>Union</em><em>[</em><em>List</em><em>[</em><em>Union</em><em>[</em><em>datetime</em><em>, </em><em>str</em><em>]</em><em>]</em><em>,</em><em>None</em><em>]</em><em>, </em><em>optional</em>) – a list of two elements indicating the starting point and end point of the test set (string date style or datetime). Defaults to None.</p></li>
<li><p><strong>past_steps</strong> (<em>int</em><em>, </em><em>optional</em>) – past step to consider for making the prediction. Defaults to 100.</p></li>
<li><p><strong>future_steps</strong> (<em>int</em><em>, </em><em>optional</em>) – future step to predict. Defaults to 20.</p></li>
<li><p><strong>shift</strong> (<em>int</em><em>, </em><em>optional</em>) – see <cite>create_data_loader</cite>. Defaults to 0.</p></li>
<li><p><strong>keep_entire_seq_while_shifting</strong> (<em>bool</em><em>, </em><em>optional</em>) – if the dataset is shifted, you may want the future data be of length future_step+shift (like informer), default false</p></li>
<li><p><strong>starting_point</strong> (<em>Union</em><em>[</em><em>None</em><em>, </em><em>dict</em><em>]</em><em>, </em><em>optional</em>) – see <cite>create_data_loader</cite>. Defaults to None.</p></li>
<li><p><strong>skip_step</strong> (<em>int</em><em>, </em><em>optional</em>) – see <cite>create_data_loader</cite>. Defaults to 1.</p></li>
<li><p><strong>normalize_per_group</strong> (<em>boolean</em><em>, </em><em>optional</em>) – if true and self.group is not None, the variables are scaled respect to the groups. Default False</p></li>
<li><p><strong>check_consecutive</strong> (<em>boolean</em><em>, </em><em>optional</em>) – if false it skips the check on the consecutive ranges. Default True</p></li>
<li><p><strong>scaler</strong> – instance of a sklearn.preprocessing scaler. Default ‘StandardScaler()’</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>three dataloader used for training or inference</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[DataLoader,DataLoader,DataLoadtrainer]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dsipts.TimeSeries.train_model">
<span class="sig-name descname"><span class="pre">train_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dirpath</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">split_params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_workers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_epochs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">500</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">auto_lr_find</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gradient_clip_val</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gradient_clip_algorithm</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'value'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">devices</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'auto'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">precision</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">32</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">modifier</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">None</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">modifier_params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">None</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">42</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="headerlink" href="#dsipts.TimeSeries.train_model" title="Link to this definition">¶</a></dt>
<dd><p>Train the model</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dirpath</strong> (<em>str</em>) – path where to put all the useful things</p></li>
<li><p><strong>split_params</strong> (<em>dict</em>) – see <cite>split_for_train</cite></p></li>
<li><p><strong>batch_size</strong> (<em>int</em><em>, </em><em>optional</em>) – batch size. Defaults to 100.</p></li>
<li><p><strong>num_workers</strong> (<em>int</em><em>, </em><em>optional</em>) – num_workers for the dataloader. Defaults to 4.</p></li>
<li><p><strong>max_epochs</strong> (<em>int</em><em>, </em><em>optional</em>) – maximum epochs to perform. Defaults to 500.</p></li>
<li><p><strong>auto_lr_find</strong> (<em>bool</em><em>, </em><em>optional</em>) – find initial learning rate, see  <cite>pytorch-lightening</cite>. Defaults to True.</p></li>
<li><p><strong>gradient_clip_val</strong> (<em>Union</em><em>[</em><em>float</em><em>,</em><em>None</em><em>]</em><em>, </em><em>optional</em>) – gradient_clip_val. Defaults to None. See <a class="reference external" href="https://lightning.ai/docs/pytorch/stable/advanced/training_tricks.html">https://lightning.ai/docs/pytorch/stable/advanced/training_tricks.html</a></p></li>
<li><p><strong>gradient_clip_algorithm</strong> (<em>str</em><em>, </em><em>optional</em>) – gradient_clip_algorithm. Defaults to ‘norm ‘. See <a class="reference external" href="https://lightning.ai/docs/pytorch/stable/advanced/training_tricks.html">https://lightning.ai/docs/pytorch/stable/advanced/training_tricks.html</a></p></li>
<li><p><strong>devices</strong> (<em>Union</em><em>[</em><em>str</em><em>,</em><em>List</em><em>[</em><em>int</em><em>]</em><em>]</em><em>, </em><em>optional</em>) – devices to use. Use auto if cpu or the list of gpu to use otherwise. Defaults to ‘auto’.</p></li>
<li><p><strong>precision</strong> (<em>Union</em><em>[</em><em>str</em><em>,</em><em>int</em><em>]</em><em>, </em><em>optional</em>) – precision to use. Usually 32 bit is fine but for larger model you should try ‘bf16’. If ‘auto’ it will use bf16 for GPU and 32 for cpu</p></li>
<li><p><strong>modifier</strong> (<em>Union</em><em>[</em><em>str</em><em>,</em><em>int</em><em>]</em><em>, </em><em>optional</em>) – if not None a modifier is applyed to the dataloader. Sometimes lightening has very restrictive rules on the dataloader, or we want to use a ML model before or after the DL model (See readme for more information)</p></li>
<li><p><strong>modifier_params</strong> (<em>Union</em><em>[</em><em>dict</em><em>,</em><em>int</em><em>]</em><em>, </em><em>optional</em>) – parameters of the modifier</p></li>
<li><p><strong>seed</strong> (<em>int</em><em>, </em><em>optional</em>) – seed for reproducibility</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dsipts.TimeXER">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dsipts.</span></span><span class="sig-name descname"><span class="pre">TimeXER</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">patch_len</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_head</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d_ff</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">512</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout_rate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_layer_decoder</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">activation</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dsipts.TimeXER" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="dsipts.models.html#dsipts.models.base_v2.Base" title="dsipts.models.base_v2.Base"><code class="xref py py-class docutils literal notranslate"><span class="pre">Base</span></code></a></p>
<p>Initialize the model with specified parameters. <a class="reference external" href="https://github.com/thuml/Time-Series-Library/blob/main/models/TimeMixer.py">https://github.com/thuml/Time-Series-Library/blob/main/models/TimeMixer.py</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>patch_len</strong> (<em>int</em>) – Length of the patches.</p></li>
<li><p><strong>d_model</strong> (<em>int</em>) – Dimension of the model.</p></li>
<li><p><strong>n_head</strong> (<em>int</em>) – Number of attention heads.</p></li>
<li><p><strong>d_ff</strong> (<em>int</em><em>, </em><em>optional</em>) – Dimension of the feedforward network. Defaults to 512.</p></li>
<li><p><strong>dropout_rate</strong> (<em>float</em><em>, </em><em>optional</em>) – Dropout rate for regularization. Defaults to 0.1.</p></li>
<li><p><strong>n_layer_decoder</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of layers in the decoder. Defaults to 1.</p></li>
<li><p><strong>activation</strong> (<em>str</em><em>, </em><em>optional</em>) – Activation function to use. Defaults to ‘’.</p></li>
<li><p><strong>**kwargs</strong> – Additional keyword arguments passed to the superclass.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If an invalid activation function is provided.</p>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="dsipts.TimeXER.description">
<span class="sig-name descname"><span class="pre">description</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'Can</span>&#160;&#160; <span class="pre">handle</span> <span class="pre">multivariate</span> <span class="pre">output</span> <span class="pre">\nCan</span>&#160;&#160; <span class="pre">handle</span> <span class="pre">future</span> <span class="pre">covariates\nCan</span>&#160;&#160; <span class="pre">handle</span> <span class="pre">categorical</span> <span class="pre">covariates\nCan</span>&#160;&#160; <span class="pre">handle</span> <span class="pre">Quantile</span> <span class="pre">loss</span> <span class="pre">function'</span></em><a class="headerlink" href="#dsipts.TimeXER.description" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dsipts.TimeXER.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="headerlink" href="#dsipts.TimeXER.forward" title="Link to this definition">¶</a></dt>
<dd><p>Forlward method used during the training loop</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>batch</strong> (<em>dict</em>) – the batch structure. The keys are:
y : the target variable(s). This is always present
x_num_past: the numerical past variables. This is always present
x_num_future: the numerical future variables
x_cat_past: the categorical past variables
x_cat_future: the categorical future variables
idx_target: index of target features in the past array</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>output of the mode;</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dsipts.TimeXER.handle_categorical_variables">
<span class="sig-name descname"><span class="pre">handle_categorical_variables</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#dsipts.TimeXER.handle_categorical_variables" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dsipts.TimeXER.handle_future_covariates">
<span class="sig-name descname"><span class="pre">handle_future_covariates</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#dsipts.TimeXER.handle_future_covariates" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dsipts.TimeXER.handle_multivariate">
<span class="sig-name descname"><span class="pre">handle_multivariate</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#dsipts.TimeXER.handle_multivariate" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dsipts.TimeXER.handle_quantile_loss">
<span class="sig-name descname"><span class="pre">handle_quantile_loss</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#dsipts.TimeXER.handle_quantile_loss" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dsipts.VQVAEA">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dsipts.</span></span><span class="sig-name descname"><span class="pre">VQVAEA</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">past_steps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">future_steps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">past_channels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">future_channels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hidden_channels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">embs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_voc_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_layers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout_rate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">commitment_cost</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decay</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_heads</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_channels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epoch_vqvae</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">persistence_weight</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'l1'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quantiles</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optim_config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scheduler_config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dsipts.VQVAEA" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="dsipts.models.html#dsipts.models.base_v2.Base" title="dsipts.models.base_v2.Base"><code class="xref py py-class docutils literal notranslate"><span class="pre">Base</span></code></a></p>
<p>Custom encoder-decoder</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>past_steps</strong> (<em>int</em>) – number of past datapoints used</p></li>
<li><p><strong>future_steps</strong> (<em>int</em>) – number of future lag to predict</p></li>
<li><p><strong>past_channels</strong> (<em>int</em>) – number of numeric past variables, must be &gt;0</p></li>
<li><p><strong>future_channels</strong> (<em>int</em>) – number of future numeric variables</p></li>
<li><p><strong>embs</strong> (<em>List</em>) – list of the initial dimension of the categorical variables</p></li>
<li><p><strong>cat_emb_dim</strong> (<em>int</em>) – final dimension of each categorical variable</p></li>
<li><p><strong>hidden_RNN</strong> (<em>int</em>) – hidden size of the RNN block</p></li>
<li><p><strong>num_layers_RNN</strong> (<em>int</em>) – number of RNN layers</p></li>
<li><p><strong>kind</strong> (<em>str</em>) – one among GRU or LSTM</p></li>
<li><p><strong>kernel_size</strong> (<em>int</em>) – kernel size in the encoder convolutional block</p></li>
<li><p><strong>sum_emb</strong> (<em>bool</em>) – if true the contribution of each embedding will be summed-up otherwise stacked</p></li>
<li><p><strong>out_channels</strong> (<em>int</em>) – number of output channels</p></li>
<li><p><strong>activation</strong> (<em>str</em><em>, </em><em>optional</em>) – activation fuction function pytorch. Default torch.nn.ReLU</p></li>
<li><p><strong>remove_last</strong> (<em>bool</em><em>, </em><em>optional</em>) – if True the model learns the difference respect to the last seen point</p></li>
<li><p><strong>persistence_weight</strong> (<em>float</em>) – weight controlling the divergence from persistence model. Default 0</p></li>
<li><p><strong>loss_type</strong> (<em>str</em><em>, </em><em>optional</em>) – this model uses custom losses or l1 or mse. Custom losses can be linear_penalization or exponential_penalization. Default l1,</p></li>
<li><p><strong>quantiles</strong> (<em>List</em><em>[</em><em>int</em><em>]</em><em>, </em><em>optional</em>) – we can use quantile loss il len(quantiles) = 0 (usually 0.1,0.5, 0.9) or L1loss in case len(quantiles)==0. Defaults to [].</p></li>
<li><p><strong>dropout_rate</strong> (<em>float</em><em>, </em><em>optional</em>) – dropout rate in Dropout layers</p></li>
<li><p><strong>use_bn</strong> (<em>bool</em><em>, </em><em>optional</em>) – if true BN layers will be added and dropouts will be removed</p></li>
<li><p><strong>use_glu</strong> (<em>bool</em><em>,</em><em>optional</em>) – use GLU for feature selection. Defaults to True.</p></li>
<li><p><strong>glu_percentage</strong> (<em>float</em><em>, </em><em>optiona</em>) – percentage of features to use. Defaults to 1.0.</p></li>
<li><p><strong>n_classes</strong> (<em>int</em>) – number of classes (0 in regression)</p></li>
<li><p><strong>optim</strong> (<em>str</em><em>, </em><em>optional</em>) – if not None it expects a pytorch optim method. Defaults to None that is mapped to Adam.</p></li>
<li><p><strong>optim_config</strong> (<em>dict</em><em>, </em><em>optional</em>) – configuration for Adam optimizer. Defaults to None.</p></li>
<li><p><strong>scheduler_config</strong> (<em>dict</em><em>, </em><em>optional</em>) – configuration for stepLR scheduler. Defaults to None.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="dsipts.VQVAEA.description">
<span class="sig-name descname"><span class="pre">description</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'Can</span> <span class="pre">NOT</span>&#160; <span class="pre">handle</span> <span class="pre">multivariate</span> <span class="pre">output</span> <span class="pre">\nCan</span> <span class="pre">NOT</span>&#160; <span class="pre">handle</span> <span class="pre">future</span> <span class="pre">covariates\nCan</span> <span class="pre">NOT</span>&#160; <span class="pre">handle</span> <span class="pre">categorical</span> <span class="pre">covariates\nCan</span> <span class="pre">NOT</span>&#160; <span class="pre">handle</span> <span class="pre">Quantile</span> <span class="pre">loss</span> <span class="pre">function'</span></em><a class="headerlink" href="#dsipts.VQVAEA.description" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dsipts.VQVAEA.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dsipts.VQVAEA.forward" title="Link to this definition">¶</a></dt>
<dd><p>Forlward method used during the training loop</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>batch</strong> (<em>dict</em>) – the batch structure. The keys are:
y : the target variable(s). This is always present
x_num_past: the numerical past variables. This is always present
x_num_future: the numerical future variables
x_cat_past: the categorical past variables
x_cat_future: the categorical future variables
idx_target: index of target features in the past array</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>output of the mode;</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dsipts.VQVAEA.generate">
<span class="sig-name descname"><span class="pre">generate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_new_tokens</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temperature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do_sample</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">top_k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_samples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dsipts.VQVAEA.generate" title="Link to this definition">¶</a></dt>
<dd><p>Take a conditioning sequence of indices idx (LongTensor of shape (b,t)) and complete
the sequence max_new_tokens times, feeding the predictions back into the model each time.
Most likely you’ll want to make sure to be in model.eval() mode of operation for this.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dsipts.VQVAEA.gpt">
<span class="sig-name descname"><span class="pre">gpt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tokens</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dsipts.VQVAEA.gpt" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dsipts.VQVAEA.handle_categorical_variables">
<span class="sig-name descname"><span class="pre">handle_categorical_variables</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#dsipts.VQVAEA.handle_categorical_variables" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dsipts.VQVAEA.handle_future_covariates">
<span class="sig-name descname"><span class="pre">handle_future_covariates</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#dsipts.VQVAEA.handle_future_covariates" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dsipts.VQVAEA.handle_multivariate">
<span class="sig-name descname"><span class="pre">handle_multivariate</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#dsipts.VQVAEA.handle_multivariate" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dsipts.VQVAEA.handle_quantile_loss">
<span class="sig-name descname"><span class="pre">handle_quantile_loss</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#dsipts.VQVAEA.handle_quantile_loss" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dsipts.VQVAEA.inference">
<span class="sig-name descname"><span class="pre">inference</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tensor</span></span></span><a class="headerlink" href="#dsipts.VQVAEA.inference" title="Link to this definition">¶</a></dt>
<dd><p>Usually it is ok to return the output of the forward method but sometimes not (e.g. RNN)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>batch</strong> (<em>dict</em>) – batch</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>result</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.tensor</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dsipts.VVA">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dsipts.</span></span><span class="sig-name descname"><span class="pre">VVA</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">past_steps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">future_steps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">past_channels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">future_channels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">embs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_voc_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">token_split</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_layers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout_rate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_heads</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_channels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">persistence_weight</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'l1'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quantiles</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optim_config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scheduler_config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dsipts.VVA" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="dsipts.models.html#dsipts.models.base_v2.Base" title="dsipts.models.base_v2.Base"><code class="xref py py-class docutils literal notranslate"><span class="pre">Base</span></code></a></p>
<p>Custom encoder-decoder</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>past_steps</strong> (<em>int</em>) – number of past datapoints used</p></li>
<li><p><strong>future_steps</strong> (<em>int</em>) – number of future lag to predict</p></li>
<li><p><strong>past_channels</strong> (<em>int</em>) – number of numeric past variables, must be &gt;0</p></li>
<li><p><strong>future_channels</strong> (<em>int</em>) – number of future numeric variables</p></li>
<li><p><strong>embs</strong> (<em>List</em>) – list of the initial dimension of the categorical variables</p></li>
<li><p><strong>cat_emb_dim</strong> (<em>int</em>) – final dimension of each categorical variable</p></li>
<li><p><strong>hidden_RNN</strong> (<em>int</em>) – hidden size of the RNN block</p></li>
<li><p><strong>num_layers_RNN</strong> (<em>int</em>) – number of RNN layers</p></li>
<li><p><strong>kind</strong> (<em>str</em>) – one among GRU or LSTM</p></li>
<li><p><strong>kernel_size</strong> (<em>int</em>) – kernel size in the encoder convolutional block</p></li>
<li><p><strong>sum_emb</strong> (<em>bool</em>) – if true the contribution of each embedding will be summed-up otherwise stacked</p></li>
<li><p><strong>out_channels</strong> (<em>int</em>) – number of output channels</p></li>
<li><p><strong>activation</strong> (<em>str</em><em>, </em><em>optional</em>) – activation fuction function pytorch. Default torch.nn.ReLU</p></li>
<li><p><strong>remove_last</strong> (<em>bool</em><em>, </em><em>optional</em>) – if True the model learns the difference respect to the last seen point</p></li>
<li><p><strong>persistence_weight</strong> (<em>float</em>) – weight controlling the divergence from persistence model. Default 0</p></li>
<li><p><strong>loss_type</strong> (<em>str</em><em>, </em><em>optional</em>) – this model uses custom losses or l1 or mse. Custom losses can be linear_penalization or exponential_penalization. Default l1,</p></li>
<li><p><strong>quantiles</strong> (<em>List</em><em>[</em><em>int</em><em>]</em><em>, </em><em>optional</em>) – we can use quantile loss il len(quantiles) = 0 (usually 0.1,0.5, 0.9) or L1loss in case len(quantiles)==0. Defaults to [].</p></li>
<li><p><strong>dropout_rate</strong> (<em>float</em><em>, </em><em>optional</em>) – dropout rate in Dropout layers</p></li>
<li><p><strong>use_bn</strong> (<em>bool</em><em>, </em><em>optional</em>) – if true BN layers will be added and dropouts will be removed</p></li>
<li><p><strong>use_glu</strong> (<em>bool</em><em>,</em><em>optional</em>) – use GLU for feature selection. Defaults to True.</p></li>
<li><p><strong>glu_percentage</strong> (<em>float</em><em>, </em><em>optiona</em>) – percentage of features to use. Defaults to 1.0.</p></li>
<li><p><strong>n_classes</strong> (<em>int</em>) – number of classes (0 in regression)</p></li>
<li><p><strong>optim</strong> (<em>str</em><em>, </em><em>optional</em>) – if not None it expects a pytorch optim method. Defaults to None that is mapped to Adam.</p></li>
<li><p><strong>optim_config</strong> (<em>dict</em><em>, </em><em>optional</em>) – configuration for Adam optimizer. Defaults to None.</p></li>
<li><p><strong>scheduler_config</strong> (<em>dict</em><em>, </em><em>optional</em>) – configuration for stepLR scheduler. Defaults to None.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="dsipts.VVA.configure_optimizers">
<span class="sig-name descname"><span class="pre">configure_optimizers</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#dsipts.VVA.configure_optimizers" title="Link to this definition">¶</a></dt>
<dd><p>This long function is unfortunately doing something very simple and is being very defensive:
We are separating out all parameters of the model into two buckets: those that will experience
weight decay for regularization and those that won’t (biases, and layernorm/embedding weights).
We are then returning the PyTorch optimizer object.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dsipts.VVA.description">
<span class="sig-name descname"><span class="pre">description</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'Can</span> <span class="pre">NOT</span>&#160; <span class="pre">handle</span> <span class="pre">multivariate</span> <span class="pre">output</span> <span class="pre">\nCan</span> <span class="pre">NOT</span>&#160; <span class="pre">handle</span> <span class="pre">future</span> <span class="pre">covariates\nCan</span> <span class="pre">NOT</span>&#160; <span class="pre">handle</span> <span class="pre">categorical</span> <span class="pre">covariates\nCan</span> <span class="pre">NOT</span>&#160; <span class="pre">handle</span> <span class="pre">Quantile</span> <span class="pre">loss</span> <span class="pre">function'</span></em><a class="headerlink" href="#dsipts.VVA.description" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dsipts.VVA.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dsipts.VVA.forward" title="Link to this definition">¶</a></dt>
<dd><p>Forlward method used during the training loop</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>batch</strong> (<em>dict</em>) – the batch structure. The keys are:
y : the target variable(s). This is always present
x_num_past: the numerical past variables. This is always present
x_num_future: the numerical future variables
x_cat_past: the categorical past variables
x_cat_future: the categorical future variables
idx_target: index of target features in the past array</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>output of the mode;</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dsipts.VVA.generate">
<span class="sig-name descname"><span class="pre">generate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_new_tokens</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temperature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do_sample</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">top_k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_samples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dsipts.VVA.generate" title="Link to this definition">¶</a></dt>
<dd><p>Take a conditioning sequence of indices idx (LongTensor of shape (b,t)) and complete
the sequence max_new_tokens times, feeding the predictions back into the model each time.
Most likely you’ll want to make sure to be in model.eval() mode of operation for this.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dsipts.VVA.handle_categorical_variables">
<span class="sig-name descname"><span class="pre">handle_categorical_variables</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#dsipts.VVA.handle_categorical_variables" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dsipts.VVA.handle_future_covariates">
<span class="sig-name descname"><span class="pre">handle_future_covariates</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#dsipts.VVA.handle_future_covariates" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dsipts.VVA.handle_multivariate">
<span class="sig-name descname"><span class="pre">handle_multivariate</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#dsipts.VVA.handle_multivariate" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dsipts.VVA.handle_quantile_loss">
<span class="sig-name descname"><span class="pre">handle_quantile_loss</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#dsipts.VVA.handle_quantile_loss" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dsipts.VVA.inference">
<span class="sig-name descname"><span class="pre">inference</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tensor</span></span></span><a class="headerlink" href="#dsipts.VVA.inference" title="Link to this definition">¶</a></dt>
<dd><p>Usually it is ok to return the output of the forward method but sometimes not (e.g. RNN)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>batch</strong> (<em>dict</em>) – batch</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>result</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.tensor</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dsipts.beauty_string">
<span class="sig-prename descclassname"><span class="pre">dsipts.</span></span><span class="sig-name descname"><span class="pre">beauty_string</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">message</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dsipts.beauty_string" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dsipts.extend_time_df">
<span class="sig-prename descclassname"><span class="pre">dsipts.</span></span><span class="sig-name descname"><span class="pre">extend_time_df</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">freq</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">group</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">global_minmax</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="headerlink" href="#dsipts.extend_time_df" title="Link to this definition">¶</a></dt>
<dd><p>Utility for generating a full dataset and then merge the real data</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>pd.DataFrame</em>) – dataframe containing the column time</p></li>
<li><p><strong>freq</strong> (<em>str</em>) – frequency (in pandas notation) of the resulting dataframe</p></li>
<li><p><strong>group</strong> (<em>string</em><em> or </em><em>None</em>) – if not None the min max are computed by the group column, default None</p></li>
<li><p><strong>global_minmax</strong> (<em>bool</em>) – if True the min_max is computed globally for each group. Usually used for stacked model</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a dataframe with the column time ranging from thr minumum of x to the maximum with frequency <cite>freq</cite></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dsipts.get_freq">
<span class="sig-prename descclassname"><span class="pre">dsipts.</span></span><span class="sig-name descname"><span class="pre">get_freq</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freq</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="headerlink" href="#dsipts.get_freq" title="Link to this definition">¶</a></dt>
<dd><p>Get the frequency based on the string reported. I don’t think there are all the possibilities here</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>freq</strong> (<em>str</em>) – string coming from</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>pandas frequency format</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dsipts.read_public_dataset">
<span class="sig-prename descclassname"><span class="pre">dsipts.</span></span><span class="sig-name descname"><span class="pre">read_public_dataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">DataFrame</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#dsipts.read_public_dataset" title="Link to this definition">¶</a></dt>
<dd><p>Returns the public dataset chosen. Pleas download the dataset from here <a class="reference external" href="https://drive.google.com/drive/folders/1ZOYpTUa82_jCcxIdTmyr0LXQfvaM9vIy">https://drive.google.com/drive/folders/1ZOYpTUa82_jCcxIdTmyr0LXQfvaM9vIy</a> or ask to <a class="reference external" href="mailto:agobbi&#37;&#52;&#48;fbk&#46;eu">agobbi<span>&#64;</span>fbk<span>&#46;</span>eu</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>path</strong> (<em>str</em>) – path to data</p></li>
<li><p><strong>dataset</strong> (<em>str</em>) – dataset (one of ‘electricity’,’etth1’,’etth2’,’ettm1’,’ettm2’,’exchange_rate’,’illness’,’traffic’,’weather’)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The target variable is <em>y</em> and the time index is <em>time</em> and the list of the covariates</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[pd.DataFrame,List[str]]</p>
</dd>
</dl>
</dd></dl>

</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">DSIPTS</a></h1>









<search id="searchbox" style="display: none" role="search">
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" placeholder="Search"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script><h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="api.html">API Reference</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 8.2.3</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 1.0.0</a>
      
      |
      <a href="_sources/dsipts.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>