<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>dsipts.models.ttm package &#8212; DSIPTS 1.1.10 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=5ecbeea2" />
    <link rel="stylesheet" type="text/css" href="_static/basic.css?v=b08954a9" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css?v=27fed22d" />
    <script src="_static/documentation_options.js?v=25b84aaa"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="dsipts-models-ttm-package">
<h1>dsipts.models.ttm package<a class="headerlink" href="#dsipts-models-ttm-package" title="Link to this heading">¶</a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Link to this heading">¶</a></h2>
</section>
<section id="module-dsipts.models.ttm.configuration_tinytimemixer">
<span id="dsipts-models-ttm-configuration-tinytimemixer-module"></span><h2>dsipts.models.ttm.configuration_tinytimemixer module<a class="headerlink" href="#module-dsipts.models.ttm.configuration_tinytimemixer" title="Link to this heading">¶</a></h2>
<p>TinyTimeMixer model configuration</p>
<dl class="py class">
<dt class="sig sig-object py" id="dsipts.models.ttm.configuration_tinytimemixer.TinyTimeMixerConfig">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dsipts.models.ttm.configuration_tinytimemixer.</span></span><span class="sig-name descname"><span class="pre">TinyTimeMixerConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">context_length</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patch_length</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_input_channels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prediction_length</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">16</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patch_stride</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prediction_channel_indices</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exogenous_channel_indices</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">16</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">expansion_factor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_layers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'common_channel'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gated_attn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_mlp</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'LayerNorm'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">self_attn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">self_attn_heads</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_positional_encoding</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">positional_encoding_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'sincos'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scaling</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'std'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'mse'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_std</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.02</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">post_init</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_eps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1e-05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adaptive_patching_levels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resolution_prefix_tuning</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frequency_token_vocab_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">head_dropout</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distribution_output</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'student_t'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_parallel_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decoder_num_layers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decoder_d_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decoder_adaptive_patching_levels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decoder_raw_residual</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decoder_mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'common_channel'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_decoder</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enable_forecast_channel_mixing</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fcm_gated_attn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fcm_context_length</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fcm_use_mixer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fcm_mix_layers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fcm_prepend_past</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fcm_prepend_past_offset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">categorical_vocab_size_list</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prediction_filter_length</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_linear</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'pytorch'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_embed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'pytorch'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quantile</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">huber_delta</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask_value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dsipts.models.ttm.configuration_tinytimemixer.TinyTimeMixerConfig" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">PretrainedConfig</span></code></p>
<p>This is the configuration class to store the configuration of a [<cite>TinyTimeMixerModel</cite>]. It is used to instantiate a
TinyTimeMixer model according to the specified arguments, defining the model architecture. Instantiating a
configuration with the defaults will yield a similar configuration to that of the TinyTimeMixer {} architecture.</p>
<p>Configuration objects inherit from [<cite>PretrainedConfig</cite>] and can be used to control the model outputs. Read the
documentation from [<cite>PretrainedConfig</cite>] for more information.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>context_length</strong> (<cite>int</cite>, <em>optional</em>, defaults to 64) – The context/history length for the input sequence.</p></li>
<li><p><strong>patch_length</strong> (<cite>int</cite>, <em>optional</em>, defaults to 8) – The patch length for the input sequence.</p></li>
<li><p><strong>num_input_channels</strong> (<cite>int</cite>) – Number of input variates. For Univariate, set it to 1.</p></li>
<li><p><strong>patch_stride</strong> (<cite>int</cite>, <em>optional</em>, defaults to 8) – Amount of points to stride. If its value is same as patch_length, we get non-overlapping patches.</p></li>
<li><p><strong>d_model</strong> (<cite>int</cite>, <em>optional</em>, defaults to 16) – Hidden feature size of the model.</p></li>
<li><p><strong>prediction_length</strong> (<cite>int</cite>, <em>optional</em>, defaults to 16) – Number of time steps to forecast for a forecasting task. Also known as the Forecast Horizon.</p></li>
<li><p><strong>num_parallel_samples</strong> (<cite>int</cite>, <em>optional</em>, defaults to 100) – The number of samples to generate in parallel for probabilistic forecast.</p></li>
<li><p><strong>expansion_factor</strong> (<cite>int</cite>, <em>optional</em>, defaults to 2) – Expansion factor to use inside MLP. Recommended range is 2-5. Larger value indicates more complex model.</p></li>
<li><p><strong>num_layers</strong> (<cite>int</cite>, <em>optional</em>, defaults to 3) – Number of layers to use. Recommended range is 3-15. Larger value indicates more complex model.</p></li>
<li><p><strong>dropout</strong> (<cite>float</cite>, <em>optional</em>, defaults to 0.2) – The dropout probability the <cite>TinyTimeMixer</cite> backbone. Recommended range is 0.2-0.7</p></li>
<li><p><strong>mode</strong> (<cite>str</cite>, <em>optional</em>, defaults to <cite>“common_channel”</cite>) – Mixer Mode. Determines how to process the channels. Allowed values: “common_channel”, “mix_channel”. In
“common_channel” mode, we follow Channel-independent modelling with no explicit channel-mixing. Channel
mixing happens in an implicit manner via shared weights across channels. (preferred first approach) In
“mix_channel” mode, we follow explicit channel-mixing in addition to patch and feature mixer. (preferred
approach when channel correlations are very important to model)</p></li>
<li><p><strong>gated_attn</strong> (<cite>bool</cite>, <em>optional</em>, defaults to <cite>True</cite>) – Enable Gated Attention.</p></li>
<li><p><strong>norm_mlp</strong> (<cite>str</cite>, <em>optional</em>, defaults to <cite>“LayerNorm”</cite>) – Normalization layer (BatchNorm or LayerNorm).</p></li>
<li><p><strong>self_attn</strong> (<cite>bool</cite>, <em>optional</em>, defaults to <cite>False</cite>) – Enable Tiny self attention across patches. This can be enabled when the output of Vanilla TinyTimeMixer with
gated attention is not satisfactory. Enabling this leads to explicit pair-wise attention and modelling
across patches.</p></li>
<li><p><strong>self_attn_heads</strong> (<cite>int</cite>, <em>optional</em>, defaults to 1) – Number of self-attention heads. Works only when <cite>self_attn</cite> is set to <cite>True</cite>.</p></li>
<li><p><strong>use_positional_encoding</strong> (<cite>bool</cite>, <em>optional</em>, defaults to <cite>False</cite>) – Enable the use of positional embedding for the tiny self-attention layers. Works only when <cite>self_attn</cite> is
set to <cite>True</cite>.</p></li>
<li><p><strong>positional_encoding_type</strong> (<cite>str</cite>, <em>optional</em>, defaults to <cite>“sincos”</cite>) – Positional encodings. Options <cite>“random”</cite> and <cite>“sincos”</cite> are supported. Works only when
<cite>use_positional_encoding</cite> is set to <cite>True</cite></p></li>
<li><p><strong>scaling</strong> (<cite>string</cite> or <cite>bool</cite>, <em>optional</em>, defaults to <cite>“std”</cite>) – Whether to scale the input targets via “mean” scaler, “std” scaler or no scaler if <cite>None</cite>. If <cite>True</cite>, the
scaler is set to “mean”.</p></li>
<li><p><strong>loss</strong> (<cite>string</cite>, <em>optional</em>, defaults to <cite>“mse”</cite>) – The loss function to finetune or pretrain the the model. Allowed values are “mse” or “mae” or “pinball” or “huber”.
Use pinball loss for probabilistic forecasts of different quantiles.
Distribution head (nll) is currently disabled and not allowed.</p></li>
<li><p><strong>init_std</strong> (<cite>float</cite>, <em>optional</em>, defaults to 0.02) – The standard deviation of the truncated normal weight initialization distribution.</p></li>
<li><p><strong>post_init</strong> (<cite>bool</cite>, <em>optional</em>, defaults to <cite>False</cite>) – Whether to use custom weight initialization from <cite>transformers</cite> library, or the default initialization in
<cite>PyTorch</cite>. Setting it to <cite>False</cite> performs <cite>PyTorch</cite> weight initialization.</p></li>
<li><p><strong>norm_eps</strong> (<cite>float</cite>, <em>optional</em>, defaults to 1e-05) – A value added to the denominator for numerical stability of normalization.</p></li>
<li><p><strong>adaptive_patching_levels</strong> (<cite>int</cite>, <em>optional</em>, defaults to 0) – <p>If adaptive_patching_levels is i, then we will have i levels with each level having n_layers.
Level id starts with 0. num_patches at level i will be multipled by (2^i) and num_features at level i will be divided by (2^i).
For Ex. if adaptive_patching_levels is 3 - then we will have 3 levels:</p>
<blockquote>
<div><p>level 2: num_features//(2^2), num_patches*(2^2)
level 1: num_features//(2^1), num_patches*(2^1)
level 0: num_features//(2^0), num_patches*(2^0)</p>
</div></blockquote>
<p>adaptive_patching_levels = 1 is same as one level PatchTSMixer. This module gets disabled when adaptive_patching_levels is 0 or neg value. Defaults to 0 (off mode).</p>
</p></li>
<li><p><strong>resolution_prefix_tuning</strong> (<cite>bool</cite>, <em>optional</em>, defaults to <cite>False</cite>) – Enable if your dataloader has time resolution information as defined in <cite>get_freq_mapping</cite> function in <cite>modelling_tinytimemixer</cite>.</p></li>
<li><p><strong>frequency_token_vocab_size</strong> (<cite>int</cite>, <em>optional</em>, defaults to 5) – Vocab size to use when resolution_prefix_tuning is enabled.</p></li>
<li><p><strong>head_dropout</strong> (<cite>float</cite>, <em>optional</em>, defaults to 0.2) – The dropout probability the <cite>TinyTimeMixer</cite> head.</p></li>
<li><p><strong>distribution_output</strong> (<cite>string</cite>, <em>optional</em>, defaults to <cite>“student_t”</cite>) – The distribution emission head for the model when loss is “nll”. Could be either “student_t”, “normal” or
“negative_binomial”.</p></li>
<li><p><strong>prediction_channel_indices</strong> (<cite>list</cite>, <em>optional</em>) – List of channel indices to forecast. If None, forecast all channels. Target data is expected to have all
channels and we explicitly filter the channels in prediction and target before loss computation. Please provide the indices
in sorted ascending order.</p></li>
<li><p><strong>exogenous_channel_indices</strong> (<cite>list</cite>, <em>optional</em>) – List of channel indices whose values are known in the forecast period. Please provide the indices
in sorted ascending order.</p></li>
<li><p><strong>decoder_num_layers</strong> (<cite>int</cite>, <em>optional</em>, defaults to 8) – Number of layers to use in decoder</p></li>
<li><p><strong>decoder_d_model</strong> (<cite>int</cite>, <em>optional</em>, defaults to 16) – Defines the hidden feature size of the decoder.</p></li>
<li><p><strong>decoder_adaptive_patching_levels</strong> (<cite>int</cite>, <em>optional</em>, defaults to 0) – Adaptive Patching levels for decoder. Preferable to set it to 0 for decoder to keep it light weight.</p></li>
<li><p><strong>decoder_raw_residual</strong> (<cite>bool</cite>, <em>optional</em>, defaults to <cite>False</cite>) – Flag to enable merging of raw embedding with encoder embedding for decoder input. Defaults to False.</p></li>
<li><p><strong>decoder_mode</strong> (<cite>string</cite>, <em>optional</em>, defaults to <cite>“common_channel”</cite>) – Decoder channel mode. Use <cite>“common_channel” for channel-independent modelling and `”mix_channel”</cite> for channel-mixing modelling</p></li>
<li><p><strong>use_decoder</strong> (<cite>bool</cite>, <em>optional</em>, defaults to <cite>True</cite>) – Enable to use decoder.</p></li>
<li><p><strong>enable_forecast_channel_mixing</strong> (<cite>bool</cite>, <em>optional</em>, defaults to <cite>False</cite>) – Enable if we want to reconcile forecasts across all channels and also to enable exogenous infusion, if you have them.</p></li>
<li><p><strong>fcm_gated_attn</strong> (<cite>bool</cite>, <em>optional</em>, defaults to <cite>True</cite>) – Enable gated attention in forecast channel mixing block.</p></li>
<li><p><strong>fcm_context_length</strong> (<cite>int</cite>, <em>optional</em>, defaults to <a href="#id1"><span class="problematic" id="id2">`</span></a>1) – Surrounding context length to use. For Ex. If we want to consider 2 lag point before and after a data point, provide value 2 for <cite>fcm_context_length</cite></p></li>
<li><p><strong>fcm_use_mixer</strong> (<cite>bool</cite>, <em>optional</em>, defaults to <cite>True</cite>) – Enable Mixing in forecast channel mixing block.</p></li>
<li><p><strong>fcm_mix_layers</strong> (<cite>int</cite>, <em>optional</em>, defaults to 2) – Number of mixer layers to use if fcm_use_mixer is enabled</p></li>
<li><p><strong>fcm_prepend_past</strong> (<cite>bool</cite>, <em>optional</em>, defaults to <cite>True</cite>) – Prepend last context for forecast reconciliation</p></li>
<li><p><strong>fcm_prepend_past_offset</strong> (<cite>int</cite>, <em>optional</em>, defaults to None)</p></li>
<li><p><strong>categorical_vocab_size_list</strong> (<cite>list</cite>, <em>optional</em>) – List of vocab size for all the tokenized categorical variables to use. Pass it in the same order as used in the foreward call param <cite>static_categorical_values</cite>.</p></li>
<li><p><strong>prediction_filter_length</strong> (<cite>int</cite>,*optional*, defaults to None) – Actual length in the prediction output to use for loss calculations.</p></li>
</ul>
</dd>
</dl>
<p>Example:</p>
<p><a href="#id3"><span class="problematic" id="id4">``</span></a><a href="#id5"><span class="problematic" id="id6">`</span></a>python
&gt;&gt;&gt; from transformers import TinyTimeMixerConfig, TinyTimeMixerModel</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Initializing a default TinyTimeMixer configuration</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">configuration</span> <span class="o">=</span> <span class="n">TinyTimeMixerConfig</span><span class="p">()</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Randomly initializing a model (with random weights) from the configuration</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">TinyTimeMixerModel</span><span class="p">(</span><span class="n">configuration</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Accessing the model configuration</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">configuration</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">config</span>
<span class="go">```</span>
</pre></div>
</div>
<dl class="py attribute">
<dt class="sig sig-object py" id="dsipts.models.ttm.configuration_tinytimemixer.TinyTimeMixerConfig.attribute_map">
<span class="sig-name descname"><span class="pre">attribute_map</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'hidden_size':</span> <span class="pre">'d_model',</span> <span class="pre">'num_hidden_layers':</span> <span class="pre">'num_layers'}</span></em><a class="headerlink" href="#dsipts.models.ttm.configuration_tinytimemixer.TinyTimeMixerConfig.attribute_map" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dsipts.models.ttm.configuration_tinytimemixer.TinyTimeMixerConfig.check_and_init_preprocessing">
<span class="sig-name descname"><span class="pre">check_and_init_preprocessing</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#dsipts.models.ttm.configuration_tinytimemixer.TinyTimeMixerConfig.check_and_init_preprocessing" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dsipts.models.ttm.configuration_tinytimemixer.TinyTimeMixerConfig.model_type">
<span class="sig-name descname"><span class="pre">model_type</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'tinytimemixer'</span></em><a class="headerlink" href="#dsipts.models.ttm.configuration_tinytimemixer.TinyTimeMixerConfig.model_type" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-dsipts.models.ttm.consts">
<span id="dsipts-models-ttm-consts-module"></span><h2>dsipts.models.ttm.consts module<a class="headerlink" href="#module-dsipts.models.ttm.consts" title="Link to this heading">¶</a></h2>
</section>
<section id="module-dsipts.models.ttm.modeling_tinytimemixer">
<span id="dsipts-models-ttm-modeling-tinytimemixer-module"></span><h2>dsipts.models.ttm.modeling_tinytimemixer module<a class="headerlink" href="#module-dsipts.models.ttm.modeling_tinytimemixer" title="Link to this heading">¶</a></h2>
<p>PyTorch TinyTimeMixer model.</p>
<dl class="py class">
<dt class="sig sig-object py" id="dsipts.models.ttm.modeling_tinytimemixer.FeatureMixerBlock">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dsipts.models.ttm.modeling_tinytimemixer.</span></span><span class="sig-name descname"><span class="pre">FeatureMixerBlock</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#dsipts.models.ttm.configuration_tinytimemixer.TinyTimeMixerConfig" title="dsipts.models.ttm.configuration_tinytimemixer.TinyTimeMixerConfig"><span class="pre">TinyTimeMixerConfig</span></a></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dsipts.models.ttm.modeling_tinytimemixer.FeatureMixerBlock" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Initialize internal Module state, shared by both nn.Module and ScriptModule.</p>
<dl class="py method">
<dt class="sig sig-object py" id="dsipts.models.ttm.modeling_tinytimemixer.FeatureMixerBlock.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hidden</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dsipts.models.ttm.modeling_tinytimemixer.FeatureMixerBlock.forward" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>hidden</strong> (<cite>torch.Tensor</cite> of shape <cite>(batch_size, num_patches, d_model)</cite>) – Input tensor to the layer.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Transformed tensor.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><cite>torch.Tensor</cite></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dsipts.models.ttm.modeling_tinytimemixer.ForecastChannelHeadMixer">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dsipts.models.ttm.modeling_tinytimemixer.</span></span><span class="sig-name descname"><span class="pre">ForecastChannelHeadMixer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#dsipts.models.ttm.configuration_tinytimemixer.TinyTimeMixerConfig" title="dsipts.models.ttm.configuration_tinytimemixer.TinyTimeMixerConfig"><span class="pre">TinyTimeMixerConfig</span></a></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dsipts.models.ttm.modeling_tinytimemixer.ForecastChannelHeadMixer" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Initialize internal Module state, shared by both nn.Module and ScriptModule.</p>
<dl class="py method">
<dt class="sig sig-object py" id="dsipts.models.ttm.modeling_tinytimemixer.ForecastChannelHeadMixer.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">base_forecasts</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">past_values</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">future_values</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dsipts.models.ttm.modeling_tinytimemixer.ForecastChannelHeadMixer.forward" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>base_forecasts</strong> (<cite>torch.Tensor</cite> of shape <cite>(batch_size, prediction length, forecast_channels)</cite>) – Base Forecasts to reconcile</p></li>
<li><p><strong>past_values</strong> (<cite>torch.FloatTensor</cite> of shape <cite>(batch_size, seq_length, num_input_channels)</cite>)</p></li>
<li><p><strong>task</strong> (<em>Context values</em><em> of </em><em>the time series. For a forecasting</em>)</p></li>
<li><p><strong>values.</strong> (<em>this denotes the history/past time series</em>)</p></li>
<li><p><strong>series</strong> (<em>num_input_channels dimension should be 1. For multivariate time</em>)</p></li>
<li><p><strong>series</strong></p></li>
<li><p><strong>is</strong> (<em>it</em>)</p></li>
<li><p><strong>1.</strong> (<em>greater than</em>)</p></li>
<li><p><strong>future_values</strong> (<cite>torch.Tensor</cite> of shape <cite>(batch_size, prediction length, input_channels)</cite>, <em>optional</em>, Defaults to None) – Actual groundtruths of the forecasts. Pass dummy values (say 0) for forecast channels, if groundtruth is unknown.
Pass the correct values for Exogenous channels where the forecast values are known.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Updated forecasts of shape <cite>(batch_size, prediction length, forecast_channels)</cite></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><cite>torch.Tensor</cite></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dsipts.models.ttm.modeling_tinytimemixer.PatchMixerBlock">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dsipts.models.ttm.modeling_tinytimemixer.</span></span><span class="sig-name descname"><span class="pre">PatchMixerBlock</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#dsipts.models.ttm.configuration_tinytimemixer.TinyTimeMixerConfig" title="dsipts.models.ttm.configuration_tinytimemixer.TinyTimeMixerConfig"><span class="pre">TinyTimeMixerConfig</span></a></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dsipts.models.ttm.modeling_tinytimemixer.PatchMixerBlock" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Initialize internal Module state, shared by both nn.Module and ScriptModule.</p>
<dl class="py method">
<dt class="sig sig-object py" id="dsipts.models.ttm.modeling_tinytimemixer.PatchMixerBlock.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hidden_state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dsipts.models.ttm.modeling_tinytimemixer.PatchMixerBlock.forward" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>hidden_state</strong> (<cite>torch.Tensor</cite>) – Input tensor.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Transformed tensor.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><cite>torch.Tensor</cite></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dsipts.models.ttm.modeling_tinytimemixer.PinballLoss">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dsipts.models.ttm.modeling_tinytimemixer.</span></span><span class="sig-name descname"><span class="pre">PinballLoss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">quantile</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dsipts.models.ttm.modeling_tinytimemixer.PinballLoss" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Initialize the Pinball Loss for multidimensional tensors.</p>
<p>Args:
quantile (float): The desired quantile (e.g., 0.5 for median, 0.9 for 90th percentile).</p>
<dl class="py method">
<dt class="sig sig-object py" id="dsipts.models.ttm.modeling_tinytimemixer.PinballLoss.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">predictions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">targets</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dsipts.models.ttm.modeling_tinytimemixer.PinballLoss.forward" title="Link to this definition">¶</a></dt>
<dd><p>Compute the Pinball Loss for shape [b, seq_len, channels].</p>
<p>Args:
predictions (torch.Tensor): Predicted values, shape [b, seq_len, channels].
targets (torch.Tensor): Ground truth values, shape [b, seq_len, channels].</p>
<p>Returns:
torch.Tensor: The mean pinball loss over all dimensions.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dsipts.models.ttm.modeling_tinytimemixer.SampleTinyTimeMixerPredictionOutput">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dsipts.models.ttm.modeling_tinytimemixer.</span></span><span class="sig-name descname"><span class="pre">SampleTinyTimeMixerPredictionOutput</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sequences</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">FloatTensor</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dsipts.models.ttm.modeling_tinytimemixer.SampleTinyTimeMixerPredictionOutput" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">ModelOutput</span></code></p>
<p>Base class for time series model’s predictions outputs that contains the sampled values from the chosen
distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>sequences</strong> (<cite>torch.FloatTensor</cite> of shape <cite>(batch_size, num_samples, prediction_length, number_channels)</cite>) – Sampled values from the chosen distribution.</p>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="dsipts.models.ttm.modeling_tinytimemixer.SampleTinyTimeMixerPredictionOutput.sequences">
<span class="sig-name descname"><span class="pre">sequences</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">FloatTensor</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#dsipts.models.ttm.modeling_tinytimemixer.SampleTinyTimeMixerPredictionOutput.sequences" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dsipts.models.ttm.modeling_tinytimemixer.TinyTimeMixerAdaptivePatchingBlock">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dsipts.models.ttm.modeling_tinytimemixer.</span></span><span class="sig-name descname"><span class="pre">TinyTimeMixerAdaptivePatchingBlock</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#dsipts.models.ttm.configuration_tinytimemixer.TinyTimeMixerConfig" title="dsipts.models.ttm.configuration_tinytimemixer.TinyTimeMixerConfig"><span class="pre">TinyTimeMixerConfig</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">adapt_patch_level</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dsipts.models.ttm.modeling_tinytimemixer.TinyTimeMixerAdaptivePatchingBlock" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Initialize internal Module state, shared by both nn.Module and ScriptModule.</p>
<dl class="py method">
<dt class="sig sig-object py" id="dsipts.models.ttm.modeling_tinytimemixer.TinyTimeMixerAdaptivePatchingBlock.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hidden</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dsipts.models.ttm.modeling_tinytimemixer.TinyTimeMixerAdaptivePatchingBlock.forward" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>hidden</strong> (<cite>torch.Tensor</cite> of shape <cite>(batch_size x nvars x num_patch x d_model)</cite>) – Input tensor to the layer.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Transformed tensor.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><cite>torch.Tensor</cite></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dsipts.models.ttm.modeling_tinytimemixer.TinyTimeMixerAttention">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dsipts.models.ttm.modeling_tinytimemixer.</span></span><span class="sig-name descname"><span class="pre">TinyTimeMixerAttention</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">embed_dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_heads</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_decoder</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bias</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_causal</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#dsipts.models.ttm.configuration_tinytimemixer.TinyTimeMixerConfig" title="dsipts.models.ttm.configuration_tinytimemixer.TinyTimeMixerConfig"><span class="pre">TinyTimeMixerConfig</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dsipts.models.ttm.modeling_tinytimemixer.TinyTimeMixerAttention" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Initialize internal Module state, shared by both nn.Module and ScriptModule.</p>
<dl class="py method">
<dt class="sig sig-object py" id="dsipts.models.ttm.modeling_tinytimemixer.TinyTimeMixerAttention.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hidden_states</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key_value_states</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">past_key_value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attention_mask</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">layer_head_mask</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_attentions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#dsipts.models.ttm.modeling_tinytimemixer.TinyTimeMixerAttention.forward" title="Link to this definition">¶</a></dt>
<dd><p>Input shape: Batch x Time x Channel</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dsipts.models.ttm.modeling_tinytimemixer.TinyTimeMixerBatchNorm">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dsipts.models.ttm.modeling_tinytimemixer.</span></span><span class="sig-name descname"><span class="pre">TinyTimeMixerBatchNorm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#dsipts.models.ttm.configuration_tinytimemixer.TinyTimeMixerConfig" title="dsipts.models.ttm.configuration_tinytimemixer.TinyTimeMixerConfig"><span class="pre">TinyTimeMixerConfig</span></a></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dsipts.models.ttm.modeling_tinytimemixer.TinyTimeMixerBatchNorm" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Initialize internal Module state, shared by both nn.Module and ScriptModule.</p>
<dl class="py method">
<dt class="sig sig-object py" id="dsipts.models.ttm.modeling_tinytimemixer.TinyTimeMixerBatchNorm.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dsipts.models.ttm.modeling_tinytimemixer.TinyTimeMixerBatchNorm.forward" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>inputs</strong> (<cite>torch.Tensor</cite> of shape <cite>(batch_size, sequence_length, d_model)</cite>) – input for Batch norm calculation</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><cite>torch.Tensor</cite> of shape <cite>(batch_size, sequence_length, d_model)</cite></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dsipts.models.ttm.modeling_tinytimemixer.TinyTimeMixerBlock">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dsipts.models.ttm.modeling_tinytimemixer.</span></span><span class="sig-name descname"><span class="pre">TinyTimeMixerBlock</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#dsipts.models.ttm.configuration_tinytimemixer.TinyTimeMixerConfig" title="dsipts.models.ttm.configuration_tinytimemixer.TinyTimeMixerConfig"><span class="pre">TinyTimeMixerConfig</span></a></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dsipts.models.ttm.modeling_tinytimemixer.TinyTimeMixerBlock" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Initialize internal Module state, shared by both nn.Module and ScriptModule.</p>
<dl class="py method">
<dt class="sig sig-object py" id="dsipts.models.ttm.modeling_tinytimemixer.TinyTimeMixerBlock.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hidden_state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_hidden_states</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dsipts.models.ttm.modeling_tinytimemixer.TinyTimeMixerBlock.forward" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hidden_state</strong> (<cite>torch.Tensor</cite>) – The input tensor.</p></li>
<li><p><strong>output_hidden_states</strong> (<cite>bool</cite>, <em>optional</em>, defaults to False.) – Whether to output the hidden states as well.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The embedding. <cite>list</cite>: List of all hidden states if <cite>output_hidden_states</cite> is set to
<cite>True</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><cite>torch.Tensor</cite></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dsipts.models.ttm.modeling_tinytimemixer.TinyTimeMixerCategoricalEmbeddingLayer">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dsipts.models.ttm.modeling_tinytimemixer.</span></span><span class="sig-name descname"><span class="pre">TinyTimeMixerCategoricalEmbeddingLayer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#dsipts.models.ttm.configuration_tinytimemixer.TinyTimeMixerConfig" title="dsipts.models.ttm.configuration_tinytimemixer.TinyTimeMixerConfig"><span class="pre">TinyTimeMixerConfig</span></a></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dsipts.models.ttm.modeling_tinytimemixer.TinyTimeMixerCategoricalEmbeddingLayer" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Initialize internal Module state, shared by both nn.Module and ScriptModule.</p>
<dl class="py method">
<dt class="sig sig-object py" id="dsipts.models.ttm.modeling_tinytimemixer.TinyTimeMixerCategoricalEmbeddingLayer.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">static_categorical_values</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dsipts.models.ttm.modeling_tinytimemixer.TinyTimeMixerCategoricalEmbeddingLayer.forward" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>static_categorical_values</strong> (<cite>torch.FloatTensor</cite> of shape <cite>(batch_size, number_of_categorical_variables)</cite>)</p></li>
<li><p><strong>the</strong> (<em>Tokenized categorical values can be passed here. Ensure to pass in the same order as the vocab size list used in</em>)</p></li>
<li><p><strong>categorical_vocab_size_list</strong> (<em>TinyTimeMixerConfig param</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><cite>torch.Tensor</cite> of shape <cite>(batch_size, number_of_categorical_variables, num_patches, d_model)</cite></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dsipts.models.ttm.modeling_tinytimemixer.TinyTimeMixerChannelFeatureMixerBlock">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dsipts.models.ttm.modeling_tinytimemixer.</span></span><span class="sig-name descname"><span class="pre">TinyTimeMixerChannelFeatureMixerBlock</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#dsipts.models.ttm.configuration_tinytimemixer.TinyTimeMixerConfig" title="dsipts.models.ttm.configuration_tinytimemixer.TinyTimeMixerConfig"><span class="pre">TinyTimeMixerConfig</span></a></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dsipts.models.ttm.modeling_tinytimemixer.TinyTimeMixerChannelFeatureMixerBlock" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Initialize internal Module state, shared by both nn.Module and ScriptModule.</p>
<dl class="py method">
<dt class="sig sig-object py" id="dsipts.models.ttm.modeling_tinytimemixer.TinyTimeMixerChannelFeatureMixerBlock.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dsipts.models.ttm.modeling_tinytimemixer.TinyTimeMixerChannelFeatureMixerBlock.forward" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>inputs</strong> (<cite>torch.Tensor</cite> of shape <cite>((batch_size, num_channels, num_patches, d_model))</cite>) – input to the MLP layer</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><cite>torch.Tensor</cite> of the same shape as <cite>inputs</cite></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dsipts.models.ttm.modeling_tinytimemixer.TinyTimeMixerDecoder">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dsipts.models.ttm.modeling_tinytimemixer.</span></span><span class="sig-name descname"><span class="pre">TinyTimeMixerDecoder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#dsipts.models.ttm.configuration_tinytimemixer.TinyTimeMixerConfig" title="dsipts.models.ttm.configuration_tinytimemixer.TinyTimeMixerConfig"><span class="pre">TinyTimeMixerConfig</span></a></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dsipts.models.ttm.modeling_tinytimemixer.TinyTimeMixerDecoder" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Initialize internal Module state, shared by both nn.Module and ScriptModule.</p>
<dl class="py method">
<dt class="sig sig-object py" id="dsipts.models.ttm.modeling_tinytimemixer.TinyTimeMixerDecoder.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hidden_state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patch_input</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_hidden_states</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">static_categorical_values</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dsipts.models.ttm.modeling_tinytimemixer.TinyTimeMixerDecoder.forward" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hidden_state</strong> (<cite>torch.Tensor</cite> of shape <cite>(batch_size x nvars x num_patch x d_model)</cite>) – The input tensor from backbone.</p></li>
<li><p><strong>output_hidden_states</strong> (<cite>bool</cite>, <em>optional</em>, defaults to False.) – Whether to output the hidden states as well.</p></li>
<li><p><strong>static_categorical_values</strong> (<cite>torch.FloatTensor</cite> of shape <cite>(batch_size, number_of_categorical_variables)</cite>, <em>optional</em>)</p></li>
<li><p><strong>the</strong> (<em>Tokenized categorical values can be passed here. Ensure to pass in the same order as the vocab size list used in</em>)</p></li>
<li><p><strong>categorical_vocab_size_list</strong> (<em>TinyTimeMixerConfig param</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The embedding. <cite>list</cite>: List of all hidden states if <cite>output_hidden_states</cite> is set to
<cite>True</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><cite>torch.Tensor</cite></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dsipts.models.ttm.modeling_tinytimemixer.TinyTimeMixerEncoder">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dsipts.models.ttm.modeling_tinytimemixer.</span></span><span class="sig-name descname"><span class="pre">TinyTimeMixerEncoder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#dsipts.models.ttm.configuration_tinytimemixer.TinyTimeMixerConfig" title="dsipts.models.ttm.configuration_tinytimemixer.TinyTimeMixerConfig"><span class="pre">TinyTimeMixerConfig</span></a></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dsipts.models.ttm.modeling_tinytimemixer.TinyTimeMixerEncoder" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#dsipts.models.ttm.modeling_tinytimemixer.TinyTimeMixerPreTrainedModel" title="dsipts.models.ttm.modeling_tinytimemixer.TinyTimeMixerPreTrainedModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">TinyTimeMixerPreTrainedModel</span></code></a></p>
<p>Initialize internal Module state, shared by both nn.Module and ScriptModule.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="dsipts.models.ttm.modeling_tinytimemixer.TinyTimeMixerEncoder.config_class">
<span class="sig-name descname"><span class="pre">config_class</span></span><a class="headerlink" href="#dsipts.models.ttm.modeling_tinytimemixer.TinyTimeMixerEncoder.config_class" title="Link to this definition">¶</a></dt>
<dd><p>alias of <a class="reference internal" href="#dsipts.models.ttm.configuration_tinytimemixer.TinyTimeMixerConfig" title="dsipts.models.ttm.configuration_tinytimemixer.TinyTimeMixerConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">TinyTimeMixerConfig</span></code></a></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dsipts.models.ttm.modeling_tinytimemixer.TinyTimeMixerEncoder.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">past_values</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_hidden_states</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">freq_token</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#dsipts.models.ttm.modeling_tinytimemixer.TinyTimeMixerEncoderOutput" title="dsipts.models.ttm.modeling_tinytimemixer.TinyTimeMixerEncoderOutput"><span class="pre">TinyTimeMixerEncoderOutput</span></a></span></span><a class="headerlink" href="#dsipts.models.ttm.modeling_tinytimemixer.TinyTimeMixerEncoder.forward" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>past_values</strong> (<cite>torch.FloatTensor</cite> of shape <cite>(batch_size, seq_length, num_input_channels)</cite>) – Context values of the time series.
For univariate time series, <cite>num_input_channels</cite> dimension should be 1. For multivariate time series,
it is greater than 1.</p></li>
<li><p><strong>output_hidden_states</strong> (<cite>bool</cite>, <em>optional</em>) – Whether or not to return the hidden states of all layers.</p></li>
<li><p><strong>return_dict</strong> (<cite>bool</cite>, <em>optional</em>) – Whether or not to return a [<cite>~utils.ModelOutput</cite>] instead of a plain tuple.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><cite>torch.FloatTensor</cite> of shape <cite>(batch_size, n_vars, num_patches, d_model)</cite></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dsipts.models.ttm.modeling_tinytimemixer.TinyTimeMixerEncoderOutput">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dsipts.models.ttm.modeling_tinytimemixer.</span></span><span class="sig-name descname"><span class="pre">TinyTimeMixerEncoderOutput</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">last_hidden_state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">FloatTensor</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hidden_states</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">FloatTensor</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dsipts.models.ttm.modeling_tinytimemixer.TinyTimeMixerEncoderOutput" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">ModelOutput</span></code></p>
<p>Base class for <cite>TinyTimeMixerEncoderOutput</cite>, with potential hidden states.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>last_hidden_state</strong> (<cite>torch.FloatTensor</cite> of shape <cite>(batch_size, num_channels, num_patches, d_model)</cite>) – Hidden-state at the output of the last layer of the model.</p></li>
<li><p><strong>hidden_states</strong> (<cite>tuple(torch.FloatTensor)</cite>, <em>optional</em>) – Hidden-states of the model at the output of each layer.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="dsipts.models.ttm.modeling_tinytimemixer.TinyTimeMixerEncoderOutput.hidden_states">
<span class="sig-name descname"><span class="pre">hidden_states</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">FloatTensor</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#dsipts.models.ttm.modeling_tinytimemixer.TinyTimeMixerEncoderOutput.hidden_states" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dsipts.models.ttm.modeling_tinytimemixer.TinyTimeMixerEncoderOutput.last_hidden_state">
<span class="sig-name descname"><span class="pre">last_hidden_state</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">FloatTensor</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#dsipts.models.ttm.modeling_tinytimemixer.TinyTimeMixerEncoderOutput.last_hidden_state" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dsipts.models.ttm.modeling_tinytimemixer.TinyTimeMixerForMaskedPrediction">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dsipts.models.ttm.modeling_tinytimemixer.</span></span><span class="sig-name descname"><span class="pre">TinyTimeMixerForMaskedPrediction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#dsipts.models.ttm.configuration_tinytimemixer.TinyTimeMixerConfig" title="dsipts.models.ttm.configuration_tinytimemixer.TinyTimeMixerConfig"><span class="pre">TinyTimeMixerConfig</span></a></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dsipts.models.ttm.modeling_tinytimemixer.TinyTimeMixerForMaskedPrediction" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#dsipts.models.ttm.modeling_tinytimemixer.TinyTimeMixerForPrediction" title="dsipts.models.ttm.modeling_tinytimemixer.TinyTimeMixerForPrediction"><code class="xref py py-class docutils literal notranslate"><span class="pre">TinyTimeMixerForPrediction</span></code></a></p>
<p>Initialize internal Module state, shared by both nn.Module and ScriptModule.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="dsipts.models.ttm.modeling_tinytimemixer.TinyTimeMixerForMaskedPrediction.config_class">
<span class="sig-name descname"><span class="pre">config_class</span></span><a class="headerlink" href="#dsipts.models.ttm.modeling_tinytimemixer.TinyTimeMixerForMaskedPrediction.config_class" title="Link to this definition">¶</a></dt>
<dd><p>alias of <a class="reference internal" href="#dsipts.models.ttm.configuration_tinytimemixer.TinyTimeMixerConfig" title="dsipts.models.ttm.configuration_tinytimemixer.TinyTimeMixerConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">TinyTimeMixerConfig</span></code></a></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dsipts.models.ttm.modeling_tinytimemixer.TinyTimeMixerForMaskedPrediction.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">past_values</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">future_values</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">past_observed_mask</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">future_observed_mask</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_hidden_states</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_loss</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">freq_token</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">static_categorical_values</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metadata</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#dsipts.models.ttm.modeling_tinytimemixer.TinyTimeMixerForPredictionOutput" title="dsipts.models.ttm.modeling_tinytimemixer.TinyTimeMixerForPredictionOutput"><span class="pre">TinyTimeMixerForPredictionOutput</span></a></span></span><a class="headerlink" href="#dsipts.models.ttm.modeling_tinytimemixer.TinyTimeMixerForMaskedPrediction.forward" title="Link to this definition">¶</a></dt>
<dd><dl>
<dt>past_observed_mask (<cite>torch.Tensor</cite> of shape <cite>(batch_size, sequence_length, num_input_channels)</cite>, <em>optional</em>):</dt><dd><p>Boolean mask to indicate which <cite>past_values</cite> were observed and which were missing. Mask values selected
in <cite>[0, 1]</cite> or <cite>[False, True]</cite>:</p>
<blockquote>
<div><ul class="simple">
<li><p>1 or True for values that are <strong>observed</strong>,</p></li>
<li><p>0 or False for values that are <strong>missing</strong> (i.e. NaNs that were replaced by zeros).</p></li>
</ul>
</div></blockquote>
</dd>
<dt>future_values (<cite>torch.FloatTensor</cite> of shape <cite>(batch_size, target_len, num_input_channels)</cite> for forecasting,:</dt><dd><p><cite>(batch_size, num_targets)</cite> for regression, or <cite>(batch_size,)</cite> for classification, <em>optional</em>): Target
values of the time series, that serve as labels for the model. The <cite>future_values</cite> is what the
Transformer needs during training to learn to output, given the <cite>past_values</cite>. Note that, this is NOT
required for a pretraining task.</p>
<p>For a forecasting task, the shape is be <cite>(batch_size, target_len, num_input_channels)</cite>. Even if we want
to forecast only specific channels by setting the indices in <cite>prediction_channel_indices</cite> parameter,
pass the target data with all channels, as channel Filtering for both prediction and target will be
manually applied before the loss computation.</p>
</dd>
<dt>future_observed_mask (<cite>torch.Tensor</cite> of shape <cite>(batch_size, prediction_length, num_targets)</cite>, <em>optional</em>):</dt><dd><p>Boolean mask to indicate which <cite>future_values</cite> were observed and which were missing. Mask values selected
in <cite>[0, 1]</cite> or <cite>[False, True]</cite>:</p>
<blockquote>
<div><ul class="simple">
<li><p>1 or True for values that are <strong>observed</strong>,</p></li>
<li><p>0 or False for values that are <strong>missing</strong> (i.e. NaNs that were replaced by zeros).</p></li>
</ul>
</div></blockquote>
</dd>
<dt>return_loss (<cite>bool</cite>,  <em>optional</em>):</dt><dd><p>Whether to return the loss in the <cite>forward</cite> call.</p>
</dd>
<dt>static_categorical_values (<cite>torch.FloatTensor</cite> of shape <cite>(batch_size, number_of_categorical_variables)</cite>, <em>optional</em>):</dt><dd><p>Tokenized categorical values can be passed here. Ensure to pass in the same order as the vocab size list used in the
TinyTimeMixerConfig param <cite>categorical_vocab_size_list</cite></p>
</dd>
<dt>metadata (<cite>torch.Tensor</cite>, <em>optional</em>): A tensor containing metadata. Currently unused in TinyTimeMixer, but used</dt><dd><p>to support custom trainers. Defaults to None.</p>
</dd>
</dl>
<p>Returns:</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dsipts.models.ttm.modeling_tinytimemixer.TinyTimeMixerForPrediction">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dsipts.models.ttm.modeling_tinytimemixer.</span></span><span class="sig-name descname"><span class="pre">TinyTimeMixerForPrediction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#dsipts.models.ttm.configuration_tinytimemixer.TinyTimeMixerConfig" title="dsipts.models.ttm.configuration_tinytimemixer.TinyTimeMixerConfig"><span class="pre">TinyTimeMixerConfig</span></a></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dsipts.models.ttm.modeling_tinytimemixer.TinyTimeMixerForPrediction" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#dsipts.models.ttm.modeling_tinytimemixer.TinyTimeMixerPreTrainedModel" title="dsipts.models.ttm.modeling_tinytimemixer.TinyTimeMixerPreTrainedModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">TinyTimeMixerPreTrainedModel</span></code></a></p>
<p>Initialize internal Module state, shared by both nn.Module and ScriptModule.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="dsipts.models.ttm.modeling_tinytimemixer.TinyTimeMixerForPrediction.config_class">
<span class="sig-name descname"><span class="pre">config_class</span></span><a class="headerlink" href="#dsipts.models.ttm.modeling_tinytimemixer.TinyTimeMixerForPrediction.config_class" title="Link to this definition">¶</a></dt>
<dd><p>alias of <a class="reference internal" href="#dsipts.models.ttm.configuration_tinytimemixer.TinyTimeMixerConfig" title="dsipts.models.ttm.configuration_tinytimemixer.TinyTimeMixerConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">TinyTimeMixerConfig</span></code></a></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dsipts.models.ttm.modeling_tinytimemixer.TinyTimeMixerForPrediction.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">past_values</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">future_values</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">past_observed_mask</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">future_observed_mask</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_hidden_states</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_loss</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">freq_token</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">static_categorical_values</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metadata</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#dsipts.models.ttm.modeling_tinytimemixer.TinyTimeMixerForPredictionOutput" title="dsipts.models.ttm.modeling_tinytimemixer.TinyTimeMixerForPredictionOutput"><span class="pre">TinyTimeMixerForPredictionOutput</span></a></span></span><a class="headerlink" href="#dsipts.models.ttm.modeling_tinytimemixer.TinyTimeMixerForPrediction.forward" title="Link to this definition">¶</a></dt>
<dd><dl>
<dt>past_observed_mask (<cite>torch.Tensor</cite> of shape <cite>(batch_size, sequence_length, num_input_channels)</cite>, <em>optional</em>):</dt><dd><p>Boolean mask to indicate which <cite>past_values</cite> were observed and which were missing. Mask values selected
in <cite>[0, 1]</cite> or <cite>[False, True]</cite>:</p>
<blockquote>
<div><ul class="simple">
<li><p>1 or True for values that are <strong>observed</strong>,</p></li>
<li><p>0 or False for values that are <strong>missing</strong> (i.e. NaNs that were replaced by zeros).</p></li>
</ul>
</div></blockquote>
</dd>
<dt>future_values (<cite>torch.FloatTensor</cite> of shape <cite>(batch_size, target_len, num_input_channels)</cite> for forecasting,:</dt><dd><p><cite>(batch_size, num_targets)</cite> for regression, or <cite>(batch_size,)</cite> for classification, <em>optional</em>): Target
values of the time series, that serve as labels for the model. The <cite>future_values</cite> is what the
Transformer needs during training to learn to output, given the <cite>past_values</cite>. Note that, this is NOT
required for a pretraining task.</p>
<p>For a forecasting task, the shape is be <cite>(batch_size, target_len, num_input_channels)</cite>. Even if we want
to forecast only specific channels by setting the indices in <cite>prediction_channel_indices</cite> parameter,
pass the target data with all channels, as channel Filtering for both prediction and target will be
manually applied before the loss computation.</p>
</dd>
<dt>future_observed_mask (<cite>torch.Tensor</cite> of shape <cite>(batch_size, prediction_length, num_targets)</cite>, <em>optional</em>):</dt><dd><p>Boolean mask to indicate which <cite>future_values</cite> were observed and which were missing. Mask values selected
in <cite>[0, 1]</cite> or <cite>[False, True]</cite>:</p>
<blockquote>
<div><ul class="simple">
<li><p>1 or True for values that are <strong>observed</strong>,</p></li>
<li><p>0 or False for values that are <strong>missing</strong> (i.e. NaNs that were replaced by zeros).</p></li>
</ul>
</div></blockquote>
</dd>
<dt>return_loss (<cite>bool</cite>,  <em>optional</em>):</dt><dd><p>Whether to return the loss in the <cite>forward</cite> call.</p>
</dd>
<dt>static_categorical_values (<cite>torch.FloatTensor</cite> of shape <cite>(batch_size, number_of_categorical_variables)</cite>, <em>optional</em>):</dt><dd><p>Tokenized categorical values can be passed here. Ensure to pass in the same order as the vocab size list used in the
TinyTimeMixerConfig param <cite>categorical_vocab_size_list</cite></p>
</dd>
<dt>metadata (<cite>torch.Tensor</cite>, <em>optional</em>): A tensor containing metadata. Currently unused in TinyTimeMixer, but used</dt><dd><p>to support custom trainers. Defaults to None.</p>
</dd>
</dl>
<p>Returns:</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dsipts.models.ttm.modeling_tinytimemixer.TinyTimeMixerForPrediction.generate">
<span class="sig-name descname"><span class="pre">generate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">past_values</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">past_observed_mask</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#dsipts.models.ttm.modeling_tinytimemixer.SampleTinyTimeMixerPredictionOutput" title="dsipts.models.ttm.modeling_tinytimemixer.SampleTinyTimeMixerPredictionOutput"><span class="pre">SampleTinyTimeMixerPredictionOutput</span></a></span></span><a class="headerlink" href="#dsipts.models.ttm.modeling_tinytimemixer.TinyTimeMixerForPrediction.generate" title="Link to this definition">¶</a></dt>
<dd><p>Generate sequences of sample predictions from a model with a probability distribution head.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>past_values</strong> (<cite>torch.FloatTensor</cite> of shape <cite>(batch_size, sequence_length, num_input_channels)</cite>) – Past values of the time series that serves as context in order to predict the future.</p></li>
<li><p><strong>past_observed_mask</strong> (<cite>torch.Tensor</cite> of shape <cite>(batch_size, sequence_length, num_input_channels)</cite>, <em>optional</em>) – <p>Boolean mask to indicate which <cite>past_values</cite> were observed and which were missing. Mask values selected
in <cite>[0, 1]</cite> or <cite>[False, True]</cite>:</p>
<blockquote>
<div><ul>
<li><p>1 or True for values that are <strong>observed</strong>,</p></li>
<li><p>0 or False for values that are <strong>missing</strong> (i.e. NaNs that were replaced by zeros).</p></li>
</ul>
</div></blockquote>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>[<cite>SampleTinyTimeMixerPredictionOutput</cite>] where the outputs <cite>sequences</cite> tensor will have shape <cite>(batch_size,
number of samples, prediction_length, num_input_channels)</cite>.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dsipts.models.ttm.modeling_tinytimemixer.TinyTimeMixerForPredictionHead">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dsipts.models.ttm.modeling_tinytimemixer.</span></span><span class="sig-name descname"><span class="pre">TinyTimeMixerForPredictionHead</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#dsipts.models.ttm.configuration_tinytimemixer.TinyTimeMixerConfig" title="dsipts.models.ttm.configuration_tinytimemixer.TinyTimeMixerConfig"><span class="pre">TinyTimeMixerConfig</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">distribution_output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dsipts.models.ttm.modeling_tinytimemixer.TinyTimeMixerForPredictionHead" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Initialize internal Module state, shared by both nn.Module and ScriptModule.</p>
<dl class="py method">
<dt class="sig sig-object py" id="dsipts.models.ttm.modeling_tinytimemixer.TinyTimeMixerForPredictionHead.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hidden_features</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">past_values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">future_values</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dsipts.models.ttm.modeling_tinytimemixer.TinyTimeMixerForPredictionHead.forward" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>`</strong> (<em>hidden_features</em>) – Input hidden
features.</p></li>
<li><p><strong>past_values</strong> (<cite>torch.FloatTensor</cite> of shape <cite>(batch_size, seq_length, num_input_channels)</cite>)</p></li>
<li><p><strong>task</strong> (<em>Context values</em><em> of </em><em>the time series. For a forecasting</em>)</p></li>
<li><p><strong>values.</strong> (<em>this denotes the history/past time series</em>)</p></li>
<li><p><strong>series</strong> (<em>num_input_channels dimension should be 1. For multivariate time</em>)</p></li>
<li><p><strong>series</strong></p></li>
<li><p><strong>is</strong> (<em>it</em>)</p></li>
<li><p><strong>1.</strong> (<em>greater than</em>)</p></li>
<li><p><strong>future_values</strong> (<cite>torch.Tensor</cite> of shape <cite>(batch_size, prediction length, input_channels)</cite>, <em>optional</em>, Defaults to None) – Actual groundtruths of the forecasts. Pass dummy values (say 0) for forecast channels, if groundtruth is unknown.
Pass the correct values for Exogenous channels where the forecast values are known.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><cite>torch.Tensor</cite> of shape <cite>(batch_size, prediction_length, forecast_channels)</cite>.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dsipts.models.ttm.modeling_tinytimemixer.TinyTimeMixerForPredictionOutput">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dsipts.models.ttm.modeling_tinytimemixer.</span></span><span class="sig-name descname"><span class="pre">TinyTimeMixerForPredictionOutput</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">loss</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">FloatTensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prediction_outputs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">FloatTensor</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">backbone_hidden_state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">FloatTensor</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decoder_hidden_state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">FloatTensor</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hidden_states</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">FloatTensor</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loc</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">FloatTensor</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">FloatTensor</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dsipts.models.ttm.modeling_tinytimemixer.TinyTimeMixerForPredictionOutput" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">ModelOutput</span></code></p>
<p>Output type of [<cite>TinyTimeMixerForPredictionOutput</cite>].</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>prediction_outputs</strong> (<cite>torch.FloatTensor</cite> of shape <cite>(batch_size, prediction_length, num_input_channels)</cite>) – Prediction output from the forecast head.</p></li>
<li><p><strong>backbone_hidden_state</strong> (<cite>torch.FloatTensor</cite> of shape <cite>(batch_size, num_input_channels, num_patches, d_model)</cite>) – Backbone embeddings before passing through the decoder</p></li>
<li><p><strong>decoder_hidden_state</strong> (<cite>torch.FloatTensor</cite> of shape <cite>(batch_size, num_input_channels, num_patches, d_model)</cite>) – Decoder embeddings before passing through the head.</p></li>
<li><p><strong>hidden_states</strong> (<cite>tuple(torch.FloatTensor)</cite>, <em>optional</em>) – Hidden-states of the model at the output of each layer plus the optional initial embedding outputs.</p></li>
<li><p><strong>loss</strong> (<em>optional</em>, returned when <cite>y</cite> is provided, <cite>torch.FloatTensor</cite> of shape <cite>()</cite>) – Total loss.</p></li>
<li><p><strong>loc</strong> (<cite>torch.FloatTensor</cite>, <em>optional</em> of shape <cite>(batch_size, 1, num_input_channels)</cite>) – Input mean</p></li>
<li><p><strong>scale</strong> (<cite>torch.FloatTensor</cite>, <em>optional</em> of shape <cite>(batch_size, 1, num_input_channels)</cite>) – Input std dev</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="dsipts.models.ttm.modeling_tinytimemixer.TinyTimeMixerForPredictionOutput.backbone_hidden_state">
<span class="sig-name descname"><span class="pre">backbone_hidden_state</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">FloatTensor</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#dsipts.models.ttm.modeling_tinytimemixer.TinyTimeMixerForPredictionOutput.backbone_hidden_state" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dsipts.models.ttm.modeling_tinytimemixer.TinyTimeMixerForPredictionOutput.decoder_hidden_state">
<span class="sig-name descname"><span class="pre">decoder_hidden_state</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">FloatTensor</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#dsipts.models.ttm.modeling_tinytimemixer.TinyTimeMixerForPredictionOutput.decoder_hidden_state" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dsipts.models.ttm.modeling_tinytimemixer.TinyTimeMixerForPredictionOutput.hidden_states">
<span class="sig-name descname"><span class="pre">hidden_states</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">FloatTensor</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#dsipts.models.ttm.modeling_tinytimemixer.TinyTimeMixerForPredictionOutput.hidden_states" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dsipts.models.ttm.modeling_tinytimemixer.TinyTimeMixerForPredictionOutput.loc">
<span class="sig-name descname"><span class="pre">loc</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">FloatTensor</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#dsipts.models.ttm.modeling_tinytimemixer.TinyTimeMixerForPredictionOutput.loc" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dsipts.models.ttm.modeling_tinytimemixer.TinyTimeMixerForPredictionOutput.loss">
<span class="sig-name descname"><span class="pre">loss</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">FloatTensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#dsipts.models.ttm.modeling_tinytimemixer.TinyTimeMixerForPredictionOutput.loss" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dsipts.models.ttm.modeling_tinytimemixer.TinyTimeMixerForPredictionOutput.prediction_outputs">
<span class="sig-name descname"><span class="pre">prediction_outputs</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">FloatTensor</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#dsipts.models.ttm.modeling_tinytimemixer.TinyTimeMixerForPredictionOutput.prediction_outputs" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dsipts.models.ttm.modeling_tinytimemixer.TinyTimeMixerForPredictionOutput.scale">
<span class="sig-name descname"><span class="pre">scale</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">FloatTensor</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#dsipts.models.ttm.modeling_tinytimemixer.TinyTimeMixerForPredictionOutput.scale" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dsipts.models.ttm.modeling_tinytimemixer.TinyTimeMixerGatedAttention">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dsipts.models.ttm.modeling_tinytimemixer.</span></span><span class="sig-name descname"><span class="pre">TinyTimeMixerGatedAttention</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dsipts.models.ttm.modeling_tinytimemixer.TinyTimeMixerGatedAttention" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Initialize internal Module state, shared by both nn.Module and ScriptModule.</p>
<dl class="py method">
<dt class="sig sig-object py" id="dsipts.models.ttm.modeling_tinytimemixer.TinyTimeMixerGatedAttention.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dsipts.models.ttm.modeling_tinytimemixer.TinyTimeMixerGatedAttention.forward" title="Link to this definition">¶</a></dt>
<dd><p>Define the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dsipts.models.ttm.modeling_tinytimemixer.TinyTimeMixerLayer">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dsipts.models.ttm.modeling_tinytimemixer.</span></span><span class="sig-name descname"><span class="pre">TinyTimeMixerLayer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#dsipts.models.ttm.configuration_tinytimemixer.TinyTimeMixerConfig" title="dsipts.models.ttm.configuration_tinytimemixer.TinyTimeMixerConfig"><span class="pre">TinyTimeMixerConfig</span></a></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dsipts.models.ttm.modeling_tinytimemixer.TinyTimeMixerLayer" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Initialize internal Module state, shared by both nn.Module and ScriptModule.</p>
<dl class="py method">
<dt class="sig sig-object py" id="dsipts.models.ttm.modeling_tinytimemixer.TinyTimeMixerLayer.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hidden</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dsipts.models.ttm.modeling_tinytimemixer.TinyTimeMixerLayer.forward" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>hidden</strong> (<cite>torch.Tensor</cite> of shape <cite>(batch_size, num_patches, d_model)</cite>) – Input tensor to the layer.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Transformed tensor.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><cite>torch.Tensor</cite></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dsipts.models.ttm.modeling_tinytimemixer.TinyTimeMixerMLP">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dsipts.models.ttm.modeling_tinytimemixer.</span></span><span class="sig-name descname"><span class="pre">TinyTimeMixerMLP</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_features</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_features</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dsipts.models.ttm.modeling_tinytimemixer.TinyTimeMixerMLP" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Initialize internal Module state, shared by both nn.Module and ScriptModule.</p>
<dl class="py method">
<dt class="sig sig-object py" id="dsipts.models.ttm.modeling_tinytimemixer.TinyTimeMixerMLP.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dsipts.models.ttm.modeling_tinytimemixer.TinyTimeMixerMLP.forward" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>inputs</strong> (<cite>torch.Tensor</cite> of shape <cite>((batch_size, num_channels, num_patches, d_model))</cite>) – Input to the MLP layer.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><cite>torch.Tensor</cite> of the same shape as <cite>inputs</cite></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dsipts.models.ttm.modeling_tinytimemixer.TinyTimeMixerMeanScaler">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dsipts.models.ttm.modeling_tinytimemixer.</span></span><span class="sig-name descname"><span class="pre">TinyTimeMixerMeanScaler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#dsipts.models.ttm.configuration_tinytimemixer.TinyTimeMixerConfig" title="dsipts.models.ttm.configuration_tinytimemixer.TinyTimeMixerConfig"><span class="pre">TinyTimeMixerConfig</span></a></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dsipts.models.ttm.modeling_tinytimemixer.TinyTimeMixerMeanScaler" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Initialize internal Module state, shared by both nn.Module and ScriptModule.</p>
<dl class="py method">
<dt class="sig sig-object py" id="dsipts.models.ttm.modeling_tinytimemixer.TinyTimeMixerMeanScaler.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observed_indicator</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#dsipts.models.ttm.modeling_tinytimemixer.TinyTimeMixerMeanScaler.forward" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<cite>torch.Tensor</cite> of shape <cite>(batch_size, sequence_length, num_input_channels)</cite>) – input for Batch norm calculation</p></li>
<li><p><strong>observed_indicator</strong> (<cite>torch.BoolTensor</cite> of shape <cite>(batch_size, sequence_length, num_input_channels)</cite>) – Calculating the scale on the observed indicator.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>tuple of <cite>torch.Tensor</cite> of shapes</dt><dd><p>(<cite>(batch_size, sequence_length, num_input_channels)</cite>,`(batch_size, 1, num_input_channels)`,
<cite>(batch_size, 1, num_input_channels)</cite>)</p>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dsipts.models.ttm.modeling_tinytimemixer.TinyTimeMixerModel">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dsipts.models.ttm.modeling_tinytimemixer.</span></span><span class="sig-name descname"><span class="pre">TinyTimeMixerModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#dsipts.models.ttm.configuration_tinytimemixer.TinyTimeMixerConfig" title="dsipts.models.ttm.configuration_tinytimemixer.TinyTimeMixerConfig"><span class="pre">TinyTimeMixerConfig</span></a></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dsipts.models.ttm.modeling_tinytimemixer.TinyTimeMixerModel" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#dsipts.models.ttm.modeling_tinytimemixer.TinyTimeMixerPreTrainedModel" title="dsipts.models.ttm.modeling_tinytimemixer.TinyTimeMixerPreTrainedModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">TinyTimeMixerPreTrainedModel</span></code></a></p>
<p>Initialize internal Module state, shared by both nn.Module and ScriptModule.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="dsipts.models.ttm.modeling_tinytimemixer.TinyTimeMixerModel.config_class">
<span class="sig-name descname"><span class="pre">config_class</span></span><a class="headerlink" href="#dsipts.models.ttm.modeling_tinytimemixer.TinyTimeMixerModel.config_class" title="Link to this definition">¶</a></dt>
<dd><p>alias of <a class="reference internal" href="#dsipts.models.ttm.configuration_tinytimemixer.TinyTimeMixerConfig" title="dsipts.models.ttm.configuration_tinytimemixer.TinyTimeMixerConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">TinyTimeMixerConfig</span></code></a></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dsipts.models.ttm.modeling_tinytimemixer.TinyTimeMixerModel.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">past_values</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">past_observed_mask</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_hidden_states</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">freq_token</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#dsipts.models.ttm.modeling_tinytimemixer.TinyTimeMixerModelOutput" title="dsipts.models.ttm.modeling_tinytimemixer.TinyTimeMixerModelOutput"><span class="pre">TinyTimeMixerModelOutput</span></a></span></span><a class="headerlink" href="#dsipts.models.ttm.modeling_tinytimemixer.TinyTimeMixerModel.forward" title="Link to this definition">¶</a></dt>
<dd><dl>
<dt>past_observed_mask (<cite>torch.Tensor</cite> of shape <cite>(batch_size, sequence_length, num_input_channels)</cite>, <em>optional</em>):</dt><dd><p>Boolean mask to indicate which <cite>past_values</cite> were observed and which were missing. Mask values selected
in <cite>[0, 1]</cite> or <cite>[False, True]</cite>:</p>
<blockquote>
<div><ul class="simple">
<li><p>1 or True for values that are <strong>observed</strong>,</p></li>
<li><p>0 or False for values that are <strong>missing</strong> (i.e. NaNs that were replaced by zeros).</p></li>
</ul>
</div></blockquote>
</dd>
</dl>
<p>Returns:</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dsipts.models.ttm.modeling_tinytimemixer.TinyTimeMixerModelOutput">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dsipts.models.ttm.modeling_tinytimemixer.</span></span><span class="sig-name descname"><span class="pre">TinyTimeMixerModelOutput</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">last_hidden_state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">FloatTensor</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hidden_states</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">FloatTensor</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patch_input</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">FloatTensor</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loc</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">FloatTensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">FloatTensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dsipts.models.ttm.modeling_tinytimemixer.TinyTimeMixerModelOutput" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">ModelOutput</span></code></p>
<p>Base class for model’s outputs, with potential hidden states.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>last_hidden_state</strong> (<cite>torch.FloatTensor</cite>  of shape <cite>(batch_size, num_channels, num_patches, d_model)</cite>) – Hidden-state at the output of the last layer of the model.</p></li>
<li><p><strong>hidden_states</strong> (<cite>tuple(torch.FloatTensor)</cite>, <em>optional</em>) – Hidden-states of the model at the output of each layer.</p></li>
<li><p><strong>patch_input</strong> (<cite>torch.FloatTensor</cite> of shape <cite>(batch_size, num_channels, num_patches, patch_length)</cite>) – Patched input data to the model.</p></li>
<li><p><strong>loc</strong> – (<cite>torch.FloatTensor</cite> of shape <cite>(batch_size, 1, num_channels)</cite>,*optional*):
Gives the mean of the context window per channel. Used for revin denorm outside the model, if revin
enabled.</p></li>
<li><p><strong>scale</strong> – (<cite>torch.FloatTensor</cite> of shape <cite>(batch_size, 1, num_channels)</cite>,*optional*):
Gives the std dev of the context window per channel. Used for revin denorm outside the model, if revin
enabled.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="dsipts.models.ttm.modeling_tinytimemixer.TinyTimeMixerModelOutput.hidden_states">
<span class="sig-name descname"><span class="pre">hidden_states</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">FloatTensor</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#dsipts.models.ttm.modeling_tinytimemixer.TinyTimeMixerModelOutput.hidden_states" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dsipts.models.ttm.modeling_tinytimemixer.TinyTimeMixerModelOutput.last_hidden_state">
<span class="sig-name descname"><span class="pre">last_hidden_state</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">FloatTensor</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#dsipts.models.ttm.modeling_tinytimemixer.TinyTimeMixerModelOutput.last_hidden_state" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dsipts.models.ttm.modeling_tinytimemixer.TinyTimeMixerModelOutput.loc">
<span class="sig-name descname"><span class="pre">loc</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">FloatTensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#dsipts.models.ttm.modeling_tinytimemixer.TinyTimeMixerModelOutput.loc" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dsipts.models.ttm.modeling_tinytimemixer.TinyTimeMixerModelOutput.patch_input">
<span class="sig-name descname"><span class="pre">patch_input</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">FloatTensor</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#dsipts.models.ttm.modeling_tinytimemixer.TinyTimeMixerModelOutput.patch_input" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dsipts.models.ttm.modeling_tinytimemixer.TinyTimeMixerModelOutput.scale">
<span class="sig-name descname"><span class="pre">scale</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">FloatTensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#dsipts.models.ttm.modeling_tinytimemixer.TinyTimeMixerModelOutput.scale" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dsipts.models.ttm.modeling_tinytimemixer.TinyTimeMixerNOPScaler">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dsipts.models.ttm.modeling_tinytimemixer.</span></span><span class="sig-name descname"><span class="pre">TinyTimeMixerNOPScaler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#dsipts.models.ttm.configuration_tinytimemixer.TinyTimeMixerConfig" title="dsipts.models.ttm.configuration_tinytimemixer.TinyTimeMixerConfig"><span class="pre">TinyTimeMixerConfig</span></a></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dsipts.models.ttm.modeling_tinytimemixer.TinyTimeMixerNOPScaler" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Initialize internal Module state, shared by both nn.Module and ScriptModule.</p>
<dl class="py method">
<dt class="sig sig-object py" id="dsipts.models.ttm.modeling_tinytimemixer.TinyTimeMixerNOPScaler.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observed_indicator</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#dsipts.models.ttm.modeling_tinytimemixer.TinyTimeMixerNOPScaler.forward" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data</strong> (<cite>torch.Tensor</cite> of shape <cite>(batch_size, sequence_length, num_input_channels)</cite>) – input for Batch norm calculation</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>tuple of <cite>torch.Tensor</cite> of shapes</dt><dd><p>(<cite>(batch_size, sequence_length, num_input_channels)</cite>,`(batch_size, 1, num_input_channels)`,
<cite>(batch_size, 1, num_input_channels)</cite>)</p>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dsipts.models.ttm.modeling_tinytimemixer.TinyTimeMixerNormLayer">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dsipts.models.ttm.modeling_tinytimemixer.</span></span><span class="sig-name descname"><span class="pre">TinyTimeMixerNormLayer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#dsipts.models.ttm.configuration_tinytimemixer.TinyTimeMixerConfig" title="dsipts.models.ttm.configuration_tinytimemixer.TinyTimeMixerConfig"><span class="pre">TinyTimeMixerConfig</span></a></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dsipts.models.ttm.modeling_tinytimemixer.TinyTimeMixerNormLayer" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Initialize internal Module state, shared by both nn.Module and ScriptModule.</p>
<dl class="py method">
<dt class="sig sig-object py" id="dsipts.models.ttm.modeling_tinytimemixer.TinyTimeMixerNormLayer.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dsipts.models.ttm.modeling_tinytimemixer.TinyTimeMixerNormLayer.forward" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>inputs</strong> (<cite>torch.Tensor</cite> of shape <cite>((batch_size, num_channels, num_patches, d_model))</cite>) – Input to the normalization layer.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><cite>torch.Tensor</cite> of shape <cite>((batch_size, num_channels, num_patches, d_model))</cite></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dsipts.models.ttm.modeling_tinytimemixer.TinyTimeMixerPatchify">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dsipts.models.ttm.modeling_tinytimemixer.</span></span><span class="sig-name descname"><span class="pre">TinyTimeMixerPatchify</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#dsipts.models.ttm.configuration_tinytimemixer.TinyTimeMixerConfig" title="dsipts.models.ttm.configuration_tinytimemixer.TinyTimeMixerConfig"><span class="pre">TinyTimeMixerConfig</span></a></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dsipts.models.ttm.modeling_tinytimemixer.TinyTimeMixerPatchify" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Initialize internal Module state, shared by both nn.Module and ScriptModule.</p>
<dl class="py method">
<dt class="sig sig-object py" id="dsipts.models.ttm.modeling_tinytimemixer.TinyTimeMixerPatchify.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">past_values</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dsipts.models.ttm.modeling_tinytimemixer.TinyTimeMixerPatchify.forward" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>past_values</strong> (<cite>torch.Tensor</cite> of shape <cite>(batch_size, sequence_length, num_channels)</cite>, <em>required</em>) – Input for patchification</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><cite>torch.Tensor</cite> of shape <cite>(batch_size, num_channels, num_patches, patch_length)</cite></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dsipts.models.ttm.modeling_tinytimemixer.TinyTimeMixerPositionalEncoding">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dsipts.models.ttm.modeling_tinytimemixer.</span></span><span class="sig-name descname"><span class="pre">TinyTimeMixerPositionalEncoding</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#dsipts.models.ttm.configuration_tinytimemixer.TinyTimeMixerConfig" title="dsipts.models.ttm.configuration_tinytimemixer.TinyTimeMixerConfig"><span class="pre">TinyTimeMixerConfig</span></a></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dsipts.models.ttm.modeling_tinytimemixer.TinyTimeMixerPositionalEncoding" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Initialize internal Module state, shared by both nn.Module and ScriptModule.</p>
<dl class="py method">
<dt class="sig sig-object py" id="dsipts.models.ttm.modeling_tinytimemixer.TinyTimeMixerPositionalEncoding.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">patch_input</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dsipts.models.ttm.modeling_tinytimemixer.TinyTimeMixerPositionalEncoding.forward" title="Link to this definition">¶</a></dt>
<dd><p>Define the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dsipts.models.ttm.modeling_tinytimemixer.TinyTimeMixerPreTrainedModel">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dsipts.models.ttm.modeling_tinytimemixer.</span></span><span class="sig-name descname"><span class="pre">TinyTimeMixerPreTrainedModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">PretrainedConfig</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">inputs</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dsipts.models.ttm.modeling_tinytimemixer.TinyTimeMixerPreTrainedModel" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">PreTrainedModel</span></code></p>
<p>Initialize internal Module state, shared by both nn.Module and ScriptModule.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="dsipts.models.ttm.modeling_tinytimemixer.TinyTimeMixerPreTrainedModel.base_model_prefix">
<span class="sig-name descname"><span class="pre">base_model_prefix</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'model'</span></em><a class="headerlink" href="#dsipts.models.ttm.modeling_tinytimemixer.TinyTimeMixerPreTrainedModel.base_model_prefix" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dsipts.models.ttm.modeling_tinytimemixer.TinyTimeMixerPreTrainedModel.config_class">
<span class="sig-name descname"><span class="pre">config_class</span></span><a class="headerlink" href="#dsipts.models.ttm.modeling_tinytimemixer.TinyTimeMixerPreTrainedModel.config_class" title="Link to this definition">¶</a></dt>
<dd><p>alias of <a class="reference internal" href="#dsipts.models.ttm.configuration_tinytimemixer.TinyTimeMixerConfig" title="dsipts.models.ttm.configuration_tinytimemixer.TinyTimeMixerConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">TinyTimeMixerConfig</span></code></a></p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dsipts.models.ttm.modeling_tinytimemixer.TinyTimeMixerPreTrainedModel.main_input_name">
<span class="sig-name descname"><span class="pre">main_input_name</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'past_values'</span></em><a class="headerlink" href="#dsipts.models.ttm.modeling_tinytimemixer.TinyTimeMixerPreTrainedModel.main_input_name" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dsipts.models.ttm.modeling_tinytimemixer.TinyTimeMixerPreTrainedModel.supports_gradient_checkpointing">
<span class="sig-name descname"><span class="pre">supports_gradient_checkpointing</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#dsipts.models.ttm.modeling_tinytimemixer.TinyTimeMixerPreTrainedModel.supports_gradient_checkpointing" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dsipts.models.ttm.modeling_tinytimemixer.TinyTimeMixerStdScaler">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dsipts.models.ttm.modeling_tinytimemixer.</span></span><span class="sig-name descname"><span class="pre">TinyTimeMixerStdScaler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#dsipts.models.ttm.configuration_tinytimemixer.TinyTimeMixerConfig" title="dsipts.models.ttm.configuration_tinytimemixer.TinyTimeMixerConfig"><span class="pre">TinyTimeMixerConfig</span></a></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dsipts.models.ttm.modeling_tinytimemixer.TinyTimeMixerStdScaler" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Initialize internal Module state, shared by both nn.Module and ScriptModule.</p>
<dl class="py method">
<dt class="sig sig-object py" id="dsipts.models.ttm.modeling_tinytimemixer.TinyTimeMixerStdScaler.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observed_indicator</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#dsipts.models.ttm.modeling_tinytimemixer.TinyTimeMixerStdScaler.forward" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<cite>torch.Tensor</cite> of shape <cite>(batch_size, sequence_length, num_input_channels)</cite>) – input for Batch norm calculation</p></li>
<li><p><strong>observed_indicator</strong> (<cite>torch.BoolTensor</cite> of shape <cite>(batch_size, sequence_length, num_input_channels)</cite>) – Calculating the scale on the observed indicator.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>tuple of <cite>torch.Tensor</cite> of shapes</dt><dd><p>(<cite>(batch_size, sequence_length, num_input_channels)</cite>,`(batch_size, 1, num_input_channels)`,
<cite>(batch_size, 1, num_input_channels)</cite>)</p>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dsipts.models.ttm.modeling_tinytimemixer.nll">
<span class="sig-prename descclassname"><span class="pre">dsipts.models.ttm.modeling_tinytimemixer.</span></span><span class="sig-name descname"><span class="pre">nll</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Distribution</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="headerlink" href="#dsipts.models.ttm.modeling_tinytimemixer.nll" title="Link to this definition">¶</a></dt>
<dd><p>Computes the negative log likelihood loss from input distribution with respect to target.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dsipts.models.ttm.modeling_tinytimemixer.weighted_average">
<span class="sig-prename descclassname"><span class="pre">dsipts.models.ttm.modeling_tinytimemixer.</span></span><span class="sig-name descname"><span class="pre">weighted_average</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_tensor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="headerlink" href="#dsipts.models.ttm.modeling_tinytimemixer.weighted_average" title="Link to this definition">¶</a></dt>
<dd><p>Computes the weighted average of a given tensor across a given <cite>dim</cite>, masking values associated with weight zero,
meaning instead of <cite>nan * 0 = nan</cite> you will get <cite>0 * 0 = 0</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_tensor</strong> (<cite>torch.FloatTensor</cite>) – Input tensor, of which the average must be computed.</p></li>
<li><p><strong>weights</strong> (<cite>torch.FloatTensor</cite>, <em>optional</em>) – Weights tensor, of the same shape as <cite>input_tensor</cite>.</p></li>
<li><p><strong>dim</strong> (<cite>int</cite>, <em>optional</em>) – The dim along which to average <cite>input_tensor</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The tensor with values averaged along the specified <cite>dim</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><cite>torch.FloatTensor</cite></p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-dsipts.models.ttm.utils">
<span id="dsipts-models-ttm-utils-module"></span><h2>dsipts.models.ttm.utils module<a class="headerlink" href="#module-dsipts.models.ttm.utils" title="Link to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="dsipts.models.ttm.utils.ForceReturn">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dsipts.models.ttm.utils.</span></span><span class="sig-name descname"><span class="pre">ForceReturn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dsipts.models.ttm.utils.ForceReturn" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Enum</span></code></p>
<p><cite>Enum</cite> for the <cite>force_return</cite> parameter in the <cite>get_model</cite> function.</p>
<dl class="simple">
<dt>“zeropad” = Returns a pre-trained TTM that has a context length higher than the input context length, hence,</dt><dd><p>the user must apply zero-padding to use the returned model.</p>
</dd>
<dt>“rolling” = Returns a pre-trained TTM that has a prediction length lower than the requested prediction length,</dt><dd><p>hence, the user must apply rolling technique to use the returned model to forecast to the desired length.
The <cite>RecursivePredictor</cite> class can be utilized in this scenario.</p>
</dd>
</dl>
<p>“random_init_small” = Returns a randomly initialized small TTM which must be trained before performing inference.
“random_init_medium” = Returns a randomly initialized medium TTM which must be trained before performing inference.
“random_init_large” = Returns a randomly initialized large TTM which must be trained before performing inference.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="dsipts.models.ttm.utils.ForceReturn.RANDOM_INIT_LARGE">
<span class="sig-name descname"><span class="pre">RANDOM_INIT_LARGE</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'random_init_large'</span></em><a class="headerlink" href="#dsipts.models.ttm.utils.ForceReturn.RANDOM_INIT_LARGE" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dsipts.models.ttm.utils.ForceReturn.RANDOM_INIT_MEDIUM">
<span class="sig-name descname"><span class="pre">RANDOM_INIT_MEDIUM</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'random_init_medium'</span></em><a class="headerlink" href="#dsipts.models.ttm.utils.ForceReturn.RANDOM_INIT_MEDIUM" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dsipts.models.ttm.utils.ForceReturn.RANDOM_INIT_SMALL">
<span class="sig-name descname"><span class="pre">RANDOM_INIT_SMALL</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'random_init_small'</span></em><a class="headerlink" href="#dsipts.models.ttm.utils.ForceReturn.RANDOM_INIT_SMALL" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dsipts.models.ttm.utils.ForceReturn.ROLLING">
<span class="sig-name descname"><span class="pre">ROLLING</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'rolling'</span></em><a class="headerlink" href="#dsipts.models.ttm.utils.ForceReturn.ROLLING" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dsipts.models.ttm.utils.ForceReturn.ZEROPAD">
<span class="sig-name descname"><span class="pre">ZEROPAD</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'zeropad'</span></em><a class="headerlink" href="#dsipts.models.ttm.utils.ForceReturn.ZEROPAD" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dsipts.models.ttm.utils.ModelSize">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dsipts.models.ttm.utils.</span></span><span class="sig-name descname"><span class="pre">ModelSize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dsipts.models.ttm.utils.ModelSize" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Enum</span></code></p>
<p><cite>Enum</cite> for the <cite>size</cite> parameter in the <cite>get_random_ttm</cite> function.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="dsipts.models.ttm.utils.ModelSize.LARGE">
<span class="sig-name descname"><span class="pre">LARGE</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'large'</span></em><a class="headerlink" href="#dsipts.models.ttm.utils.ModelSize.LARGE" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dsipts.models.ttm.utils.ModelSize.MEDIUM">
<span class="sig-name descname"><span class="pre">MEDIUM</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'medium'</span></em><a class="headerlink" href="#dsipts.models.ttm.utils.ModelSize.MEDIUM" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dsipts.models.ttm.utils.ModelSize.SMALL">
<span class="sig-name descname"><span class="pre">SMALL</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'small'</span></em><a class="headerlink" href="#dsipts.models.ttm.utils.ModelSize.SMALL" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dsipts.models.ttm.utils.RMSELoss">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dsipts.models.ttm.utils.</span></span><span class="sig-name descname"><span class="pre">RMSELoss</span></span><a class="headerlink" href="#dsipts.models.ttm.utils.RMSELoss" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Initialize internal Module state, shared by both nn.Module and ScriptModule.</p>
<dl class="py method">
<dt class="sig sig-object py" id="dsipts.models.ttm.utils.RMSELoss.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">yhat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dsipts.models.ttm.utils.RMSELoss.forward" title="Link to this definition">¶</a></dt>
<dd><p>Define the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dsipts.models.ttm.utils.check_ttm_model_path">
<span class="sig-prename descclassname"><span class="pre">dsipts.models.ttm.utils.</span></span><span class="sig-name descname"><span class="pre">check_ttm_model_path</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dsipts.models.ttm.utils.check_ttm_model_path" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dsipts.models.ttm.utils.count_parameters">
<span class="sig-prename descclassname"><span class="pre">dsipts.models.ttm.utils.</span></span><span class="sig-name descname"><span class="pre">count_parameters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span></span></span><a class="headerlink" href="#dsipts.models.ttm.utils.count_parameters" title="Link to this definition">¶</a></dt>
<dd><p>Count trainable parameters in a model</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>model</strong> (<em>torch.nn.Module</em>) – The model.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Number of parameters requiring gradients.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dsipts.models.ttm.utils.get_frequency_token">
<span class="sig-prename descclassname"><span class="pre">dsipts.models.ttm.utils.</span></span><span class="sig-name descname"><span class="pre">get_frequency_token</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">token_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dsipts.models.ttm.utils.get_frequency_token" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dsipts.models.ttm.utils.get_model">
<span class="sig-prename descclassname"><span class="pre">dsipts.models.ttm.utils.</span></span><span class="sig-name descname"><span class="pre">get_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'ttm'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">context_length</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prediction_length</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">freq_prefix_tuning</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">freq</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prefer_l1_loss</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prefer_longer_context</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force_return</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_model_key</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">PreTrainedModel</span></span></span><a class="headerlink" href="#dsipts.models.ttm.utils.get_model" title="Link to this definition">¶</a></dt>
<dd><p>TTM Model card offers a suite of models with varying <cite>context_length</cite> and <cite>prediction_length</cite> combinations.
This wrapper automatically selects the right model based on the given input <cite>context_length</cite> and
<cite>prediction_length</cite> abstracting away the internal complexity.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model_path</strong> (<em>str</em>) – HuggingFace model card path or local model path (Ex. ibm-granite/granite-timeseries-ttm-r2)</p></li>
<li><p><strong>model_name</strong> (<em>str</em><em>, </em><em>optional</em>) – Model name to use. Current allowed values: [ttm]. Defaults to “ttm”.</p></li>
<li><p><strong>context_length</strong> (<em>int</em><em>, </em><em>optional</em>) – Input Context length or history. Defaults to None.</p></li>
<li><p><strong>prediction_length</strong> (<em>int</em><em>, </em><em>optional</em>) – Length of the forecast horizon. Defaults to None.</p></li>
<li><p><strong>freq_prefix_tuning</strong> (<em>bool</em><em>, </em><em>optional</em>) – If true, it will prefer TTM models that are trained with frequency prefix
tuning configuration. Defaults to None.</p></li>
<li><p><strong>freq</strong> (<em>str</em><em>, </em><em>optional</em>) – Resolution or frequency of the data. Defaults to None. Allowed values are as per the
<cite>tsfm_public.toolkit.time_series_preprocessor.DEFAULT_FREQUENCY_MAPPING</cite>.
See this for details: <a class="reference external" href="https://github.com/ibm-granite/granite-tsfm/blob/main/tsfm_public/toolkit/time_series_preprocessor.py">https://github.com/ibm-granite/granite-tsfm/blob/main/tsfm_public/toolkit/time_series_preprocessor.py</a>.</p></li>
<li><p><strong>prefer_l1_loss</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, it will prefer choosing models that were trained with L1 loss or
mean absolute error loss. Defaults to False.</p></li>
<li><p><strong>prefer_longer_context</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, it will prefer selecting model with longer context/history
Defaults to True.</p></li>
<li><p><strong>force_return</strong> (<em>str</em><em>, </em><em>optional</em>) – This is used to force the get_model() to return a TTM model even when the provided
configurations don’t match with the existing TTMs. It gets the closest TTM possible. Allowed values are
[“zeropad”/”rolling”/”random_init_small”/”random_init_medium”/”random_init_large”/<cite>None</cite>].
“zeropad” = Returns a pre-trained TTM that has a context length higher than the input context length, hence,
the user must apply zero-padding to use the returned model.
“rolling” = Returns a pre-trained TTM that has a prediction length lower than the requested prediction length,
hence, the user must apply rolling technique to use the returned model to forecast to the desired length.
The <cite>RecursivePredictor</cite> class can be utilized in this scenario.
“random_init_small” = Returns a randomly initialized small TTM which must be trained before performing inference.
“random_init_medium” = Returns a randomly initialized medium TTM which must be trained before performing inference.
“random_init_large” = Returns a randomly initialized large TTM which must be trained before performing inference.
<cite>None</cite> = <cite>force_return</cite> is disable. Raises an error if no suitable model is found.
Defaults to None.</p></li>
<li><p><strong>return_model_key</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, only the TTM model name will be returned, instead of the actual model.
This does not downlaod the model, and only returns the name of the suitable model. Defaults to False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Returns the Model, or the model name.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Union[str, PreTrainedModel]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dsipts.models.ttm.utils.get_random_ttm">
<span class="sig-prename descclassname"><span class="pre">dsipts.models.ttm.utils.</span></span><span class="sig-name descname"><span class="pre">get_random_ttm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">context_length</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prediction_length</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'small'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">PreTrainedModel</span></span></span><a class="headerlink" href="#dsipts.models.ttm.utils.get_random_ttm" title="Link to this definition">¶</a></dt>
<dd><p>Get a TTM with random weights.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>context_length</strong> (<em>int</em>) – Context length or history.</p></li>
<li><p><strong>prediction_length</strong> (<em>int</em>) – Prediction length or forecast horizon.</p></li>
<li><p><strong>size</strong> (<em>str</em><em>, </em><em>optional</em>) – Size of the desired TTM (small/medium/large). Defaults to “small”.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError</strong> – If wrong size is provided.</p></li>
<li><p><strong>ValueError</strong> – Context length should be at least 4 if <cite>size=small</cite>,
    or at least 16 if <cite>size=medium</cite>,
    or at least 32 if <cite>size=large</cite>.</p></li>
</ul>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>TTM model with randomly initialized weights.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>PreTrainedModel</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-dsipts.models.ttm">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-dsipts.models.ttm" title="Link to this heading">¶</a></h2>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">DSIPTS</a></h1>









<search id="searchbox" style="display: none" role="search">
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" placeholder="Search"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script><h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="api.html">API Reference</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 8.2.3</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 1.0.0</a>
      
      |
      <a href="_sources/dsipts.models.ttm.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>